{"version":3,"sources":["picker.js"],"names":["define","langx","browser","eventer","noder","geom","$","fuelux","old","fn","picker","Picker","WidgetBase","inherit","klassName","init","element","options","self","this","$element","mixin","defaults","$accept","find","$cancel","$trigger","$footer","$header","$popup","$body","clickStamp","isInput","is","on","proxy","keyComplete","e","target","show","toggle","complete","preventDefault","action","func","accepted","cancelled","exited","obj","contents","trigger","hide","keyCode","blur","destroy","remove","document","off","outerHTML","disable","addClass","attr","enable","removeClass","removeAttr","hasClass","externalClickListener","force","isExternalClick","i","l","el","get","exceptions","externalClickExceptions","$originEl","parents","length","other","data","explicit","_display","Date","getTime","Math","floor","random","_isOffscreen","windowHeight","max","documentElement","clientHeight","window","innerHeight","scrollTop","popupTop","offset","top","outerHeight","css","_showBelow","_showAbove","option","methodReturn","args","Array","prototype","slice","call","arguments","$set","each","$this","apply","undefined","onAccept","onCancel","onExit","Constructor","noConflict"],"mappings":"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","file":"../picker.js","sourcesContent":["define([\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\"\n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\tvar old = $.fn.picker;\n\n\t// PLACARD CONSTRUCTOR AND PROTOTYPE\n\n\n\tvar Picker = fuelux.Picker = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Picker\",\n\n\t\tinit : function(element,options) {\n\t\t\tvar self = this;\n\t\t\tthis.$element = $(element);\n\t\t\tthis.options = langx.mixin({}, $.fn.picker.defaults, options);\n\n\t\t\tthis.$accept = this.$element.find('.picker-accept');\n\t\t\tthis.$cancel = this.$element.find('.picker-cancel');\n\t\t\tthis.$trigger = this.$element.find('.picker-trigger');\n\t\t\tthis.$footer = this.$element.find('.picker-footer');\n\t\t\tthis.$header = this.$element.find('.picker-header');\n\t\t\tthis.$popup = this.$element.find('.picker-popup');\n\t\t\tthis.$body = this.$element.find('.picker-body');\n\n\t\t\tthis.clickStamp = '_';\n\n\t\t\tthis.isInput = this.$trigger.is('input');\n\n\t\t\tthis.$trigger.on('keydown.fu.picker', langx.proxy(this.keyComplete, this));\n\t\t\tthis.$trigger.on('focus.fu.picker', langx.proxy(function inputFocus(e){\n\t\t\t\tif(typeof e === \"undefined\" || $(e.target).is('input[type=text]')){\n\t\t\t\t\tlangx.proxy(this.show(), this);\n\t\t\t\t}\n\t\t\t}, this));\n\t\t\tthis.$trigger.on('click.fu.picker', langx.proxy(function triggerClick(e){\n\t\t\t\tif(!$(e.target).is('input[type=text]')){\n\t\t\t\t\tlangx.proxy(this.toggle(), this);\n\t\t\t\t}else{\n\t\t\t\t\tlangx.proxy(this.show(), this);\n\t\t\t\t}\n\t\t\t}, this));\n\t\t\tthis.$accept.on('click.fu.picker', langx.proxy(this.complete, this, 'accepted'));\n\t\t\tthis.$cancel.on('click.fu.picker', function (e) {\n\t\t\t\te.preventDefault(); self.complete('cancelled');\n\t\t\t});\n\t\t},\n\n\t\tcomplete: function complete(action) {\n\t\t\tvar EVENT_CALLBACK_MAP = {\n\t\t\t\t'accepted': 'onAccept',\n\t\t\t\t'cancelled': 'onCancel',\n\t\t\t\t'exited': 'onExit'\n\t\t\t};\n\t\t\tvar func = this.options[ EVENT_CALLBACK_MAP[action] ];\n\n\t\t\tvar obj = {\n\t\t\t\tcontents: this.$body\n\t\t\t};\n\n\t\t\tif (func) {\n\t\t\t\tfunc(obj);\n\t\t\t\tthis.$element.trigger(action + '.fu.picker', obj);\n\t\t\t} else {\n\t\t\t\tthis.$element.trigger(action + '.fu.picker', obj);\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t},\n\n\t\tkeyComplete: function keyComplete(e) {\n\t\t\tif (this.isInput && e.keyCode === 13) {\n\t\t\t\tthis.complete('accepted');\n\t\t\t\tthis.$trigger.blur();\n\t\t\t} else if (e.keyCode === 27) {\n\t\t\t\tthis.complete('exited');\n\t\t\t\tthis.$trigger.blur();\n\t\t\t}\n\t\t},\n\n\t\tdestroy: function destroy() {\n\t\t\tthis.$element.remove();\n\t\t\t// remove any external bindings\n\t\t\t$(document).off('click.fu.picker.externalClick.' + this.clickStamp);\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// return string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tdisable: function disable() {\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$trigger.attr('disabled', 'disabled');\n\t\t},\n\n\t\tenable: function enable() {\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$trigger.removeAttr('disabled');\n\t\t},\n\n\t\ttoggle: function toggle() {\n\t\t\tif (this.$element.hasClass('showing')) {\n\t\t\t\tthis.hide();\n\t\t\t}else{\n\t\t\t\tthis.show();\n\t\t\t}\n\t\t},\n\n\t\thide: function hide() {\n\t\t\tif (!this.$element.hasClass('showing')) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$element.removeClass('showing');\n\t\t\t$(document).off('click.fu.picker.externalClick.' + this.clickStamp);\n\t\t\tthis.$element.trigger('hidden.fu.picker');\n\t\t},\n\n\t\texternalClickListener: function externalClickListener(e, force) {\n\t\t\tif (force === true || this.isExternalClick(e)) {\n\t\t\t\tthis.complete('exited');\n\t\t\t}\n\t\t},\n\n\t\tisExternalClick: function isExternalClick(e) {\n\t\t\tvar el = this.$element.get(0);\n\t\t\tvar exceptions = this.options.externalClickExceptions || [];\n\t\t\tvar $originEl = $(e.target);\n\t\t\tvar i, l;\n\n\t\t\tif (e.target === el || $originEl.parents('.picker').get(0) === el) {\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\tfor (i = 0, l = exceptions.length; i < l; i++) {\n\t\t\t\t\tif ($originEl.is(exceptions[i]) || $originEl.parents(exceptions[i]).length > 0) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tshow: function show() {\n\t\t\tvar other;\n\n\t\t\tother = $(document).find('.picker.showing');\n\t\t\tif (other.length > 0) {\n\t\t\t\tif (other.data('fu.picker') && other.data('fu.picker').options.explicit) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tother.picker('externalClickListener', {}, true);\n\t\t\t}\n\n\t\t\tthis.$element.addClass('showing');\n\n\t\t\t_display(this);\n\n\t\t\tthis.$element.trigger('shown.fu.picker');\n\n\t\t\tthis.clickStamp = new Date().getTime() + (Math.floor(Math.random() * 100) + 1);\n\t\t\tif (!this.options.explicit) {\n\t\t\t\t$(document).on('click.fu.picker.externalClick.' + this.clickStamp, langx.proxy(this.externalClickListener, this));\n\t\t\t}\n\t\t}\n\t});\n\n\tvar _isOffscreen = function _isOffscreen(picker) {\n\t\tvar windowHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n\t\tvar scrollTop = $(document).scrollTop();\n\t\tvar popupTop = picker.$popup.offset();\n\t\tvar popupBottom = popupTop.top + picker.$popup.outerHeight(true);\n\n\t\t//if the bottom of the popup goes off the page, but the top does not, dropup.\n\t\tif (popupBottom > windowHeight + scrollTop || popupTop.top < scrollTop){\n\t\t\treturn true;\n\t\t}else{//otherwise, prefer showing the top of the popup only vs the bottom\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tvar _display = function _display(picker) {\n\t\tpicker.$popup.css('visibility', 'hidden');\n\n\t\t_showBelow(picker);\n\n\t\t//if part of the popup is offscreen try to show it above\n\t\tif(_isOffscreen(picker)){\n\t\t\t_showAbove(picker);\n\n\t\t\t//if part of the popup is still offscreen, prefer cutting off the bottom\n\t\t\tif(_isOffscreen(picker)){\n\t\t\t\t_showBelow(picker);\n\t\t\t}\n\t\t}\n\n\t\tpicker.$popup.css('visibility', 'visible');\n\t};\n\n\tvar _showAbove = function _showAbove(picker) {\n\t\tpicker.$popup.css('top', - picker.$popup.outerHeight(true) + 'px');\n\t};\n\n\tvar _showBelow = function _showBelow(picker) {\n\t\tpicker.$popup.css('top', picker.$trigger.outerHeight(true) + 'px');\n\t};\n\n\n\t// PLACARD PLUGIN DEFINITION\n\n\t$.fn.picker = function picker(option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.picker');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.picker', (data = new Picker(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.picker.defaults = {\n\t\tonAccept: undefined,\n\t\tonCancel: undefined,\n\t\tonExit: undefined,\n\t\texternalClickExceptions: [],\n\t\texplicit: false\n\t};\n\n\t$.fn.picker.Constructor = Picker;\n\n\t$.fn.picker.noConflict = function noConflict() {\n\t\t$.fn.picker = old;\n\t\treturn this;\n\t};\n\n\t// DATA-API\n\n\t/*\n\t$(document).on('focus.fu.picker.data-api', '[data-initialize=picker]', function (e) {\n\t\tvar $control = $(e.target).closest('.picker');\n\t\tif (!$control.data('fu.picker')) {\n\t\t\t$control.picker($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function () {\n\t\t$('[data-initialize=picker]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.data('fu.picker')) return;\n\t\t\t$this.picker($this.data());\n\t\t});\n\t});\n\t*/\n\n\treturn $.fn.picker;\n});\n"]}
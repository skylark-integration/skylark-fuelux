{"version":3,"sources":["search.js"],"names":["define","langx","browser","eventer","noder","geom","$","fuelux","old","fn","search","Search","WidgetBase","inherit","klassName","init","element","options","this","$element","$repeater","closest","mixin","defaults","attr","searchOnKeyPress","$button","find","$input","$icon","on","proxy","buttonclicked","keypress","length","clearPending","activeSearch","destroy","remove","each","val","outerHTML","searchText","hasClass","removeClass","addClass","trigger","clear","action","e","preventDefault","currentTarget","is","which","disable","allowCancel","enable","removeAttr","option","methodReturn","args","Array","prototype","slice","call","arguments","$set","$this","data","apply","undefined","clearOnEmpty","Constructor","noConflict"],"mappings":"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","file":"../search.js","sourcesContent":["define([\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\",\n  \"skylark-bootstrap3/dropdown\"  \n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\n\t/*\n\t * Fuel UX Search\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\tvar old = $.fn.search;\n\n\t// SEARCH CONSTRUCTOR AND PROTOTYPE\n\n\tvar Search = fuelux.Search = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Search\",\n\n\t\tinit : function(element,options) {\n\t\t\tthis.$element = $(element);\n\t\t\tthis.$repeater = $(element).closest('.repeater');\n\t\t\tthis.options = langx.mixin({}, $.fn.search.defaults, options);\n\n\t\t\tif (this.$element.attr('data-searchOnKeyPress') === 'true'){\n\t\t\t\tthis.options.searchOnKeyPress = true;\n\t\t\t}\n\n\t\t\tthis.$button = this.$element.find('button');\n\t\t\tthis.$input = this.$element.find('input');\n\t\t\tthis.$icon = this.$element.find('.glyphicon, .fuelux-icon');\n\n\t\t\tthis.$button.on('click.fu.search', langx.proxy(this.buttonclicked, this));\n\t\t\tthis.$input.on('keyup.fu.search', langx.proxy(this.keypress, this));\n\n\t\t\tif (this.$repeater.length > 0) {\n\t\t\t\tthis.$repeater.on('rendered.fu.repeater', langx.proxy(this.clearPending, this));\n\t\t\t}\n\n\t\t\tthis.activeSearch = '';\n\t\t},\n\t\tdestroy: function () {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\t\t\t// set input value attrbute\n\t\t\tthis.$element.find('input').each(function () {\n\t\t\t\t$(this).attr('value', $(this).val());\n\t\t\t});\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tsearch: function (searchText) {\n\t\t\tif (this.$icon.hasClass('glyphicon')) {\n\t\t\t\tthis.$icon.removeClass('glyphicon-search').addClass('glyphicon-remove');\n\t\t\t}\n\t\t\tif (this.$icon.hasClass('fuelux-icon')) {\n\t\t\t\tthis.$icon.removeClass('fuelux-icon-search').addClass('fuelux-icon-remove');\n\t\t\t}\n\n\t\t\tthis.activeSearch = searchText;\n\t\t\tthis.$element.addClass('searched pending');\n\t\t\tthis.$element.trigger('searched.fu.search', searchText);\n\t\t},\n\n\t\tclear: function () {\n\t\t\tif (this.$icon.hasClass('glyphicon')) {\n\t\t\t\tthis.$icon.removeClass('glyphicon-remove').addClass('glyphicon-search');\n\t\t\t}\n\t\t\tif (this.$icon.hasClass('fuelux-icon')) {\n\t\t\t\tthis.$icon.removeClass('fuelux-icon-remove').addClass('fuelux-icon-search');\n\t\t\t}\n\n\t\t\tif (this.$element.hasClass('pending')) {\n\t\t\t\tthis.$element.trigger('canceled.fu.search');\n\t\t\t}\n\n\t\t\tthis.activeSearch = '';\n\t\t\tthis.$input.val('');\n\t\t\tthis.$element.trigger('cleared.fu.search');\n\t\t\tthis.$element.removeClass('searched pending');\n\t\t},\n\n\t\tclearPending: function () {\n\t\t\tthis.$element.removeClass('pending');\n\t\t},\n\n\t\taction: function () {\n\t\t\tvar val = this.$input.val();\n\n\t\t\tif (val && val.length > 0) {\n\t\t\t\tthis.search(val);\n\t\t\t} else {\n\t\t\t\tthis.clear();\n\t\t\t}\n\t\t},\n\n\t\tbuttonclicked: function (e) {\n\t\t\te.preventDefault();\n\t\t\tif ($(e.currentTarget).is('.disabled, :disabled')) return;\n\n\t\t\tif (this.$element.hasClass('pending') || this.$element.hasClass('searched')) {\n\t\t\t\tthis.clear();\n\t\t\t} else {\n\t\t\t\tthis.action();\n\t\t\t}\n\t\t},\n\n\t\tkeypress: function (e) {\n\t\t\tvar ENTER_KEY_CODE = 13;\n\t\t\tvar TAB_KEY_CODE = 9;\n\t\t\tvar ESC_KEY_CODE = 27;\n\n\t\t\tif (e.which === ENTER_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.action();\n\t\t\t} else if (e.which === TAB_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t} else if (e.which === ESC_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.clear();\n\t\t\t} else if (this.options.searchOnKeyPress) {\n\t\t\t\t// search on other keypress\n\t\t\t\tthis.action();\n\t\t\t}\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$input.attr('disabled', 'disabled');\n\n\t\t\tif (!this.options.allowCancel) {\n\t\t\t\tthis.$button.addClass('disabled');\n\t\t\t}\n\t\t},\n\n\t\tenable: function () {\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$input.removeAttr('disabled');\n\t\t\tthis.$button.removeClass('disabled');\n\t\t}\n\t});\n\n\t// SEARCH PLUGIN DEFINITION\n\n\t$.fn.search = function (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.search');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.search', (data = new Search(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.search.defaults = {\n\t\tclearOnEmpty: false,\n\t\tsearchOnKeyPress: false,\n\t\tallowCancel: false\n\t};\n\n\t$.fn.search.Constructor = Search;\n\n\t$.fn.search.noConflict = function () {\n\t\t$.fn.search = old;\n\t\treturn this;\n\t};\n\n\n\t// DATA-API\n\t/*\n\t$(document).on('mousedown.fu.search.data-api', '[data-initialize=search]', function (e) {\n\t\tvar $control = $(e.target).closest('.search');\n\t\tif (!$control.data('fu.search')) {\n\t\t\t$control.search($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function () {\n\t\t$('[data-initialize=search]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.data('fu.search')) return;\n\t\t\t$this.search($this.data());\n\t\t});\n\t});\n\t*/\n\n\treturn \t$.fn.search;\n});\n"]}
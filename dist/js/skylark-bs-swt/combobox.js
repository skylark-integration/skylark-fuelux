/**
 * skylark-bs-swt - The skylark bootstrap standard widget tookit
 * @author Hudaokeji, Inc.
 * @version v0.9.0-beta
 * @link https://github.com/skylarkui/skylark-bs-swt/
 * @license MIT
 */
define(["skylark-utils/langx","skylark-utils/browser","skylark-utils/eventer","skylark-utils/noder","skylark-utils/geom","skylark-utils/query"],function(t,e,i,s,n,o){var l=o.fn.combobox,h=function(e,i){this.$element=o(e),this.options=t.mixin({},o.fn.combobox.defaults,i),this.$dropMenu=this.$element.find(".dropdown-menu"),this.$input=this.$element.find("input"),this.$button=this.$element.find(".btn"),this.$inputGroupBtn=this.$element.find(".input-group-btn"),this.$element.on("click.fu.combobox","a",t.proxy(this.itemclicked,this)),this.$element.on("change.fu.combobox","input",t.proxy(this.inputchanged,this)),this.$element.on("shown.bs.dropdown",t.proxy(this.menuShown,this)),this.$input.on("keyup.fu.combobox",t.proxy(this.keypress,this)),this.setDefaultSelection();var s=this.$dropMenu.children("li");0===s.length&&this.$button.addClass("disabled"),this.options.filterOnKeypress&&this.options.filter(this.$dropMenu.find("li"),this.$input.val(),this)};h.prototype={constructor:h,destroy:function(){return this.$element.remove(),this.$element.find("input").each(function(){o(this).attr("value",o(this).val())}),this.$element[0].outerHTML},doSelect:function(t){"undefined"!=typeof t[0]?(this.$element.find("li.selected:first").removeClass("selected"),this.$selectedItem=t,this.$selectedItem.addClass("selected"),this.$input.val(this.$selectedItem.text().trim())):(this.$selectedItem=null,this.$element.find("li.selected:first").removeClass("selected"))},clearSelection:function(){this.$selectedItem=null,this.$input.val(""),this.$dropMenu.find("li").removeClass("selected")},menuShown:function(){this.options.autoResizeMenu&&this.resizeMenu()},resizeMenu:function(){var t=this.$element.outerWidth();this.$dropMenu.outerWidth(t)},selectedItem:function(){var e=this.$selectedItem,i={};if(e){var s=this.$selectedItem.text().trim();i=t.mixin({text:s},this.$selectedItem.data())}else i={text:this.$input.val().trim(),notFound:!0};return i},selectByText:function(t){var e=o([]);this.$element.find("li").each(function(){if((this.textContent||this.innerText||o(this).text()||"").trim().toLowerCase()===(t||"").trim().toLowerCase())return e=o(this),!1}),this.doSelect(e)},selectByValue:function(t){var e='li[data-value="'+t+'"]';this.selectBySelector(e)},selectByIndex:function(t){var e="li:eq("+t+")";this.selectBySelector(e)},selectBySelector:function(t){var e=this.$element.find(t);this.doSelect(e)},setDefaultSelection:function(){var t="li[data-selected=true]:first",e=this.$element.find(t);e.length>0&&(this.selectBySelector(t),e.removeData("selected"),e.removeAttr("data-selected"))},enable:function(){this.$element.removeClass("disabled"),this.$input.removeAttr("disabled"),this.$button.removeClass("disabled")},disable:function(){this.$element.addClass("disabled"),this.$input.attr("disabled",!0),this.$button.addClass("disabled")},itemclicked:function(t){this.$selectedItem=o(t.target).parent(),this.$input.val(this.$selectedItem.text().trim()).trigger("change",{synthetic:!0});var e=this.selectedItem();this.$element.trigger("changed.fu.combobox",e),t.preventDefault(),this.$element.find(".dropdown-toggle").focus()},keypress:function(t){var e=13,i=27,s=37,n=38,o=39,l=40,h=t.which===n||t.which===l||t.which===s||t.which===o;if(this.options.showOptionsOnKeypress&&!this.$inputGroupBtn.hasClass("open")&&(this.$button.dropdown("toggle"),this.$input.focus()),t.which===e){t.preventDefault();var r=this.$dropMenu.find("li.selected").text().trim();r.length>0?this.selectByText(r):this.selectByText(this.$input.val()),this.$inputGroupBtn.removeClass("open")}else if(t.which===i)t.preventDefault(),this.clearSelection(),this.$inputGroupBtn.removeClass("open");else if(this.options.showOptionsOnKeypress&&(t.which===l||t.which===n)){t.preventDefault();var c=this.$dropMenu.find("li.selected");c.length>0&&(c=t.which===l?c.next(":not(.hidden)"):c.prev(":not(.hidden)")),0===c.length&&(c=t.which===l?this.$dropMenu.find("li:not(.hidden):first"):this.$dropMenu.find("li:not(.hidden):last")),this.doSelect(c)}this.options.filterOnKeypress&&!h&&this.options.filter(this.$dropMenu.find("li"),this.$input.val(),this),this.previousKeyPress=t.which},inputchanged:function(t,e){var i=o(t.target).val();if(e&&e.synthetic)return void this.selectByText(i);this.selectByText(i);var s=this.selectedItem();0===s.text.length&&(s={text:i}),this.$element.trigger("changed.fu.combobox",s)}},h.prototype.getValue=h.prototype.selectedItem,o.fn.combobox=function(t){var e,i=Array.prototype.slice.call(arguments,1),s=this.each(function(){var s=o(this),n=s.data("fu.combobox"),l="object"==typeof t&&t;n||s.data("fu.combobox",n=new h(this,l)),"string"==typeof t&&(e=n[t].apply(n,i))});return void 0===e?s:e},o.fn.combobox.defaults={autoResizeMenu:!0,filterOnKeypress:!1,showOptionsOnKeypress:!1,filter:function(t,e,i){var s=0;i.$dropMenu.find(".empty-indicator").remove(),t.each(function(t){var i=o(this),n=o(this).text().trim();i.removeClass(),n===e?(i.addClass("text-success"),s++):n.substr(0,e.length)===e?(i.addClass("text-info"),s++):i.addClass("hidden")}),0===s&&i.$dropMenu.append('<li class="empty-indicator text-muted"><em>No Matches</em></li>')}},o.fn.combobox.Constructor=h,o.fn.combobox.noConflict=function(){return o.fn.combobox=l,this},o(document).on("mousedown.fu.combobox.data-api","[data-initialize=combobox]",function(t){var e=o(t.target).closest(".combobox");e.data("fu.combobox")||e.combobox(e.data())}),o(function(){o("[data-initialize=combobox]").each(function(){var t=o(this);t.data("fu.combobox")||t.combobox(t.data())})})});
//# sourceMappingURL=sourcemaps/combobox.js.map

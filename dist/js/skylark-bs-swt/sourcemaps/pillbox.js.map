{"version":3,"sources":["pillbox.js"],"names":["define","langx","browser","eventer","noder","geom","$","fn","dropdownautoflip","Error","utilities","old","pillbox","CONST","COMMA_KEYCODE","ENTER_KEYCODE","isBackspaceKey","isDeleteKey","isTabKey","isUpArrow","isDownArrow","cleanInput","isShiftHeld","Pillbox","element","options","this","$element","$moreCount","find","$pillGroup","$addItem","$addItemWrap","parent","$suggest","$pillHTML","mixin","defaults","readonly","undefined","attr","acceptKeyCodes","_generateObject","on","proxy","itemClicked","inputFocus","inputEvent","onKeyDown","suggestionClick","edit","addClass","cancelEdit","prototype","constructor","destroy","remove","outerHTML","items","self","children","map","getItemData","get","e","$item","$target","target","preventDefault","stopPropagation","_closeSuggestions","hasClass","onRemove","el","_removeElement","length","openEdit","trigger","enable","removeAttr","truncate","currentTarget","item","text","html","value","data","val","JSON","parse","addItems","itemCount","index","isInternal","isFinite","String","arguments","Array","slice","call","each","i","currentEdit","wrap","pop","onAdd","saveEdit","placeItems","removeItems","howMany","itemsToRemove","$currentItem","_removePillTrigger","method","$neighbor","newItems","key","push","before","after","prepend","isFocusOutEvent","type","blurredAfterInput","acceptKeyPressed","keyCode","_isSuggestionsOpen","$selection","replace","match","allowEmptyPills","hide","setTimeout","show","size","focus","$lastItem","width","removeClass","_keySuggestions","callbackId","timeStamp","event","_openSuggestions","targetChildIndex","detach","select","append","removeBySelector","selectors","sel","removedSelectors","removeByValue","values","removedValues","removeByText","matchingText","removedText","availableWidth","containerFull","processedPills","totalPills","widthUsed","pill","outerWidth","removedBy","obj","$suggestionList","$suggestion","stringify","document","$first","dir","$next","prev","next","getValue","option","methodReturn","args","$set","$this","apply","Constructor","noConflict","$control","closest"],"mappings":"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","file":"../pillbox.js","sourcesContent":["define([\n  \"skylark-utils/langx\",\n  \"skylark-utils/browser\",\n  \"skylark-utils/eventer\",\n  \"skylark-utils/noder\",\n  \"skylark-utils/geom\",\n  \"skylark-utils/query\",\n  \"./utilities\"\n],function(langx,browser,eventer,noder,geom,$){\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\tif (!$.fn.dropdownautoflip) {\n\t\tthrow new Error('Fuel UX pillbox control requires dropdown-autoflip.');\n\t}\n\n\tif (!$.fn.utilities) {\n\t\tthrow new Error('Fuel UX pillbox control requires FuelUX utilities.');\n\t}\n\t// -- END UMD WRAPPER PREFACE --\n\n\t// -- BEGIN MODULE CODE HERE --\n\n\tvar old = $.fn.pillbox;\n\n\tvar utilities = $.fn.utilities;\n\tvar CONST = $.fn.utilities.CONST;\n\tvar COMMA_KEYCODE = CONST.COMMA_KEYCODE;\n\tvar ENTER_KEYCODE = CONST.ENTER_KEYCODE;\n\tvar isBackspaceKey = utilities.isBackspaceKey;\n\tvar isDeleteKey = utilities.isDeleteKey;\n\tvar isTabKey = utilities.isTabKey;\n\tvar isUpArrow = utilities.isUpArrow;\n\tvar isDownArrow = utilities.isDownArrow;\n\tvar cleanInput = utilities.cleanInput;\n\tvar isShiftHeld = utilities.isShiftHeld;\n\n\t// PILLBOX CONSTRUCTOR AND PROTOTYPE\n\tvar Pillbox = function Pillbox (element, options) {\n\t\tthis.$element = $(element);\n\t\tthis.$moreCount = this.$element.find('.pillbox-more-count');\n\t\tthis.$pillGroup = this.$element.find('.pill-group');\n\t\tthis.$addItem = this.$element.find('.pillbox-add-item');\n\t\tthis.$addItemWrap = this.$addItem.parent();\n\t\tthis.$suggest = this.$element.find('.suggest');\n\t\tthis.$pillHTML = '<li class=\"btn btn-default pill\">' +\n\t\t'\t<span></span>' +\n\t\t'\t<span class=\"glyphicon glyphicon-close\">' +\n\t\t'\t\t<span class=\"sr-only\">Remove</span>' +\n\t\t'\t</span>' +\n\t\t'</li>';\n\n\t\tthis.options = langx.mixin({}, $.fn.pillbox.defaults, options);\n\n\t\tif (this.options.readonly === -1) {\n\t\t\tif (this.$element.attr('data-readonly') !== undefined) {\n\t\t\t\tthis.readonly(true);\n\t\t\t}\n\t\t} else if (this.options.readonly) {\n\t\t\tthis.readonly(true);\n\t\t}\n\n\t\t// EVENTS\n\t\tthis.acceptKeyCodes = this._generateObject(this.options.acceptKeyCodes);\n\t\t// Create an object out of the key code array, so we don't have to loop through it on every key stroke\n\n\t\tthis.$element.on('click.fu.pillbox', '.pill-group > .pill', $.proxy(this.itemClicked, this));\n\t\tthis.$element.on('click.fu.pillbox', $.proxy(this.inputFocus, this));\n\t\tthis.$element.on('keydown.fu.pillbox', '.pillbox-add-item', $.proxy(this.inputEvent, this));\n\t\tif (this.options.onKeyDown) {\n\t\t\tthis.$element.on('mousedown.fu.pillbox', '.suggest > li', $.proxy(this.suggestionClick, this));\n\t\t}\n\n\t\tif (this.options.edit) {\n\t\t\tthis.$element.addClass('pills-editable');\n\t\t\tthis.$element.on('blur.fu.pillbox', '.pillbox-add-item', $.proxy(this.cancelEdit, this));\n\t\t}\n\t\tthis.$element.on('blur.fu.pillbox', '.pillbox-add-item', $.proxy(this.inputEvent, this));\n\t};\n\n\tPillbox.prototype = {\n\t\tconstructor: Pillbox,\n\n\t\tdestroy: function destroy () {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\titems: function items () {\n\t\t\tvar self = this;\n\n\t\t\treturn this.$pillGroup.children('.pill').map(function getItemsData () {\n\t\t\t\treturn self.getItemData($(this));\n\t\t\t}).get();\n\t\t},\n\n\t\titemClicked: function itemClicked (e) {\n\t\t\tvar $target = $(e.target);\n\t\t\tvar $item;\n\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tthis._closeSuggestions();\n\n\t\t\tif (!$target.hasClass('pill')) {\n\t\t\t\t$item = $target.parent();\n\t\t\t\tif (this.$element.attr('data-readonly') === undefined) {\n\t\t\t\t\tif ($target.hasClass('glyphicon-close')) {\n\t\t\t\t\t\tif (this.options.onRemove) {\n\t\t\t\t\t\t\tthis.options.onRemove(this.getItemData($item, {\n\t\t\t\t\t\t\t\tel: $item\n\t\t\t\t\t\t\t}), $.proxy(this._removeElement, this));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._removeElement(this.getItemData($item, {\n\t\t\t\t\t\t\t\tel: $item\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if (this.options.edit) {\n\t\t\t\t\t\tif ($item.find('.pillbox-list-edit').length) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.openEdit($item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$item = $target;\n\t\t\t}\n\n\t\t\tthis.$element.trigger('clicked.fu.pillbox', this.getItemData($item));\n\n\t\t\treturn true;\n\t\t},\n\n\t\treadonly: function readonly (enable) {\n\t\t\tif (enable) {\n\t\t\t\tthis.$element.attr('data-readonly', 'readonly');\n\t\t\t} else {\n\t\t\t\tthis.$element.removeAttr('data-readonly');\n\t\t\t}\n\n\t\t\tif (this.options.truncate) {\n\t\t\t\tthis.truncate(enable);\n\t\t\t}\n\t\t},\n\n\t\tsuggestionClick: function suggestionClick (e) {\n\t\t\tvar $item = $(e.currentTarget);\n\t\t\tvar item = {\n\t\t\t\ttext: $item.html(),\n\t\t\t\tvalue: $item.data('value')\n\t\t\t};\n\n\t\t\te.preventDefault();\n\t\t\tthis.$addItem.val('');\n\n\t\t\tif ($item.data('attr')) {\n\t\t\t\titem.attr = JSON.parse($item.data('attr'));\n\t\t\t}\n\n\t\t\titem.data = $item.data('data');\n\n\t\t\tthis.addItems(item, true);\n\n\t\t\t// needs to be after addItems for IE\n\t\t\tthis._closeSuggestions();\n\t\t},\n\n\t\titemCount: function itemCount () {\n\t\t\treturn this.$pillGroup.children('.pill').length;\n\t\t},\n\n\t\t// First parameter is 1 based index (optional, if index is not passed all new items will be appended)\n\t\t// Second parameter can be array of objects [{ ... }, { ... }] or you can pass n additional objects as args\n\t\t// object structure is as follows (attr and value are optional): { text: '', value: '', attr: {}, data: {} }\n\t\taddItems: function addItems () {\n\t\t\tvar self = this;\n\t\t\tvar items;\n\t\t\tvar index;\n\t\t\tvar isInternal;\n\n\t\t\tif (isFinite(String(arguments[0])) && !(arguments[0] instanceof Array)) {\n\t\t\t\titems = [].slice.call(arguments).slice(1);\n\t\t\t\tindex = arguments[0];\n\t\t\t} else {\n\t\t\t\titems = [].slice.call(arguments).slice(0);\n\t\t\t\tisInternal = items[1] && !items[1].text;\n\t\t\t}\n\n\t\t\t// If first argument is an array, use that, otherwise they probably passed each thing through as a separate arg, so use items as-is\n\t\t\tif (items[0] instanceof Array) {\n\t\t\t\titems = items[0];\n\t\t\t}\n\n\t\t\tif (items.length) {\n\t\t\t\t$.each(items, function normalizeItemsObject (i, value) {\n\t\t\t\t\tvar data = {\n\t\t\t\t\t\ttext: value.text,\n\t\t\t\t\t\tvalue: (value.value ? value.value : value.text),\n\t\t\t\t\t\tel: self.$pillHTML\n\t\t\t\t\t};\n\n\t\t\t\t\tif (value.attr) {\n\t\t\t\t\t\tdata.attr = value.attr;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (value.data) {\n\t\t\t\t\t\tdata.data = value.data;\n\t\t\t\t\t}\n\n\t\t\t\t\titems[i] = data;\n\t\t\t\t});\n\n\t\t\t\tif (this.options.edit && this.currentEdit) {\n\t\t\t\t\titems[0].el = this.currentEdit.wrap('<div></div>').parent().html();\n\t\t\t\t}\n\n\t\t\t\tif (isInternal) {\n\t\t\t\t\titems.pop(1);\n\t\t\t\t}\n\n\t\t\t\tif (self.options.onAdd && isInternal) {\n\t\t\t\t\tif (this.options.edit && this.currentEdit) {\n\t\t\t\t\t\tself.options.onAdd(items[0], $.proxy(self.saveEdit, this));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.options.onAdd(items[0], $.proxy(self.placeItems, this));\n\t\t\t\t\t}\n\t\t\t\t} else if (this.options.edit && this.currentEdit) {\n\t\t\t\t\tself.saveEdit(items);\n\t\t\t\t} else if (index) {\n\t\t\t\t\tself.placeItems(index, items);\n\t\t\t\t} else {\n\t\t\t\t\tself.placeItems(items, isInternal);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t// First parameter is the index (1 based) to start removing items\n\t\t// Second parameter is the number of items to be removed\n\t\tremoveItems: function removeItems (index, howMany) {\n\t\t\tvar self = this;\n\n\t\t\tif (!index) {\n\t\t\t\tthis.$pillGroup.find('.pill').remove();\n\t\t\t\tthis._removePillTrigger({\n\t\t\t\t\tmethod: 'removeAll'\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tvar itemsToRemove = howMany ? howMany : 1;\n\n\t\t\t\tfor (var item = 0; item < itemsToRemove; item++) {\n\t\t\t\t\tvar $currentItem = self.$pillGroup.find('> .pill:nth-child(' + index + ')');\n\n\t\t\t\t\tif ($currentItem) {\n\t\t\t\t\t\t$currentItem.remove();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t// First parameter is index (optional)\n\t\t// Second parameter is new arguments\n\t\tplaceItems: function placeItems () {\n\t\t\tvar items;\n\t\t\tvar index;\n\t\t\tvar $neighbor;\n\t\t\tvar isInternal;\n\n\t\t\tif (isFinite(String(arguments[0])) && !(arguments[0] instanceof Array)) {\n\t\t\t\titems = [].slice.call(arguments).slice(1);\n\t\t\t\tindex = arguments[0];\n\t\t\t} else {\n\t\t\t\titems = [].slice.call(arguments).slice(0);\n\t\t\t\tisInternal = items[1] && !items[1].text;\n\t\t\t}\n\n\t\t\tif (items[0] instanceof Array) {\n\t\t\t\titems = items[0];\n\t\t\t}\n\n\t\t\tif (items.length) {\n\t\t\t\tvar newItems = [];\n\t\t\t\t$.each(items, function prepareItemForAdd (i, item) {\n\t\t\t\t\tvar $item = $(item.el);\n\n\t\t\t\t\t$item.attr('data-value', item.value);\n\t\t\t\t\t$item.find('span:first').html(item.text);\n\n\t\t\t\t\t// DOM attributes\n\t\t\t\t\tif (item.attr) {\n\t\t\t\t\t\t$.each(item.attr, function handleDOMAttributes (key, value) {\n\t\t\t\t\t\t\tif (key === 'cssClass' || key === 'class') {\n\t\t\t\t\t\t\t\t$item.addClass(value);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$item.attr(key, value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (item.data) {\n\t\t\t\t\t\t$item.data('data', item.data);\n\t\t\t\t\t}\n\n\t\t\t\t\tnewItems.push($item);\n\t\t\t\t});\n\n\t\t\t\tif (this.$pillGroup.children('.pill').length > 0) {\n\t\t\t\t\tif (index) {\n\t\t\t\t\t\t$neighbor = this.$pillGroup.find('.pill:nth-child(' + index + ')');\n\n\t\t\t\t\t\tif ($neighbor.length) {\n\t\t\t\t\t\t\t$neighbor.before(newItems);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.$pillGroup.children('.pill:last').after(newItems);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.$pillGroup.children('.pill:last').after(newItems);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.$pillGroup.prepend(newItems);\n\t\t\t\t}\n\n\t\t\t\tif (isInternal) {\n\t\t\t\t\tthis.$element.trigger('added.fu.pillbox', {\n\t\t\t\t\t\ttext: items[0].text,\n\t\t\t\t\t\tvalue: items[0].value\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tinputEvent: function inputEvent (e) {\n\t\t\tvar self = this;\n\t\t\tvar text = self.options.cleanInput(this.$addItem.val());\n\t\t\tvar isFocusOutEvent = e.type === 'focusout';\n\t\t\tvar blurredAfterInput = (isFocusOutEvent && text.length > 0);\n\t\t\t// If we test for keycode only, it will match for `<` & `,` instead of just `,`\n\t\t\t// This way users can type `<3` and `1 < 3`, etc...\n\t\t\tvar acceptKeyPressed = (this.acceptKeyCodes[e.keyCode] && !isShiftHeld(e));\n\n\t\t\tif (acceptKeyPressed || blurredAfterInput) {\n\t\t\t\tvar attr;\n\t\t\t\tvar value;\n\n\t\t\t\tif (this.options.onKeyDown && this._isSuggestionsOpen()) {\n\t\t\t\t\tvar $selection = this.$suggest.find('.pillbox-suggest-sel');\n\n\t\t\t\t\tif ($selection.length) {\n\t\t\t\t\t\ttext = self.options.cleanInput($selection.html());\n\t\t\t\t\t\tvalue = self.options.cleanInput($selection.data('value'));\n\t\t\t\t\t\tattr = $selection.data('attr');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// ignore comma and make sure text that has been entered (protects against \" ,\". https://github.com/ExactTarget/fuelux/issues/593), unless allowEmptyPills is true.\n\t\t\t\tif (text.replace(/[ ]*\\,[ ]*/, '').match(/\\S/) || (this.options.allowEmptyPills && text.length)) {\n\t\t\t\t\tthis._closeSuggestions();\n\t\t\t\t\tthis.$addItem.val('').hide();\n\n\t\t\t\t\tif (attr) {\n\t\t\t\t\t\tthis.addItems({\n\t\t\t\t\t\t\ttext: text,\n\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\tattr: JSON.parse(attr)\n\t\t\t\t\t\t}, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.addItems({\n\t\t\t\t\t\t\ttext: text,\n\t\t\t\t\t\t\tvalue: value\n\t\t\t\t\t\t}, true);\n\t\t\t\t\t}\n\n\t\t\t\t\tsetTimeout(function clearAddItemInput () {\n\t\t\t\t\t\tself.$addItem.show().attr({\n\t\t\t\t\t\t\tsize: 10\n\t\t\t\t\t\t}).focus();\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\t\t\t\treturn true;\n\t\t\t} else if (isBackspaceKey(e) || isDeleteKey(e)) {\n\t\t\t\tif (!text.length) {\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tif (this.options.edit && this.currentEdit) {\n\t\t\t\t\t\tthis.cancelEdit();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._closeSuggestions();\n\t\t\t\t\tvar $lastItem = this.$pillGroup.children('.pill:last');\n\n\t\t\t\t\tif ($lastItem.hasClass('pillbox-highlight')) {\n\t\t\t\t\t\tthis._removeElement(this.getItemData($lastItem, {\n\t\t\t\t\t\t\tel: $lastItem\n\t\t\t\t\t\t}));\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$lastItem.addClass('pillbox-highlight');\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else if (text.length > 10) {\n\t\t\t\tif (this.$addItem.width() < (this.$pillGroup.width() - 6)) {\n\t\t\t\t\tthis.$addItem.attr({\n\t\t\t\t\t\tsize: text.length + 3\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.$pillGroup.find('.pill').removeClass('pillbox-highlight');\n\n\t\t\tif (this.options.onKeyDown && !isFocusOutEvent) {\n\t\t\t\tif (\n\t\t\t\t\tisTabKey(e) ||\n\t\t\t\t\tisUpArrow(e) ||\n\t\t\t\t\tisDownArrow(e)\n\t\t\t\t) {\n\t\t\t\t\tif (this._isSuggestionsOpen()) {\n\t\t\t\t\t\tthis._keySuggestions(e);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\t// only allowing most recent event callback to register\n\t\t\t\tthis.callbackId = e.timeStamp;\n\t\t\t\tthis.options.onKeyDown({\n\t\t\t\t\tevent: e,\n\t\t\t\t\tvalue: text\n\t\t\t\t}, function callOpenSuggestions (data) {\n\t\t\t\t\tself._openSuggestions(e, data);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\topenEdit: function openEdit (el) {\n\t\t\tvar targetChildIndex = el.index() + 1;\n\t\t\tvar $addItemWrap = this.$addItemWrap.detach().hide();\n\n\t\t\tthis.$pillGroup.find('.pill:nth-child(' + targetChildIndex + ')').before($addItemWrap);\n\t\t\tthis.currentEdit = el.detach();\n\n\t\t\t$addItemWrap.addClass('editing');\n\t\t\tthis.$addItem.val(el.find('span:first').html());\n\t\t\t$addItemWrap.show();\n\t\t\tthis.$addItem.focus().select();\n\t\t},\n\n\t\tcancelEdit: function cancelEdit (e) {\n\t\t\tvar $addItemWrap;\n\t\t\tif (!this.currentEdit) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis._closeSuggestions();\n\t\t\tif (e) {\n\t\t\t\tthis.$addItemWrap.before(this.currentEdit);\n\t\t\t}\n\n\t\t\tthis.currentEdit = false;\n\n\t\t\t$addItemWrap = this.$addItemWrap.detach();\n\t\t\t$addItemWrap.removeClass('editing');\n\t\t\tthis.$addItem.val('');\n\t\t\tthis.$pillGroup.append($addItemWrap);\n\n\t\t\treturn true;\n\t\t},\n\n\t\t// Must match syntax of placeItem so addItem callback is called when an item is edited\n\t\t// expecting to receive an array back from the callback containing edited items\n\t\tsaveEdit: function saveEdit () {\n\t\t\tvar item = arguments[0][0] ? arguments[0][0] : arguments[0];\n\n\t\t\tthis.currentEdit = $(item.el);\n\t\t\tthis.currentEdit.data('value', item.value);\n\t\t\tthis.currentEdit.find('span:first').html(item.text);\n\n\t\t\tthis.$addItemWrap.hide();\n\t\t\tthis.$addItemWrap.before(this.currentEdit);\n\t\t\tthis.currentEdit = false;\n\n\t\t\tthis.$addItem.val('');\n\t\t\tthis.$addItemWrap.removeClass('editing');\n\t\t\tthis.$pillGroup.append(this.$addItemWrap.detach().show());\n\t\t\tthis.$element.trigger('edited.fu.pillbox', {\n\t\t\t\tvalue: item.value,\n\t\t\t\ttext: item.text\n\t\t\t});\n\t\t},\n\n\t\tremoveBySelector: function removeBySelector () {\n\t\t\tvar selectors = [].slice.call(arguments).slice(0);\n\t\t\tvar self = this;\n\n\t\t\t$.each(selectors, function doRemove (i, sel) {\n\t\t\t\tself.$pillGroup.find(sel).remove();\n\t\t\t});\n\n\t\t\tthis._removePillTrigger({\n\t\t\t\tmethod: 'removeBySelector',\n\t\t\t\tremovedSelectors: selectors\n\t\t\t});\n\t\t},\n\n\t\tremoveByValue: function removeByValue () {\n\t\t\tvar values = [].slice.call(arguments).slice(0);\n\t\t\tvar self = this;\n\n\t\t\t$.each(values, function doRemove (i, val) {\n\t\t\t\tself.$pillGroup.find('> .pill[data-value=\"' + val + '\"]').remove();\n\t\t\t});\n\n\t\t\tthis._removePillTrigger({\n\t\t\t\tmethod: 'removeByValue',\n\t\t\t\tremovedValues: values\n\t\t\t});\n\t\t},\n\n\t\tremoveByText: function removeByText () {\n\t\t\tvar text = [].slice.call(arguments).slice(0);\n\t\t\tvar self = this;\n\n\t\t\t$.each(text, function doRemove (i, matchingText) {\n\t\t\t\tself.$pillGroup.find('> .pill:contains(\"' + matchingText + '\")').remove();\n\t\t\t});\n\n\t\t\tthis._removePillTrigger({\n\t\t\t\tmethod: 'removeByText',\n\t\t\t\tremovedText: text\n\t\t\t});\n\t\t},\n\n\t\ttruncate: function truncate (enable) {\n\t\t\tvar self = this;\n\n\t\t\tthis.$element.removeClass('truncate');\n\t\t\tthis.$addItemWrap.removeClass('truncated');\n\t\t\tthis.$pillGroup.find('.pill').removeClass('truncated');\n\n\t\t\tif (enable) {\n\t\t\t\tthis.$element.addClass('truncate');\n\n\t\t\t\tvar availableWidth = this.$element.width();\n\t\t\t\tvar containerFull = false;\n\t\t\t\tvar processedPills = 0;\n\t\t\t\tvar totalPills = this.$pillGroup.find('.pill').length;\n\t\t\t\tvar widthUsed = 0;\n\n\t\t\t\tthis.$pillGroup.find('.pill').each(function processPills () {\n\t\t\t\t\tvar pill = $(this);\n\t\t\t\t\tif (!containerFull) {\n\t\t\t\t\t\tprocessedPills++;\n\t\t\t\t\t\tself.$moreCount.text(totalPills - processedPills);\n\t\t\t\t\t\tif ((widthUsed + pill.outerWidth(true) + self.$addItemWrap.outerWidth(true)) <= availableWidth) {\n\t\t\t\t\t\t\twidthUsed += pill.outerWidth(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tself.$moreCount.text((totalPills - processedPills) + 1);\n\t\t\t\t\t\t\tpill.addClass('truncated');\n\t\t\t\t\t\t\tcontainerFull = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpill.addClass('truncated');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (processedPills === totalPills) {\n\t\t\t\t\tthis.$addItemWrap.addClass('truncated');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tinputFocus: function inputFocus () {\n\t\t\tthis.$element.find('.pillbox-add-item').focus();\n\t\t},\n\n\t\tgetItemData: function getItemData (el, data) {\n\t\t\treturn langx.mixin({\n\t\t\t\ttext: el.find('span:first').html()\n\t\t\t}, el.data(), data);\n\t\t},\n\n\t\t_removeElement: function _removeElement (data) {\n\t\t\tdata.el.remove();\n\t\t\tdelete data.el;\n\t\t\tthis.$element.trigger('removed.fu.pillbox', data);\n\t\t},\n\n\t\t_removePillTrigger: function _removePillTrigger (removedBy) {\n\t\t\tthis.$element.trigger('removed.fu.pillbox', removedBy);\n\t\t},\n\n\t\t_generateObject: function _generateObject (data) {\n\t\t\tvar obj = {};\n\n\t\t\t$.each(data, function setObjectValue (index, value) {\n\t\t\t\tobj[value] = true;\n\t\t\t});\n\n\t\t\treturn obj;\n\t\t},\n\n\t\t_openSuggestions: function _openSuggestions (e, data) {\n\t\t\tvar $suggestionList = $('<ul>');\n\n\t\t\tif (this.callbackId !== e.timeStamp) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (data.data && data.data.length) {\n\t\t\t\t$.each(data.data, function appendSuggestions (index, value) {\n\t\t\t\t\tvar val = value.value ? value.value : value.text;\n\n\t\t\t\t\t// markup concatentation is 10x faster, but does not allow data store\n\t\t\t\t\tvar $suggestion = $('<li data-value=\"' + val + '\">' + value.text + '</li>');\n\n\t\t\t\t\tif (value.attr) {\n\t\t\t\t\t\t$suggestion.data('attr', JSON.stringify(value.attr));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (value.data) {\n\t\t\t\t\t\t$suggestion.data('data', value.data);\n\t\t\t\t\t}\n\n\t\t\t\t\t$suggestionList.append($suggestion);\n\t\t\t\t});\n\n\t\t\t\t// suggestion dropdown\n\t\t\t\tthis.$suggest.html('').append($suggestionList.children());\n\t\t\t\t$(document).trigger('suggested.fu.pillbox', this.$suggest);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\t_closeSuggestions: function _closeSuggestions () {\n\t\t\tthis.$suggest.html('').parent().removeClass('open');\n\t\t},\n\n\t\t_isSuggestionsOpen: function _isSuggestionsOpen () {\n\t\t\treturn this.$suggest.parent().hasClass('open');\n\t\t},\n\n\t\t_keySuggestions: function _keySuggestions (e) {\n\t\t\tvar $first = this.$suggest.find('li.pillbox-suggest-sel');\n\t\t\tvar dir = isUpArrow(e);\n\n\t\t\te.preventDefault();\n\n\t\t\tif (!$first.length) {\n\t\t\t\t$first = this.$suggest.find('li:first');\n\t\t\t\t$first.addClass('pillbox-suggest-sel');\n\t\t\t} else {\n\t\t\t\tvar $next = dir ? $first.prev() : $first.next();\n\n\t\t\t\tif (!$next.length) {\n\t\t\t\t\t$next = dir ? this.$suggest.find('li:last') : this.$suggest.find('li:first');\n\t\t\t\t}\n\n\t\t\t\tif ($next) {\n\t\t\t\t\t$next.addClass('pillbox-suggest-sel');\n\t\t\t\t\t$first.removeClass('pillbox-suggest-sel');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tPillbox.prototype.getValue = Pillbox.prototype.items;\n\n\t// PILLBOX PLUGIN DEFINITION\n\n\t$.fn.pillbox = function pillbox (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function set () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.pillbox');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.pillbox', (data = new Pillbox(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.pillbox.defaults = {\n\t\tedit: false,\n\t\treadonly: -1, // can be true or false. -1 means it will check for data-readonly=\"readonly\"\n\t\ttruncate: false,\n\t\tacceptKeyCodes: [\n\t\t\tENTER_KEYCODE,\n\t\t\tCOMMA_KEYCODE\n\t\t],\n\t\tallowEmptyPills: false,\n\t\tcleanInput: cleanInput\n\n\t\t// example on remove\n\t\t/* onRemove: function(data,callback){\n\t\t\tconsole.log('onRemove');\n\t\t\tcallback(data);\n\t\t} */\n\n\t\t// example on key down\n\t\t/* onKeyDown: function(event, data, callback ){\n\t\t\tcallback({data:[\n\t\t\t\t{text: Math.random(),value:'sdfsdfsdf'},\n\t\t\t\t{text: Math.random(),value:'sdfsdfsdf'}\n\t\t\t]});\n\t\t}\n\t\t*/\n\t\t// example onAdd\n\t\t/* onAdd: function( data, callback ){\n\t\t\tconsole.log(data, callback);\n\t\t\tcallback(data);\n\t\t} */\n\t};\n\n\t$.fn.pillbox.Constructor = Pillbox;\n\n\t$.fn.pillbox.noConflict = function noConflict () {\n\t\t$.fn.pillbox = old;\n\t\treturn this;\n\t};\n\n\n\t// DATA-API\n\n\t$(document).on('mousedown.fu.pillbox.data-api', '[data-initialize=pillbox]', function dataAPI (e) {\n\t\tvar $control = $(e.target).closest('.pillbox');\n\t\tif (!$control.data('fu.pillbox')) {\n\t\t\t$control.pillbox($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function DOMReady () {\n\t\t$('[data-initialize=pillbox]').each(function init () {\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.data('fu.pillbox')) return;\n\t\t\t$this.pillbox($this.data());\n\t\t});\n\t});\n\n});\n"]}
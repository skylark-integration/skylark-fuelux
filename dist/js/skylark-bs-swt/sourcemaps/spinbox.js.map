{"version":3,"sources":["spinbox.js"],"names":["define","langx","browser","eventer","noder","geom","$","old","fn","spinbox","Spinbox","element","options","this","$element","find","on","e","preventDefault","mixin","defaults","step","data","value","min","max","$input","proxy","change","keydown","keyup","hold","startSpin","stopSpin","switches","count","enabled","speed","defaultUnit","_isUnitLegal","units","unit","lastValue","render","disabled","disable","_limitToStep","number","Math","round","validUnits","legalUnit","suspectUnit","toLowerCase","each","i","validUnit","_applyLimits","isNaN","parseFloat","cycle","limitToStep","prototype","constructor","destroy","remove","attr","val","outerHTML","_setValue","getDisplayValue","triggerChangedEvent","undefined","timeout","clearTimeout","currentValue","getValue","trigger","type","divisor","setTimeout","iterate","isIncrease","newVal","toFixed","inputValue","parseInput","setDisplayValue","decimalMark","split","join","setValue","shouldSetLastValue","potentialUnit","replace","intVal","getIntValue","isFinite","call","addClass","enable","removeClass","removeAttr","event","keyCode","option","methodReturn","args","Array","slice","arguments","$set","$this","apply","Constructor","noConflict"],"mappings":"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","file":"../spinbox.js","sourcesContent":["define([\n  \"skylark-utils/langx\",\n  \"skylark-utils/browser\",\n  \"skylark-utils/eventer\",\n  \"skylark-utils/noder\",\n  \"skylark-utils/geom\",\n  \"skylark-utils/query\"\n],function(langx,browser,eventer,noder,geom,$){\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\tvar old = $.fn.spinbox;\n\n\t// SPINBOX CONSTRUCTOR AND PROTOTYPE\n\n\tvar Spinbox = function Spinbox(element, options) {\n\t\tthis.$element = $(element);\n\t\tthis.$element.find('.btn').on('click', function (e) {\n\t\t\t//keep spinbox from submitting if they forgot to say type=\"button\" on their spinner buttons\n\t\t\te.preventDefault();\n\t\t});\n\t\tthis.options = langx.mixin({}, $.fn.spinbox.defaults, options);\n\t\tthis.options.step = this.$element.data('step') || this.options.step;\n\n\t\tif (this.options.value < this.options.min) {\n\t\t\tthis.options.value = this.options.min;\n\t\t} else if (this.options.max < this.options.value) {\n\t\t\tthis.options.value = this.options.max;\n\t\t}\n\n\t\tthis.$input = this.$element.find('.spinbox-input');\n\t\tthis.$input.on('focusout.fu.spinbox', this.$input, langx.proxy(this.change, this));\n\t\tthis.$element.on('keydown.fu.spinbox', this.$input, langx.proxy(this.keydown, this));\n\t\tthis.$element.on('keyup.fu.spinbox', this.$input, langx.proxy(this.keyup, this));\n\n\t\tif (this.options.hold) {\n\t\t\tthis.$element.on('mousedown.fu.spinbox', '.spinbox-up', langx.proxy(function () {\n\t\t\t\tthis.startSpin(true);\n\t\t\t}, this));\n\t\t\tthis.$element.on('mouseup.fu.spinbox', '.spinbox-up, .spinbox-down', langx.proxy(this.stopSpin, this));\n\t\t\tthis.$element.on('mouseout.fu.spinbox', '.spinbox-up, .spinbox-down', langx.proxy(this.stopSpin, this));\n\t\t\tthis.$element.on('mousedown.fu.spinbox', '.spinbox-down', langx.proxy(function () {\n\t\t\t\tthis.startSpin(false);\n\t\t\t}, this));\n\t\t} else {\n\t\t\tthis.$element.on('click.fu.spinbox', '.spinbox-up', langx.proxy(function () {\n\t\t\t\tthis.step(true);\n\t\t\t}, this));\n\t\t\tthis.$element.on('click.fu.spinbox', '.spinbox-down', langx.proxy(function () {\n\t\t\t\tthis.step(false);\n\t\t\t}, this));\n\t\t}\n\n\t\tthis.switches = {\n\t\t\tcount: 1,\n\t\t\tenabled: true\n\t\t};\n\n\t\tif (this.options.speed === 'medium') {\n\t\t\tthis.switches.speed = 300;\n\t\t} else if (this.options.speed === 'fast') {\n\t\t\tthis.switches.speed = 100;\n\t\t} else {\n\t\t\tthis.switches.speed = 500;\n\t\t}\n\n\t\tthis.options.defaultUnit = _isUnitLegal(this.options.defaultUnit, this.options.units) ? this.options.defaultUnit : '';\n\t\tthis.unit = this.options.defaultUnit;\n\n\t\tthis.lastValue = this.options.value;\n\n\t\tthis.render();\n\n\t\tif (this.options.disabled) {\n\t\t\tthis.disable();\n\t\t}\n\t};\n\n\t// Truly private methods\n\tvar _limitToStep = function _limitToStep(number, step) {\n\t\treturn Math.round(number / step) * step;\n\t};\n\n\tvar _isUnitLegal = function _isUnitLegal(unit, validUnits) {\n\t\tvar legalUnit = false;\n\t\tvar suspectUnit = unit.toLowerCase();\n\n\t\tlangx.each(validUnits, function (i, validUnit) {\n\t\t\tvalidUnit = validUnit.toLowerCase();\n\t\t\tif (suspectUnit === validUnit) {\n\t\t\t\tlegalUnit = true;\n\t\t\t\treturn false;//break out of the loop\n\t\t\t}\n\t\t});\n\n\t\treturn legalUnit;\n\t};\n\n\tvar _applyLimits = function _applyLimits(value) {\n\t\t// if unreadable\n\t\tif (isNaN(parseFloat(value))) {\n\t\t\treturn value;\n\t\t}\n\n\t\t// if not within range return the limit\n\t\tif (value > this.options.max) {\n\t\t\tif (this.options.cycle) {\n\t\t\t\tvalue = this.options.min;\n\t\t\t} else {\n\t\t\t\tvalue = this.options.max;\n\t\t\t}\n\t\t} else if (value < this.options.min) {\n\t\t\tif (this.options.cycle) {\n\t\t\t\tvalue = this.options.max;\n\t\t\t} else {\n\t\t\t\tvalue = this.options.min;\n\t\t\t}\n\t\t}\n\n\t\tif (this.options.limitToStep && this.options.step) {\n\t\t\tvalue = _limitToStep(value, this.options.step);\n\n\t\t\t//force round direction so that it stays within bounds\n\t\t\tif(value > this.options.max){\n\t\t\t\tvalue = value - this.options.step;\n\t\t\t} else if(value < this.options.min) {\n\t\t\t\tvalue = value + this.options.step;\n\t\t\t}\n\t\t}\n\n\t\treturn value;\n\t};\n\n\tSpinbox.prototype = {\n\t\tconstructor: Spinbox,\n\n\t\tdestroy: function destroy() {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\t\t\t// set input value attrbute\n\t\t\tthis.$element.find('input').each(function () {\n\t\t\t\t$(this).attr('value', $(this).val());\n\t\t\t});\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\trender: function render() {\n\t\t\tthis._setValue(this.getDisplayValue());\n\t\t},\n\n\t\tchange: function change() {\n\t\t\tthis._setValue(this.getDisplayValue());\n\n\t\t\tthis.triggerChangedEvent();\n\t\t},\n\n\t\tstopSpin: function stopSpin() {\n\t\t\tif (this.switches.timeout !== undefined) {\n\t\t\t\tclearTimeout(this.switches.timeout);\n\t\t\t\tthis.switches.count = 1;\n\t\t\t\tthis.triggerChangedEvent();\n\t\t\t}\n\t\t},\n\n\t\ttriggerChangedEvent: function triggerChangedEvent() {\n\t\t\tvar currentValue = this.getValue();\n\t\t\tif (currentValue === this.lastValue) return;\n\t\t\tthis.lastValue = currentValue;\n\n\t\t\t// Primary changed event\n\t\t\tthis.$element.trigger('changed.fu.spinbox', currentValue);\n\t\t},\n\n\t\tstartSpin: function startSpin(type) {\n\t\t\tif (!this.options.disabled) {\n\t\t\t\tvar divisor = this.switches.count;\n\n\t\t\t\tif (divisor === 1) {\n\t\t\t\t\tthis.step(type);\n\t\t\t\t\tdivisor = 1;\n\t\t\t\t} else if (divisor < 3) {\n\t\t\t\t\tdivisor = 1.5;\n\t\t\t\t} else if (divisor < 8) {\n\t\t\t\t\tdivisor = 2.5;\n\t\t\t\t} else {\n\t\t\t\t\tdivisor = 4;\n\t\t\t\t}\n\n\t\t\t\tthis.switches.timeout = setTimeout(langx.proxy(function () {\n\t\t\t\t\tthis.iterate(type);\n\t\t\t\t}, this), this.switches.speed / divisor);\n\t\t\t\tthis.switches.count++;\n\t\t\t}\n\t\t},\n\n\t\titerate: function iterate(type) {\n\t\t\tthis.step(type);\n\t\t\tthis.startSpin(type);\n\t\t},\n\n\t\tstep: function step(isIncrease) {\n\t\t\t//refresh value from display before trying to increment in case they have just been typing before clicking the nubbins\n\t\t\tthis._setValue(this.getDisplayValue());\n\t\t\tvar newVal;\n\n\t\t\tif (isIncrease) {\n\t\t\t\tnewVal = this.options.value + this.options.step;\n\t\t\t} else {\n\t\t\t\tnewVal = this.options.value - this.options.step;\n\t\t\t}\n\n\t\t\tnewVal = newVal.toFixed(5);\n\n\t\t\tthis._setValue(newVal + this.unit);\n\t\t},\n\n\t\tgetDisplayValue: function getDisplayValue() {\n\t\t\tvar inputValue = this.parseInput(this.$input.val());\n\t\t\tvar value = (!!inputValue) ? inputValue : this.options.value;\n\t\t\treturn value;\n\t\t},\n\n\t\tsetDisplayValue: function setDisplayValue(value) {\n\t\t\tthis.$input.val(value);\n\t\t},\n\n\t\tgetValue: function getValue() {\n\t\t\tvar val = this.options.value;\n\t\t\tif (this.options.decimalMark !== '.'){\n\t\t\t\tval = (val + '').split('.').join(this.options.decimalMark);\n\t\t\t}\n\t\t\treturn val + this.unit;\n\t\t},\n\n\t\tsetValue: function setValue(val) {\n\t\t\treturn this._setValue(val, true);\n\t\t},\n\n\t\t_setValue: function _setValue(val, shouldSetLastValue) {\n\t\t\t//remove any i18n on the number\n\t\t\tif (this.options.decimalMark !== '.') {\n\t\t\t\tval = this.parseInput(val);\n\t\t\t}\n\n\t\t\t//are we dealing with united numbers?\n\t\t\tif(typeof val !== \"number\"){\n\t\t\t\tvar potentialUnit = val.replace(/[0-9.-]/g, '');\n\t\t\t\t//make sure unit is valid, or else drop it in favor of current unit, or default unit (potentially nothing)\n\t\t\t\tthis.unit = _isUnitLegal(potentialUnit, this.options.units) ? potentialUnit : this.options.defaultUnit;\n\t\t\t}\n\n\t\t\tvar intVal = this.getIntValue(val);\n\n\t\t\t//make sure we are dealing with a number\n\t\t\tif (isNaN(intVal) && !isFinite(intVal)) {\n\t\t\t\treturn this._setValue(this.options.value, shouldSetLastValue);\n\t\t\t}\n\n\t\t\t//conform\n\t\t\tintVal = _applyLimits.call(this, intVal);\n\n\t\t\t//cache the pure int value\n\t\t\tthis.options.value = intVal;\n\n\t\t\t//prepare number for display\n\t\t\tval = intVal + this.unit;\n\n\t\t\tif (this.options.decimalMark !== '.'){\n\t\t\t\tval = (val + '').split('.').join(this.options.decimalMark);\n\t\t\t}\n\n\t\t\t//display number\n\t\t\tthis.setDisplayValue(val);\n\n\t\t\tif (shouldSetLastValue) {\n\t\t\t\tthis.lastValue = val;\n\t\t\t}\n\n\t\t\treturn this;\n\t\t},\n\n\t\tvalue: function value(val) {\n\t\t\tif (val || val === 0) {\n\t\t\t\treturn this.setValue(val);\n\t\t\t} else {\n\t\t\t\treturn this.getValue();\n\t\t\t}\n\t\t},\n\n\t\tparseInput: function parseInput(value) {\n\t\t\tvalue = (value + '').split(this.options.decimalMark).join('.');\n\n\t\t\treturn value;\n\t\t},\n\n\t\tgetIntValue: function getIntValue(value) {\n\t\t\t//if they didn't pass in a number, try and get the number\n\t\t\tvalue = (typeof value === \"undefined\") ? this.getValue() : value;\n\t\t\t// if there still isn't a number, abort\n\t\t\tif(typeof value === \"undefined\"){return;}\n\n\t\t\tif (typeof value === 'string'){\n\t\t\t\tvalue = this.parseInput(value);\n\t\t\t}\n\n\t\t\tvalue = parseFloat(value, 10);\n\n\t\t\treturn value;\n\t\t},\n\n\t\tdisable: function disable() {\n\t\t\tthis.options.disabled = true;\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$input.attr('disabled', '');\n\t\t\tthis.$element.find('button').addClass('disabled');\n\t\t},\n\n\t\tenable: function enable() {\n\t\t\tthis.options.disabled = false;\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$input.removeAttr('disabled');\n\t\t\tthis.$element.find('button').removeClass('disabled');\n\t\t},\n\n\t\tkeydown: function keydown(event) {\n\t\t\tvar keyCode = event.keyCode;\n\t\t\tif (keyCode === 38) {\n\t\t\t\tthis.step(true);\n\t\t\t} else if (keyCode === 40) {\n\t\t\t\tthis.step(false);\n\t\t\t} else if (keyCode === 13) {\n\t\t\t\tthis.change();\n\t\t\t}\n\t\t},\n\n\t\tkeyup: function keyup(event) {\n\t\t\tvar keyCode = event.keyCode;\n\n\t\t\tif (keyCode === 38 || keyCode === 40) {\n\t\t\t\tthis.triggerChangedEvent();\n\t\t\t}\n\t\t}\n\n\t};\n\n\n\t// SPINBOX PLUGIN DEFINITION\n\n\t$.fn.spinbox = function spinbox(option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.spinbox');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.spinbox', (data = new Spinbox(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t// value needs to be 0 for this.render();\n\t$.fn.spinbox.defaults = {\n\t\tvalue: 0,\n\t\tmin: 0,\n\t\tmax: 999,\n\t\tstep: 1,\n\t\thold: true,\n\t\tspeed: 'medium',\n\t\tdisabled: false,\n\t\tcycle: false,\n\t\tunits: [],\n\t\tdecimalMark: '.',\n\t\tdefaultUnit: '',\n\t\tlimitToStep: false\n\t};\n\n\t$.fn.spinbox.Constructor = Spinbox;\n\n\t$.fn.spinbox.noConflict = function noConflict() {\n\t\t$.fn.spinbox = old;\n\t\treturn this;\n\t};\n\n\n\t// DATA-API\n\n\t/*\n\t$(document).on('mousedown.fu.spinbox.data-api', '[data-initialize=spinbox]', function (e) {\n\t\tvar $control = $(e.target).closest('.spinbox');\n\t\tif (!$control.data('fu.spinbox')) {\n\t\t\t$control.spinbox($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function () {\n\t\t$('[data-initialize=spinbox]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif (!$this.data('fu.spinbox')) {\n\t\t\t\t$this.spinbox($this.data());\n\t\t\t}\n\t\t});\n\t});\n\t*/\n\n});\n"]}
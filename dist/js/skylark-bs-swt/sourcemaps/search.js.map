{"version":3,"sources":["search.js"],"names":["define","langx","browser","eventer","noder","geom","$","old","fn","search","Search","element","options","this","$element","$repeater","closest","mixin","defaults","attr","searchOnKeyPress","$button","find","$input","$icon","on","proxy","buttonclicked","keypress","length","clearPending","activeSearch","prototype","constructor","destroy","remove","each","val","outerHTML","searchText","hasClass","removeClass","addClass","trigger","clear","action","e","preventDefault","currentTarget","is","ENTER_KEY_CODE","TAB_KEY_CODE","ESC_KEY_CODE","which","disable","allowCancel","enable","removeAttr","option","methodReturn","args","Array","slice","call","arguments","$set","$this","data","apply","undefined","clearOnEmpty","Constructor","noConflict","document","$control","target"],"mappings":"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","file":"../search.js","sourcesContent":["define([\n  \"skylark-utils/langx\",\n  \"skylark-utils/browser\",\n  \"skylark-utils/eventer\",\n  \"skylark-utils/noder\",\n  \"skylark-utils/geom\",\n  \"skylark-utils/query\"\n],function(langx,browser,eventer,noder,geom,$){\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\tvar old = $.fn.search;\n\n\t// SEARCH CONSTRUCTOR AND PROTOTYPE\n\n\tvar Search = function (element, options) {\n\t\tthis.$element = $(element);\n\t\tthis.$repeater = $(element).closest('.repeater');\n\t\tthis.options = langx.mixin({}, $.fn.search.defaults, options);\n\n\t\tif (this.$element.attr('data-searchOnKeyPress') === 'true'){\n\t\t\tthis.options.searchOnKeyPress = true;\n\t\t}\n\n\t\tthis.$button = this.$element.find('button');\n\t\tthis.$input = this.$element.find('input');\n\t\tthis.$icon = this.$element.find('.glyphicon, .fuelux-icon');\n\n\t\tthis.$button.on('click.fu.search', langx.proxy(this.buttonclicked, this));\n\t\tthis.$input.on('keyup.fu.search', langx.proxy(this.keypress, this));\n\n\t\tif (this.$repeater.length > 0) {\n\t\t\tthis.$repeater.on('rendered.fu.repeater', langx.proxy(this.clearPending, this));\n\t\t}\n\n\t\tthis.activeSearch = '';\n\t};\n\n\tSearch.prototype = {\n\t\tconstructor: Search,\n\n\t\tdestroy: function () {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\t\t\t// set input value attrbute\n\t\t\tthis.$element.find('input').each(function () {\n\t\t\t\t$(this).attr('value', $(this).val());\n\t\t\t});\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tsearch: function (searchText) {\n\t\t\tif (this.$icon.hasClass('glyphicon')) {\n\t\t\t\tthis.$icon.removeClass('glyphicon-search').addClass('glyphicon-remove');\n\t\t\t}\n\t\t\tif (this.$icon.hasClass('fuelux-icon')) {\n\t\t\t\tthis.$icon.removeClass('fuelux-icon-search').addClass('fuelux-icon-remove');\n\t\t\t}\n\n\t\t\tthis.activeSearch = searchText;\n\t\t\tthis.$element.addClass('searched pending');\n\t\t\tthis.$element.trigger('searched.fu.search', searchText);\n\t\t},\n\n\t\tclear: function () {\n\t\t\tif (this.$icon.hasClass('glyphicon')) {\n\t\t\t\tthis.$icon.removeClass('glyphicon-remove').addClass('glyphicon-search');\n\t\t\t}\n\t\t\tif (this.$icon.hasClass('fuelux-icon')) {\n\t\t\t\tthis.$icon.removeClass('fuelux-icon-remove').addClass('fuelux-icon-search');\n\t\t\t}\n\n\t\t\tif (this.$element.hasClass('pending')) {\n\t\t\t\tthis.$element.trigger('canceled.fu.search');\n\t\t\t}\n\n\t\t\tthis.activeSearch = '';\n\t\t\tthis.$input.val('');\n\t\t\tthis.$element.trigger('cleared.fu.search');\n\t\t\tthis.$element.removeClass('searched pending');\n\t\t},\n\n\t\tclearPending: function () {\n\t\t\tthis.$element.removeClass('pending');\n\t\t},\n\n\t\taction: function () {\n\t\t\tvar val = this.$input.val();\n\n\t\t\tif (val && val.length > 0) {\n\t\t\t\tthis.search(val);\n\t\t\t} else {\n\t\t\t\tthis.clear();\n\t\t\t}\n\t\t},\n\n\t\tbuttonclicked: function (e) {\n\t\t\te.preventDefault();\n\t\t\tif ($(e.currentTarget).is('.disabled, :disabled')) return;\n\n\t\t\tif (this.$element.hasClass('pending') || this.$element.hasClass('searched')) {\n\t\t\t\tthis.clear();\n\t\t\t} else {\n\t\t\t\tthis.action();\n\t\t\t}\n\t\t},\n\n\t\tkeypress: function (e) {\n\t\t\tvar ENTER_KEY_CODE = 13;\n\t\t\tvar TAB_KEY_CODE = 9;\n\t\t\tvar ESC_KEY_CODE = 27;\n\n\t\t\tif (e.which === ENTER_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.action();\n\t\t\t} else if (e.which === TAB_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t} else if (e.which === ESC_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.clear();\n\t\t\t} else if (this.options.searchOnKeyPress) {\n\t\t\t\t// search on other keypress\n\t\t\t\tthis.action();\n\t\t\t}\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$input.attr('disabled', 'disabled');\n\n\t\t\tif (!this.options.allowCancel) {\n\t\t\t\tthis.$button.addClass('disabled');\n\t\t\t}\n\t\t},\n\n\t\tenable: function () {\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$input.removeAttr('disabled');\n\t\t\tthis.$button.removeClass('disabled');\n\t\t}\n\t};\n\n\n\t// SEARCH PLUGIN DEFINITION\n\n\t$.fn.search = function (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.search');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.search', (data = new Search(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.search.defaults = {\n\t\tclearOnEmpty: false,\n\t\tsearchOnKeyPress: false,\n\t\tallowCancel: false\n\t};\n\n\t$.fn.search.Constructor = Search;\n\n\t$.fn.search.noConflict = function () {\n\t\t$.fn.search = old;\n\t\treturn this;\n\t};\n\n\n\t// DATA-API\n\n\t$(document).on('mousedown.fu.search.data-api', '[data-initialize=search]', function (e) {\n\t\tvar $control = $(e.target).closest('.search');\n\t\tif (!$control.data('fu.search')) {\n\t\t\t$control.search($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function () {\n\t\t$('[data-initialize=search]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.data('fu.search')) return;\n\t\t\t$this.search($this.data());\n\t\t});\n\t});\n\n});\n"]}
/**
 * skylark-bs-swt - The skylark bootstrap standard widget tookit
 * @author Hudaokeji, Inc.
 * @version v0.9.0-beta
 * @link https://github.com/skylarkui/skylark-bs-swt/
 * @license MIT
 */
define(["skylark-utils/langx","skylark-utils/browser","skylark-utils/eventer","skylark-utils/noder","skylark-utils/geom","skylark-utils/query"],function(e,t,i,n,r,s){var c=s.fn.picker,o=function(t,i){var n=this;this.$element=s(t),this.options=e.mixin({},s.fn.picker.defaults,i),this.$accept=this.$element.find(".picker-accept"),this.$cancel=this.$element.find(".picker-cancel"),this.$trigger=this.$element.find(".picker-trigger"),this.$footer=this.$element.find(".picker-footer"),this.$header=this.$element.find(".picker-header"),this.$popup=this.$element.find(".picker-popup"),this.$body=this.$element.find(".picker-body"),this.clickStamp="_",this.isInput=this.$trigger.is("input"),this.$trigger.on("keydown.fu.picker",s.proxy(this.keyComplete,this)),this.$trigger.on("focus.fu.picker",s.proxy(function(e){("undefined"==typeof e||s(e.target).is("input[type=text]"))&&s.proxy(this.show(),this)},this)),this.$trigger.on("click.fu.picker",s.proxy(function(e){s(e.target).is("input[type=text]")?s.proxy(this.show(),this):s.proxy(this.toggle(),this)},this)),this.$accept.on("click.fu.picker",s.proxy(this.complete,this,"accepted")),this.$cancel.on("click.fu.picker",function(e){e.preventDefault(),n.complete("cancelled")})},p=function(e){var t=Math.max(document.documentElement.clientHeight,window.innerHeight||0),i=s(document).scrollTop(),n=e.$popup.offset(),r=n.top+e.$popup.outerHeight(!0);return r>t+i||n.top<i},l=function(e){e.$popup.css("visibility","hidden"),h(e),p(e)&&(a(e),p(e)&&h(e)),e.$popup.css("visibility","visible")},a=function(e){e.$popup.css("top",-e.$popup.outerHeight(!0)+"px")},h=function(e){e.$popup.css("top",e.$trigger.outerHeight(!0)+"px")};o.prototype={constructor:o,complete:function(e){var t={accepted:"onAccept",cancelled:"onCancel",exited:"onExit"},i=this.options[t[e]],n={contents:this.$body};i?(i(n),this.$element.trigger(e+".fu.picker",n)):(this.$element.trigger(e+".fu.picker",n),this.hide())},keyComplete:function(e){this.isInput&&13===e.keyCode?(this.complete("accepted"),this.$trigger.blur()):27===e.keyCode&&(this.complete("exited"),this.$trigger.blur())},destroy:function(){return this.$element.remove(),s(document).off("click.fu.picker.externalClick."+this.clickStamp),this.$element[0].outerHTML},disable:function(){this.$element.addClass("disabled"),this.$trigger.attr("disabled","disabled")},enable:function(){this.$element.removeClass("disabled"),this.$trigger.removeAttr("disabled")},toggle:function(){this.$element.hasClass("showing")?this.hide():this.show()},hide:function(){this.$element.hasClass("showing")&&(this.$element.removeClass("showing"),s(document).off("click.fu.picker.externalClick."+this.clickStamp),this.$element.trigger("hidden.fu.picker"))},externalClickListener:function(e,t){(t===!0||this.isExternalClick(e))&&this.complete("exited")},isExternalClick:function(e){var t,i,n=this.$element.get(0),r=this.options.externalClickExceptions||[],c=s(e.target);if(e.target===n||c.parents(".picker:first").get(0)===n)return!1;for(t=0,i=r.length;t<i;t++)if(c.is(r[t])||c.parents(r[t]).length>0)return!1;return!0},show:function(){var e;if(e=s(document).find(".picker.showing"),e.length>0){if(e.data("fu.picker")&&e.data("fu.picker").options.explicit)return;e.picker("externalClickListener",{},!0)}this.$element.addClass("showing"),l(this),this.$element.trigger("shown.fu.picker"),this.clickStamp=(new Date).getTime()+(Math.floor(100*Math.random())+1),this.options.explicit||s(document).on("click.fu.picker.externalClick."+this.clickStamp,s.proxy(this.externalClickListener,this))}},s.fn.picker=function(e){var t,i=Array.prototype.slice.call(arguments,1),n=this.each(function(){var n=s(this),r=n.data("fu.picker"),c="object"==typeof e&&e;r||n.data("fu.picker",r=new o(this,c)),"string"==typeof e&&(t=r[e].apply(r,i))});return void 0===t?n:t},s.fn.picker.defaults={onAccept:void 0,onCancel:void 0,onExit:void 0,externalClickExceptions:[],explicit:!1},s.fn.picker.Constructor=o,s.fn.picker.noConflict=function(){return s.fn.picker=c,this},s(document).on("focus.fu.picker.data-api","[data-initialize=picker]",function(e){var t=s(e.target).closest(".picker");t.data("fu.picker")||t.picker(t.data())}),s(function(){s("[data-initialize=picker]").each(function(){var e=s(this);e.data("fu.picker")||e.picker(e.data())})})});
//# sourceMappingURL=sourcemaps/picker.js.map

{"version":3,"sources":["skylark-fuelux.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"../skylark-fuelux.js","sourcesContent":["define('skylark-domx-spy/spy',[\r\n  \"skylark-langx/skylark\",\r\n],function(skylark){\r\n\r\n\r\n\treturn skylark.attach(\"domx.spy\",{});\r\n\r\n});\r\n\ndefine('skylark-domx-spy/Affix',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-browser\",\r\n  \"skylark-domx-eventer\",\r\n  \"skylark-domx-noder\",\r\n  \"skylark-domx-geom\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-domx-plugins\",\r\n  \"./spy\"\r\n],function(langx,browser,eventer,noder,geom,$,plugins,spy){\r\n\r\n  'use strict';\r\n\r\n  // AFFIX CLASS DEFINITION\r\n  // ======================\r\n\r\n  var Affix = spy.Affix = plugins.Plugin.inherit({\r\n        klassName: \"Affix\",\r\n\r\n        pluginName : \"domx.affix\",\r\n\r\n        options : {\r\n          offset: 0,\r\n          target: window\r\n        },\r\n\r\n        _construct : function(elm,options) {\r\n          this.overrided(elm,options);\r\n\r\n          this.$target = $(this.options.target)\r\n            .on('scroll.affix.data-api', langx.proxy(this.checkPosition, this))\r\n            .on('click.affix.data-api',  langx.proxy(this.checkPositionWithEventLoop, this))\r\n\r\n          this.$element     = this.$()\r\n          this.affixed      = null;\r\n          this.unpin        = null;\r\n          this.pinnedOffset = null;\r\n\r\n          this.checkPosition();\r\n        },\r\n\r\n        getState : function (scrollHeight, height, offsetTop, offsetBottom) {\r\n          var scrollTop    = this.$target.scrollTop()\r\n          var position     = this.$element.offset()\r\n          var targetHeight = this.$target.height()\r\n\r\n          if (offsetTop != null && this.affixed == 'top') return scrollTop < offsetTop ? 'top' : false\r\n\r\n          if (this.affixed == 'bottom') {\r\n            if (offsetTop != null) return (scrollTop + this.unpin <= position.top) ? false : 'bottom'\r\n            return (scrollTop + targetHeight <= scrollHeight - offsetBottom) ? false : 'bottom'\r\n          }\r\n\r\n          var initializing   = this.affixed == null\r\n          var colliderTop    = initializing ? scrollTop : position.top\r\n          var colliderHeight = initializing ? targetHeight : height\r\n\r\n          if (offsetTop != null && scrollTop <= offsetTop) return 'top'\r\n          if (offsetBottom != null && (colliderTop + colliderHeight >= scrollHeight - offsetBottom)) return 'bottom'\r\n\r\n          return false\r\n        },\r\n\r\n        getPinnedOffset : function () {\r\n          if (this.pinnedOffset) return this.pinnedOffset\r\n          this.$element.removeClass(Affix.RESET).addClass('affix')\r\n          var scrollTop = this.$target.scrollTop()\r\n          var position  = this.$element.offset()\r\n          return (this.pinnedOffset = position.top - scrollTop)\r\n        },\r\n\r\n        checkPositionWithEventLoop : function () {\r\n          setTimeout(langx.proxy(this.checkPosition, this), 1)\r\n        },\r\n\r\n        checkPosition : function () {\r\n          if (!this.$element.is(':visible')) return\r\n\r\n          var height       = this.$element.height()\r\n          var offset       = this.options.offset\r\n          var offsetTop    = offset.top\r\n          var offsetBottom = offset.bottom\r\n          var scrollHeight = Math.max($(document).height(), $(document.body).height())\r\n\r\n          if (typeof offset != 'object')         offsetBottom = offsetTop = offset\r\n          if (typeof offsetTop == 'function')    offsetTop    = offset.top(this.$element)\r\n          if (typeof offsetBottom == 'function') offsetBottom = offset.bottom(this.$element)\r\n\r\n          var affix = this.getState(scrollHeight, height, offsetTop, offsetBottom)\r\n\r\n          if (this.affixed != affix) {\r\n            if (this.unpin != null) this.$element.css('top', '')\r\n\r\n            var affixType = 'affix' + (affix ? '-' + affix : '')\r\n            var e         = eventer.create(affixType + '.affix')\r\n\r\n            this.$element.trigger(e)\r\n\r\n            if (e.isDefaultPrevented()) return\r\n\r\n            this.affixed = affix\r\n            this.unpin = affix == 'bottom' ? this.getPinnedOffset() : null\r\n\r\n            this.$element\r\n              .removeClass(Affix.RESET)\r\n              .addClass(affixType)\r\n              .trigger(affixType.replace('affix', 'affixed') + '.affix')\r\n          }\r\n\r\n          if (affix == 'bottom') {\r\n            this.$element.offset({\r\n              top: scrollHeight - height - offsetBottom\r\n            })\r\n          }\r\n        }\r\n  });\r\n\r\n  Affix.RESET    = 'affix affix-top affix-bottom'\r\n\r\n  plugins.register(Affix);\r\n\r\n  return spy.Affix = Affix;\r\n});\r\n\ndefine('skylark-bootstrap3/bs3',[\n  \"skylark-langx/skylark\",\n  \"skylark-langx/langx\",\n  \"skylark-domx-browser\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-noder\",\n  \"skylark-domx-geom\",\n  \"skylark-domx-query\"\n],function(skylark,langx,browser,eventer,noder,geom,$){\n\tvar ui = skylark.ui = skylark.ui || {}, \n\t\tbs3 = ui.bs3 = {};\n\n/*---------------------------------------------------------------------------------*/\n\t/*\n\t * Fuel UX utilities.js\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\tvar CONST = {\n\t\tBACKSPACE_KEYCODE: 8,\n\t\tCOMMA_KEYCODE: 188, // `,` & `<`\n\t\tDELETE_KEYCODE: 46,\n\t\tDOWN_ARROW_KEYCODE: 40,\n\t\tENTER_KEYCODE: 13,\n\t\tTAB_KEYCODE: 9,\n\t\tUP_ARROW_KEYCODE: 38\n\t};\n\n\tvar isShiftHeld = function isShiftHeld (e) { return e.shiftKey === true; };\n\n\tvar isKey = function isKey (keyCode) {\n\t\treturn function compareKeycodes (e) {\n\t\t\treturn e.keyCode === keyCode;\n\t\t};\n\t};\n\n\tvar isBackspaceKey = isKey(CONST.BACKSPACE_KEYCODE);\n\tvar isDeleteKey = isKey(CONST.DELETE_KEYCODE);\n\tvar isTabKey = isKey(CONST.TAB_KEYCODE);\n\tvar isUpArrow = isKey(CONST.UP_ARROW_KEYCODE);\n\tvar isDownArrow = isKey(CONST.DOWN_ARROW_KEYCODE);\n\n\tvar ENCODED_REGEX = /&[^\\s]*;/;\n\t/*\n\t * to prevent double encoding decodes content in loop until content is encoding free\n\t */\n\tvar cleanInput = function cleanInput (questionableMarkup) {\n\t\t// check for encoding and decode\n\t\twhile (ENCODED_REGEX.test(questionableMarkup)) {\n\t\t\tquestionableMarkup = $('<i>').html(questionableMarkup).text();\n\t\t}\n\n\t\t// string completely decoded now encode it\n\t\treturn $('<i>').text(questionableMarkup).html();\n\t};\n\n\n\n\n\tlangx.mixin(bs3, {\n\t\tCONST: CONST,\n\t\tcleanInput: cleanInput,\n\t\tisBackspaceKey: isBackspaceKey,\n\t\tisDeleteKey: isDeleteKey,\n\t\tisShiftHeld: isShiftHeld,\n\t\tisTabKey: isTabKey,\n\t\tisUpArrow: isUpArrow,\n\t\tisDownArrow: isDownArrow\n\t});\n\n\treturn bs3;\n});\n\ndefine('skylark-bootstrap3/affix',[\n  \"skylark-domx-plugins\",\n  \"skylark-domx-spy/Affix\",\n  \"./bs3\"\n],function(plugins,_Affix,bs3){\n\n\n/* ========================================================================\n * Bootstrap: affix.js v3.3.7\n * http://getbootstrap.com/javascript/#affix\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n  'use strict';\n\n  // AFFIX CLASS DEFINITION\n  // ======================\n\n  var Affix = bs3.Affix = _Affix.inherit({\n        klassName: \"Affix\",\n\n        pluginName : \"bs3.affix\"\n  });\n\n\n  Affix.VERSION  = '3.3.7'\n\n  /*\n  // AFFIX PLUGIN DEFINITION\n  // =======================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.affix')\n      var options = typeof option == 'object' && option\n\n      if (!data) $this.data('bs.affix', (data = new Affix(this, options)))\n      if (typeof option == 'string') data[option]()\n    })\n  }\n\n  var old = $.fn.affix\n\n  $.fn.affix             = Plugin;\n  $.fn.affix.Constructor = Affix;\n\n\n  // AFFIX NO CONFLICT\n  // =================\n\n  $.fn.affix.noConflict = function () {\n    $.fn.affix = old\n    return this\n  }\n\n\n  return $.fn.affix;\n  */\n\n  plugins.register(Affix,\"affix\");\n\n  return Affix;\n});\n\ndefine('skylark-bootstrap3/alert',[\n  \"skylark-langx/langx\",\n  \"skylark-domx-browser\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-noder\",\n  \"skylark-domx-geom\",\n  \"skylark-domx-query\",\n  \"skylark-domx-plugins\",\n  \"./bs3\"\n],function(langx,browser,eventer,noder,geom,$,plugins,bs3){\n\n/* ========================================================================\n * Bootstrap: alert.js v3.3.7\n * http://getbootstrap.com/javascript/#alerts\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n  'use strict';\n\n  // ALERT CLASS DEFINITION\n  // ======================\n\n  var dismiss = '[data-dismiss=\"alert\"]';\n\n  var Alert = bs3.Alert = plugins.Plugin.inherit({\n    klassName: \"Alert\",\n\n    pluginName : \"bs3.alert\",\n\n    _construct : function(el,options) {\n      $(el).on('click', dismiss, this.close)\n    },\n\n    close : function (e) {\n      var $this    = $(this);\n      var selector = $this.attr('data-target');\n\n      if (!selector) {\n        selector = $this.attr('href')\n        selector = selector && selector.replace(/.*(?=#[^\\s]*$)/, ''); // strip for ie7\n      }\n\n      var $parent = $(selector === '#' ? [] : selector);\n\n      if (e) e.preventDefault()\n\n      if (!$parent.length) {\n        $parent = $this.closest('.alert');\n      }\n\n      $parent.trigger(e = eventer.create('close.bs.alert'));\n\n      if (e.isDefaultPrevented()) {\n        return\n      }\n        \n      $parent.removeClass('in');\n\n      function removeElement() {\n        // detach from parent, fire event then clean up data\n        $parent.detach().trigger('closed.bs.alert').remove()\n      }\n\n      if (browser.support.transition) {\n        if ($parent.hasClass('fade') ) {\n          $parent.one('transitionEnd', removeElement)\n          .emulateTransitionEnd(Alert.TRANSITION_DURATION);\n        } else {\n          removeElement();\n        }\n\n      } \n    }\n  });\n\n\n  Alert.VERSION = '3.3.7';\n\n  Alert.TRANSITION_DURATION = 150;\n\n\n  /*\n  // ALERT PLUGIN DEFINITION\n  // =======================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this = $(this)\n      var wgt  = $this.data('bs.alert')\n\n      if (!wgt) {\n        $this.data('bs.alert', (wgt = new Alert(this)));\n      }\n      if (typeof option == 'string') {\n        wgt[option].call($this);\n      }\n    })\n  }\n\n  var old = $.fn.alert;\n\n  $.fn.alert             = Plugin;\n  $.fn.alert.Constructor = Alert;\n\n\n  // ALERT NO CONFLICT\n  // =================\n\n  $.fn.alert.noConflict = function () {\n    $.fn.alert = old;\n    return this;\n  }\n\n  return $.fn.alert;\n  */\n\n  plugins.register(Alert,\"alert\");\n\n  return Alert;\n\n});\n\ndefine('skylark-bootstrap3/button',[\n  \"skylark-langx/langx\",\n  \"skylark-domx-browser\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-noder\",\n  \"skylark-domx-geom\",\n  \"skylark-domx-query\",\n  \"skylark-domx-plugins\",\n  \"./bs3\"\n],function(langx,browser,eventer,noder,geom,$,plugins,bs3){\n\n/* ========================================================================\n * Bootstrap: button.js v3.3.7\n * http://getbootstrap.com/javascript/#buttons\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n  'use strict';\n\n  // BUTTON PUBLIC CLASS DEFINITION\n  // ==============================\n\n  var Button = bs3.Button = plugins.Plugin.inherit({\n    klassName: \"Button\",\n\n    pluginName : \"bs3.button\",\n\n    _construct : function(element,options) {\n      var $el = this.$element  = $(element)\n      this.options   = langx.mixin({}, Button.DEFAULTS, options)\n      this.isLoading = false\n\n      if ($el.closest('[data-toggle^=\"button\"]')) {\n        $el.on(\"click.bs.button.data-api\",langx.proxy(function(e){\n          this.toggle()\n\n          if (!($(e.target).is('input[type=\"radio\"], input[type=\"checkbox\"]'))) {\n            // Prevent double click on radios, and the double selections (so cancellation) on checkboxes\n            e.preventDefault()\n            // The target component still receive the focus\n            var $btn = this.$element; \n            if ($btn.is('input,button')) {\n              $btn.trigger('focus');\n            } else {\n              $btn.find('input:visible,button:visible').first().trigger('focus');\n            }\n          }\n        },this));\n      }\n    },\n\n    setState : function (state) {\n      var d    = 'disabled'\n      var $el  = this.$element\n      var val  = $el.is('input') ? 'val' : 'html'\n      var data = $el.data()\n\n      state += 'Text'\n\n      if (data.resetText == null) $el.data('resetText', $el[val]())\n\n      // push to event loop to allow forms to submit\n      setTimeout(langx.proxy(function () {\n        $el[val](data[state] == null ? this.options[state] : data[state])\n\n        if (state == 'loadingText') {\n          this.isLoading = true\n          $el.addClass(d).attr(d, d).prop(d, true)\n        } else if (this.isLoading) {\n          this.isLoading = false\n          $el.removeClass(d).removeAttr(d).prop(d, false)\n        }\n      }, this), 0)\n    },\n\n    toggle : function () {\n      var changed = true\n      var $parent = this.$element.closest('[data-toggle=\"buttons\"]')\n\n      if ($parent.length) {\n        var $input = this.$element.find('input')\n        if ($input.prop('type') == 'radio') {\n          if ($input.prop('checked')) changed = false\n          $parent.find('.active').removeClass('active')\n          this.$element.addClass('active')\n        } else if ($input.prop('type') == 'checkbox') {\n          if (($input.prop('checked')) !== this.$element.hasClass('active')) changed = false\n          this.$element.toggleClass('active')\n        }\n        $input.prop('checked', this.$element.hasClass('active'))\n        if (changed) $input.trigger('change')\n      } else {\n        this.$element.attr('aria-pressed', !this.$element.hasClass('active'))\n        this.$element.toggleClass('active')\n      }\n    }\n\n  });  \n\n  Button.VERSION  = '3.3.7'\n\n  Button.DEFAULTS = {\n    loadingText: 'loading...'\n  }\n\n\n\n  // BUTTON PLUGIN DEFINITION\n  // ========================\n  /*\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this   = $(this)\n      var wgt    = $this.data('bs.button')\n      var options = typeof option == 'object' && option\n\n      if (!wgt) {\n        $this.data('bs.button', (wgt = new Button(this, options)));\n      }\n\n      if (option == 'toggle') {\n        wgt.toggle();\n      } else if (option) {\n        wgt.setState(option);\n      }\n    });\n  }\n\n  var old = $.fn.button;\n\n  $.fn.button             = Plugin;\n  $.fn.button.Constructor = Button;\n\n\n  // BUTTON NO CONFLICT\n  // ==================\n\n  $.fn.button.noConflict = function () {\n    $.fn.button = old;\n    return this;\n  }\n\n\n  return $.fn.button;\n  */\n\n  plugins.register(Button,\"button\",function(options){\n      //this -> plugin instance\n      if (options == 'toggle') {\n        this.toggle();\n      } else if (options) {\n        this.setState(options);\n      }    \n  });\n\n  return Button;\n});\n\ndefine('skylark-bootstrap3/transition',[\n  \"skylark-langx/langx\",\n  \"skylark-domx-browser\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-noder\",\n  \"skylark-domx-geom\",\n  \"skylark-domx-query\",\n  \"./bs3\"\n],function(langx,browser,eventer,noder,geom,$,bs3){\n\n/* ========================================================================\n * Bootstrap: transition.js v3.3.7\n * http://getbootstrap.com/javascript/#transitions\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n  'use strict';\n\n  eventer.special.bsTransitionEnd = eventer.special.transitionEnd;\n});\n\ndefine('skylark-bootstrap3/carousel',[\n    \"skylark-langx/langx\",\n    \"skylark-domx-browser\",\n    \"skylark-domx-eventer\",\n    \"skylark-domx-noder\",\n    \"skylark-domx-geom\",\n    \"skylark-domx-query\",\n    \"skylark-domx-plugins\",\n    \"./bs3\",\n    \"./transition\"\n], function(langx, browser, eventer, noder, geom, $, plugins, bs3) {\n\n    /* ========================================================================\n     * Bootstrap: carousel.js v3.3.7\n     * http://getbootstrap.com/javascript/#carousel\n     * ========================================================================\n     * Copyright 2011-2016 Twitter, Inc.\n     * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n     * ======================================================================== */\n\n    'use strict';\n\n    // CAROUSEL CLASS DEFINITION\n    // =========================\n\n    var Carousel = bs3.Carousel = plugins.Plugin.inherit({\n        klassName: \"Carousel\",\n\n        pluginName: \"bs3.carousel\",\n\n        options : {\n            interval: 5000,\n            pause: 'hover',\n            wrap: true,\n            keyboard: true,\n\n            selectors :{\n                controls : {\n                 // The class for the \"toggle\" control:\n                  toggle: '.toggle',\n                  // The class for the \"prev\" control:\n                  prev: '.prev',\n                  // The class for the \"next\" control:\n                  next: '.next',\n                  // The class for the \"close\" control:\n                  close: '.close',\n                  // The class for the \"play-pause\" toggle control:\n                  playPause: '.play-pause'\n                },\n                indicators : {\n                    container : \".carousel-indicators\"  \n                },\n                slides : {\n                    container : \"\",\n                    item : \".item\" \n                }\n            }\n\n\n        },\n\n        _construct: function(element, options) {\n            options = langx.mixin({}, $(element).data(), options);\n            //this.options = options\n            this.overrided(element,options);\n\n            this.$element = $(element)\n            this.$indicators = this.$element.find(this.options.selectors.indicators.container); //'.carousel-indicators'\n            this.paused = null\n            this.sliding = null\n            this.interval = null\n            this.$active = null\n            this.$items = null\n\n            var self = this;\n            if (!this.options.embeded) {\n                this.options.keyboard && this.$element.on('keydown.bs.carousel', langx.proxy(this.keydown, this))\n\n                this.options.pause == 'hover' && !('ontouchstart' in document.documentElement) && this.$element\n                    .on('mouseenter.bs3.carousel', langx.proxy(this.pause, this))\n                    .on('mouseleave.bs3.carousel', langx.proxy(this.cycle, this));\n\n                this.$element.on(\"click.bs3.carousel.data-api\", \"[data-slide],[data-slide-to]\", function(e) {\n                    var $this = $(this),\n                        slide = $this.attr('data-slide'),\n                        slideIndex = $this.attr('data-slide-to');\n\n                    if (slide == \"prev\") {\n                        self.prev();\n                    } else if (slide == \"next\") {\n                        self.next();\n                    } else  if (slideIndex) {\n                        self.to(slideIndex);\n                    }\n                    e.preventDefault();\n                });\n            }\n        },\n\n        keydown : function(e) {\n            if (/input|textarea/i.test(e.target.tagName)) return\n            switch (e.which) {\n                case 37:\n                    this.prev();\n                    break\n                case 39:\n                    this.next();\n                    break\n                default:\n                    return\n            }\n\n            e.preventDefault()\n        },\n\n        cycle : function(e) {\n            e || (this.paused = false)\n\n            this.interval && clearInterval(this.interval)\n\n            this.options.interval &&\n                !this.paused &&\n                (this.interval = setInterval(langx.proxy(this.next, this), this.options.interval))\n\n            return this\n        },\n\n        getItemIndex : function(item) {\n            this.$items = item.parent().children(this.options.selectors.slides.item);//'.item' \n            return this.$items.index(item || this.$active)\n        },\n\n        getItemForDirection : function(direction, active) {\n            var activeIndex = this.getItemIndex(active)\n            var willWrap = (direction == 'prev' && activeIndex === 0) ||\n                (direction == 'next' && activeIndex == (this.$items.length - 1))\n            if (willWrap && !this.options.wrap) return active\n            var delta = direction == 'prev' ? -1 : 1\n            var itemIndex = (activeIndex + delta) % this.$items.length\n            return this.$items.eq(itemIndex)\n        },\n\n        to : function(pos) {\n            var that = this\n            var activeIndex = this.getItemIndex(this.$active = this.$element.find(this.options.selectors.slides.item+\".active\"));//'.item.active'\n\n            if (pos > (this.$items.length - 1) || pos < 0) return\n\n            if (this.sliding) return this.$element.one('slid.bs.carousel', function() { that.to(pos) }) // yes, \"slid\"\n            if (activeIndex == pos) return this.pause().cycle()\n\n            return this.slide(pos > activeIndex ? 'next' : 'prev', this.$items.eq(pos))\n        },\n\n        pause : function(e) {\n            e || (this.paused = true)\n\n            if (this.$element.find(this.options.selectors.controls.next + \",\"+ this.options.selectors.controls.prev).length && browser.support.transition) { //.next,.prev\n                this.$element.trigger(browser.support.transition.end)\n                this.cycle(true)\n            }\n\n            this.interval = clearInterval(this.interval)\n\n            return this\n        },\n\n        next : function() {\n            if (this.sliding) return\n            return this.slide('next')\n        },\n\n        prev : function() {\n            if (this.sliding) return\n            return this.slide('prev')\n        },\n\n        slide : function(type, next) {\n            var $active = this.$element.find(this.options.selectors.slides.item+\".active\");//'.item.active'\n            var $next = next || this.getItemForDirection(type, $active)\n            var isCycling = this.interval\n            var direction = type == 'next' ? 'left' : 'right'\n            var that = this\n\n            if ($next.hasClass('active')) return (this.sliding = false)\n\n            var relatedTarget = $next[0]\n            var slideEvent = eventer.create('slide.bs.carousel', {\n                relatedTarget: relatedTarget,\n                direction: direction\n            })\n            this.$element.trigger(slideEvent)\n            if (slideEvent.isDefaultPrevented()) return\n\n            this.sliding = true\n\n            isCycling && this.pause()\n\n            if (this.$indicators.length) {\n                this.$indicators.find('.active').removeClass('active')\n                var $nextIndicator = $(this.$indicators.children()[this.getItemIndex($next)])\n                $nextIndicator && $nextIndicator.addClass('active')\n            }\n\n            var slidEvent = eventer.create('slid.bs.carousel', { relatedTarget: relatedTarget, direction: direction }) // yes, \"slid\"\n            if (browser.support.transition && this.$element.hasClass('slide')) {\n                $next.addClass(type)\n                $next[0].offsetWidth // force reflow\n                $active.addClass(direction)\n                $next.addClass(direction)\n                $active\n                    .one('transitionEnd', function() {\n                        $next.removeClass([type, direction].join(' ')).addClass('active')\n                        $active.removeClass(['active', direction].join(' '))\n                        that.sliding = false\n                        setTimeout(function() {\n                            that.$element.trigger(slidEvent)\n                        }, 0)\n                    })\n                    .emulateTransitionEnd()\n            } else {\n                $active.removeClass('active')\n                $next.addClass('active')\n                this.sliding = false\n                this.$element.trigger(slidEvent)\n            }\n\n            isCycling && this.cycle()\n\n            return this\n        },\n\n    });\n\n    // var Carousel = function (element, options) {\n    // }\n\n    Carousel.VERSION = '3.3.7'\n\n    Carousel.TRANSITION_DURATION = 600\n\n\n\n\n    // CAROUSEL PLUGIN DEFINITION\n    // ==========================\n    /*\n    function Plugin(option) {\n        return this.each(function() {\n            var $this = $(this)\n            var wgt = $this.data('bs.carousel')\n            var options = langx.mixin({}, Carousel.DEFAULTS, $this.data(), typeof option == 'object' && option)\n            var action = typeof option == 'string' ? option : options.slide\n\n            if (!wgt) {\n                $this.data('bs.carousel', (wgt = new Carousel(this, options)));\n            }\n            if (typeof option == 'number') {\n                wgt.to(option);\n            } else if (action) {\n                wgt[action]()\n            } else if (options.interval) {\n                wgt.pause().cycle();\n            }\n        })\n    }\n    */\n    plugins.register(Carousel,\"carousel\",function(options){\n        //this -> plugin instance\n        var action = typeof options == 'string' ? options : options.slide\n        if (typeof options == 'number') {\n            this.to(options);\n        } else if (action) {\n            this[action]()\n        } else if (options.interval) {\n            this.pause().cycle();\n        }        \n    });\n\n    return Carousel;\n\n});\ndefine('skylark-domx-panels/panels',[\r\n  \"skylark-langx/skylark\",\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-browser\",\r\n  \"skylark-domx-eventer\",\r\n  \"skylark-domx-noder\",\r\n  \"skylark-domx-geom\",\r\n  \"skylark-domx-query\"\r\n],function(skylark,langx,browser,eventer,noder,geom,$){\r\n\tvar panels = {};\r\n\r\n\tvar CONST = {\r\n\t\tBACKSPACE_KEYCODE: 8,\r\n\t\tCOMMA_KEYCODE: 188, // `,` & `<`\r\n\t\tDELETE_KEYCODE: 46,\r\n\t\tDOWN_ARROW_KEYCODE: 40,\r\n\t\tENTER_KEYCODE: 13,\r\n\t\tTAB_KEYCODE: 9,\r\n\t\tUP_ARROW_KEYCODE: 38\r\n\t};\r\n\r\n\tvar isShiftHeld = function isShiftHeld (e) { return e.shiftKey === true; };\r\n\r\n\tvar isKey = function isKey (keyCode) {\r\n\t\treturn function compareKeycodes (e) {\r\n\t\t\treturn e.keyCode === keyCode;\r\n\t\t};\r\n\t};\r\n\r\n\tvar isBackspaceKey = isKey(CONST.BACKSPACE_KEYCODE);\r\n\tvar isDeleteKey = isKey(CONST.DELETE_KEYCODE);\r\n\tvar isTabKey = isKey(CONST.TAB_KEYCODE);\r\n\tvar isUpArrow = isKey(CONST.UP_ARROW_KEYCODE);\r\n\tvar isDownArrow = isKey(CONST.DOWN_ARROW_KEYCODE);\r\n\r\n\tvar ENCODED_REGEX = /&[^\\s]*;/;\r\n\t/*\r\n\t * to prevent double encoding decodes content in loop until content is encoding free\r\n\t */\r\n\tvar cleanInput = function cleanInput (questionableMarkup) {\r\n\t\t// check for encoding and decode\r\n\t\twhile (ENCODED_REGEX.test(questionableMarkup)) {\r\n\t\t\tquestionableMarkup = $('<i>').html(questionableMarkup).text();\r\n\t\t}\r\n\r\n\t\t// string completely decoded now encode it\r\n\t\treturn $('<i>').text(questionableMarkup).html();\r\n\t};\r\n\r\n\tlangx.mixin(panels, {\r\n\t\tCONST: CONST,\r\n\t\tcleanInput: cleanInput,\r\n\t\tisBackspaceKey: isBackspaceKey,\r\n\t\tisDeleteKey: isDeleteKey,\r\n\t\tisShiftHeld: isShiftHeld,\r\n\t\tisTabKey: isTabKey,\r\n\t\tisUpArrow: isUpArrow,\r\n\t\tisDownArrow: isDownArrow\r\n\t});\r\n\r\n\treturn skylark.attach(\"domx.panels\",panels);\r\n\r\n});\r\n\ndefine('skylark-domx-panels/Collapse',[\r\n    \"skylark-langx/langx\",\r\n    \"skylark-domx-browser\",\r\n    \"skylark-domx-eventer\",\r\n    \"skylark-domx-query\",\r\n    \"skylark-domx-plugins\",\r\n    \"./panels\"\r\n], function(langx, browser, eventer,  $, plugins, panels) {\r\n\r\n\r\n  'use strict';\r\n\r\n  // COLLAPSE PUBLIC CLASS DEFINITION\r\n  // ================================\r\n\r\n  var Collapse =  plugins.Plugin.inherit({\r\n    klassName: \"Collapse\",\r\n\r\n    pluginName : \"domx.collapse\",\r\n\r\n    options : {\r\n      toggle: true\r\n    },\r\n\r\n    _construct : function(elm,options) {\r\n      ////options = langx.mixin({}, Collapse.DEFAULTS, $(element).data(), options)\r\n      this.overrided(elm,options);\r\n      this.$element      = this.$();\r\n      //this.$trigger      = $('[data-toggle=\"collapse\"][href=\"#' + elm.id + '\"],' +\r\n      //                     '[data-toggle=\"collapse\"][data-target=\"#' + elm.id + '\"]')\r\n      this.transitioning = null\r\n\r\n      //if (this.options.parent) {\r\n      //  this.$parent = this.getParent()\r\n      //} else {\r\n      //  this.addAriaAndCollapsedClass(this.$element, this.$trigger)\r\n      //}\r\n\r\n      if (this.options.toggle) {\r\n        this.toggle();\r\n      }\r\n    },\r\n\r\n    dimension : function () {\r\n      var hasWidth = this.$element.hasClass('width');\r\n      return hasWidth ? 'width' : 'height';\r\n    },\r\n\r\n    show : function () {\r\n      if (this.transitioning || this.$element.hasClass('in')) {\r\n        return;\r\n      }\r\n\r\n      //var activesData;\r\n      //var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')\r\n\r\n      //if (actives && actives.length) {\r\n      //  activesData = actives.data('collapse')\r\n      //  if (activesData && activesData.transitioning) return\r\n      //}\r\n\r\n      var startEvent = eventer.create('show.collapse');\r\n      this.$element.trigger(startEvent)\r\n      if (startEvent.isDefaultPrevented()) return\r\n\r\n      //if (actives && actives.length) {\r\n      //  //Plugin.call(actives, 'hide')\r\n      //  actives.plugin(\"domx.collapse\").hide();\r\n      //  activesData || actives.data('collapse', null)\r\n      //}\r\n\r\n      var dimension = this.dimension();\r\n\r\n      this.$element\r\n        .removeClass('collapse')\r\n        .addClass('collapsing')[dimension](0)\r\n        .attr('aria-expanded', true)\r\n\r\n      //this.$trigger\r\n      //  .removeClass('collapsed')\r\n      //  .attr('aria-expanded', true)\r\n\r\n      this.transitioning = 1\r\n\r\n      var complete = function () {\r\n        this.$element\r\n          .removeClass('collapsing')\r\n          .addClass('collapse in')[dimension]('')\r\n        this.transitioning = 0\r\n        this.$element\r\n          .trigger('shown.collapse')\r\n      }\r\n\r\n      if (!browser.support.transition) {\r\n        return complete.call(this);\r\n      }\r\n\r\n      var scrollSize = langx.camelCase(['scroll', dimension].join('-'));\r\n\r\n      this.$element\r\n        .one('transitionEnd', langx.proxy(complete, this))\r\n        .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize]);\r\n    },\r\n\r\n    hide : function () {\r\n      if (this.transitioning || !this.$element.hasClass('in')) {\r\n        return ;\r\n      }\r\n\r\n      var startEvent = eventer.create('hide.collapse');\r\n      this.$element.trigger(startEvent);\r\n      if (startEvent.isDefaultPrevented()) {\r\n        return ;\r\n      } \r\n\r\n      var dimension = this.dimension();\r\n\r\n      this.$element[dimension](this.$element[dimension]())[0].offsetHeight;\r\n\r\n      this.$element\r\n        .addClass('collapsing')\r\n        .removeClass('collapse in')\r\n        .attr('aria-expanded', false);\r\n\r\n      //this.$trigger\r\n      //  .addClass('collapsed')\r\n      //  .attr('aria-expanded', false);\r\n\r\n      this.transitioning = 1;\r\n\r\n      var complete = function () {\r\n        this.transitioning = 0;\r\n        this.$element\r\n          .removeClass('collapsing')\r\n          .addClass('collapse')\r\n          .trigger('hidden.collapse');\r\n      }\r\n\r\n      if (!browser.support.transition) {\r\n        return complete.call(this);\r\n      }\r\n\r\n      this.$element\r\n        [dimension](0)\r\n        .one('transitionEnd', langx.proxy(complete, this))\r\n        .emulateTransitionEnd(Collapse.TRANSITION_DURATION)\r\n    },\r\n\r\n    toggle : function () {\r\n      this[this.$element.hasClass('in') ? 'hide' : 'show']();\r\n    }\r\n\r\n    /*\r\n    getParent : function () {\r\n      return $(this.options.parent)\r\n        .find('[data-toggle=\"collapse\"][data-parent=\"' + this.options.parent + '\"]')\r\n        .each(langx.proxy(function (i, element) {\r\n          var $element = $(element)\r\n          this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)\r\n        }, this))\r\n        .end()\r\n    },\r\n\r\n    addAriaAndCollapsedClass : function ($element, $trigger) {\r\n      var isOpen = $element.hasClass('in');\r\n\r\n      $element.attr('aria-expanded', isOpen);\r\n      $trigger\r\n        .toggleClass('collapsed', !isOpen)\r\n        .attr('aria-expanded', isOpen);\r\n    }\r\n    */\r\n  });\r\n\r\n  Collapse.TRANSITION_DURATION = 350;\r\n\r\n  /*\r\n  function getTargetFromTrigger($trigger) {\r\n    var href\r\n    var target = $trigger.attr('data-target')\r\n      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\\s]+$)/, '') // strip for ie7\r\n\r\n    return $(target)\r\n  }\r\n  */\r\n\r\n  plugins.register(Collapse);\r\n\r\n  return Collapse;\r\n\r\n});\r\n\ndefine('skylark-bootstrap3/collapse',[\n    \"skylark-langx/langx\",\n    \"skylark-domx-browser\",\n    \"skylark-domx-eventer\",\n    \"skylark-domx-noder\",\n    \"skylark-domx-geom\",\n    \"skylark-domx-query\",\n    \"skylark-domx-plugins\",\n    \"skylark-domx-panels/Collapse\",\n   \"./bs3\",\n    \"./transition\"\n], function(langx, browser, eventer, noder, geom, $, plugins,_Collapse, bs3) {\n\n\n/* ========================================================================\n * Bootstrap: collapse.js v3.3.7\n * http://getbootstrap.com/javascript/#collapse\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n/* jshint latedef: false */\n\n  'use strict';\n\n  // COLLAPSE PUBLIC CLASS DEFINITION\n  // ================================\n\n  var Collapse = bs3.Collapse = _Collapse.inherit({\n    klassName: \"Collapse\",\n\n    pluginName : \"bs3.collapse\",\n\n    _construct : function(element,options) {\n      options = langx.mixin({}, $(element).data(), options)\n      this.$trigger      = $('[data-toggle=\"collapse\"][href=\"#' + element.id + '\"],' +\n                             '[data-toggle=\"collapse\"][data-target=\"#' + element.id + '\"]')\n      //this.transitioning = null\n\n      if (options.parent) {\n        this.$parent = this.getParent(options)\n      } else {\n        this.addAriaAndCollapsedClass($(element), this.$trigger)\n      }\n\n      this.overrided(element,options);\n      //this.$element      = $(element)\n\n      //if (this.options.toggle) {\n      //  this.toggle();\n      //}\n    },\n\n\n    show : function () {\n      //if (this.transitioning || this.$element.hasClass('in')) return\n\n      var activesData\n      var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')\n\n      if (actives && actives.length) {\n        activesData = actives.data('bs.collapse')\n        if (activesData && activesData.transitioning) return\n      }\n\n      //var startEvent = eventer.create('show.bs.collapse')\n      //this.$element.trigger(startEvent)\n      //if (startEvent.isDefaultPrevented()) return\n\n      if (actives && actives.length) {\n        //Plugin.call(actives, 'hide')\n        actives.collapse(\"hide\");\n        activesData || actives.data('bs.collapse', null)\n      }\n\n      //var dimension = this.dimension()\n\n      //this.$element\n      //  .removeClass('collapse')\n      //  .addClass('collapsing')[dimension](0)\n      //  .attr('aria-expanded', true)\n\n      this.overrided(); //add\n\n      this.$trigger\n        .removeClass('collapsed')\n        .attr('aria-expanded', true)\n\n      //this.transitioning = 1\n\n      //var complete = function () {\n      //  this.$element\n      //    .removeClass('collapsing')\n      //    .addClass('collapse in')[dimension]('')\n      //  this.transitioning = 0\n      //  this.$element\n      //    .trigger('shown.bs.collapse')\n      //}\n\n      //if (!browser.support.transition) return complete.call(this)\n\n      //var scrollSize = langx.camelCase(['scroll', dimension].join('-'))\n\n      //this.$element\n      //  .one('transitionEnd', langx.proxy(complete, this))\n      //  .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])\n    },\n\n    hide : function () {\n      //if (this.transitioning || !this.$element.hasClass('in')) return\n\n      //var startEvent = eventer.create('hide.bs.collapse')\n      //this.$element.trigger(startEvent)\n      //if (startEvent.isDefaultPrevented()) return\n\n      //var dimension = this.dimension()\n\n      //this.$element[dimension](this.$element[dimension]())[0].offsetHeight\n\n      //this.$element\n      //  .addClass('collapsing')\n      //  .removeClass('collapse in')\n      //  .attr('aria-expanded', false)\n\n      this.overrided();\n      this.$trigger\n        .addClass('collapsed')\n        .attr('aria-expanded', false)\n\n      //this.transitioning = 1\n\n      //var complete = function () {\n      //  this.transitioning = 0\n      //  this.$element\n      //    .removeClass('collapsing')\n      //    .addClass('collapse')\n      //    .trigger('hidden.bs.collapse')\n      //}\n\n      //if (!browser.support.transition) return complete.call(this)\n\n      //this.$element\n      //  [dimension](0)\n      //  .one('transitionEnd', langx.proxy(complete, this))\n      //  .emulateTransitionEnd(Collapse.TRANSITION_DURATION)\n    },\n\n\n    getParent : function (options) {\n      options = options || this.options;\n      return $(options.parent)\n        .find('[data-toggle=\"collapse\"][data-parent=\"' + options.parent + '\"]')\n        .each(langx.proxy(function (i, element) {\n          var $element = $(element)\n          this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)\n        }, this))\n        .end()\n    },\n\n    addAriaAndCollapsedClass : function ($element, $trigger) {\n      var isOpen = $element.hasClass('in')\n\n      $element.attr('aria-expanded', isOpen)\n      $trigger\n        .toggleClass('collapsed', !isOpen)\n        .attr('aria-expanded', isOpen)\n    }\n\n  });\n\n  Collapse.VERSION  = '3.3.7'\n\n\n  function getTargetFromTrigger($trigger) {\n    var href\n    var target = $trigger.attr('data-target')\n      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\\s]+$)/, '') // strip for ie7\n\n    return $(target)\n  }\n\n\n  // COLLAPSE PLUGIN DEFINITION\n  // ==========================\n\n  /*\n  function Plugin(option) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.collapse')\n      var options = langx.mixin({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)\n\n      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false\n      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))\n      if (typeof option == 'string') data[option]()\n    })\n  }\n\n  var old = $.fn.collapse\n\n  $.fn.collapse             = Plugin;\n  $.fn.collapse.Constructor = Collapse;\n\n  // COLLAPSE NO CONFLICT\n  // ====================\n\n  $.fn.collapse.noConflict = function () {\n    $.fn.collapse = old\n    return this\n  }\n  */\n\n  plugins.register(Collapse,\"collapse\");\n\n  return Collapse;\n\n});\n\ndefine('skylark-domx-popups/popups',[\r\n\t\"skylark-langx-ns\"\r\n],function(skylark){\r\n\r\n\tvar stack = [];\r\n\r\n\r\n\r\n    /**\r\n    * get the offset below/above and left/right element depending on screen position\r\n    * Thanks https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.datepicker.js\r\n    */\r\n    function around(ref) {\r\n        var extraY = 0;\r\n        var dpSize = geom.size(popup);\r\n        var dpWidth = dpSize.width;\r\n        var dpHeight = dpSize.height;\r\n        var refHeight = geom.height(ref);\r\n        var doc = ref.ownerDocument;\r\n        var docElem = doc.documentElement;\r\n        var viewWidth = docElem.clientWidth + geom.scrollLeft(doc);\r\n        var viewHeight = docElem.clientHeight + geom.scrollTop(doc);\r\n        var offset = geom.pagePosition(ref);\r\n        var offsetLeft = offset.left;\r\n        var offsetTop = offset.top;\r\n\r\n        offsetTop += refHeight;\r\n\r\n        offsetLeft -=\r\n            Math.min(offsetLeft, (offsetLeft + dpWidth > viewWidth && viewWidth > dpWidth) ?\r\n            Math.abs(offsetLeft + dpWidth - viewWidth) : 0);\r\n\r\n        offsetTop -=\r\n            Math.min(offsetTop, ((offsetTop + dpHeight > viewHeight && viewHeight > dpHeight) ?\r\n            Math.abs(dpHeight + refHeight - extraY) : extraY));\r\n\r\n        return {\r\n            top: offsetTop,\r\n            bottom: offset.bottom,\r\n            left: offsetLeft,\r\n            right: offset.right,\r\n            width: offset.width,\r\n            height: offset.height\r\n        };\r\n    }\r\n\r\n\r\n\t/*\r\n\t * Popup the ui elment at the specified position\r\n\t * @param popup  element to display\r\n\t * @param options\r\n\t *  - around {HtmlEleent}\r\n\t *  - at {x,y}\r\n\t *  - parent {}\r\n\t */\r\n\r\n\tfunction open(popup,options) {\r\n\t\tif (options.around) {\r\n\t\t\t//A DOM node that should be used as a reference point for placing the pop-up. \r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/*\r\n\t * Close specified popup and any popups that it parented.\r\n\t * If no popup is specified, closes all popups.\r\n     */\r\n\tfunction close(popup) {\r\n\t\tvar count = 0;\r\n\r\n\t\tif (popup) {\r\n\t\t\tfor (var i= stack.length-1; i>=0; i--) {\r\n\t\t\t\tif (stack[i].popup == popup) {\r\n\t\t\t\t\tcount = stack.length - i; \r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcount = stack.length;\r\n\t\t}\r\n\t\tfor (var i=0; i<count ; i++ ) {\r\n\t\t\tvar top = stack.pop(),\r\n\t\t\t\tpopup1 = top.popup;\r\n\t\t\tif (popup1.hide) {\r\n\t\t\t\tpopup1.hide();\r\n\t\t\t} else {\r\n\r\n\t\t\t}\r\n\r\n\t\t} \r\n\t}\r\n\treturn skylark.attach(\"domx.popups\",{\r\n\t\taround,\r\n\t\topen,\r\n\t\tclose\r\n\t});\r\n});\ndefine('skylark-domx-popups/Dropdown',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-browser\",\r\n  \"skylark-domx-eventer\",\r\n  \"skylark-domx-noder\",\r\n  \"skylark-domx-geom\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-domx-plugins\",\r\n  \"./popups\"\r\n],function(langx,browser,eventer,noder,geom,$,plugins,popups){\r\n\r\n  'use strict';\r\n\r\n  // DROPDOWN CLASS DEFINITION\r\n  // =========================\r\n\r\n  var backdrop = '.dropdown-backdrop';\r\n  var toggle   = '[data-toggle=\"dropdown\"]';\r\n\r\n  var Dropdown = plugins.Plugin.inherit({\r\n    klassName: \"Dropdown\",\r\n\r\n    pluginName : \"domx.dropdown\",\r\n\r\n    options : {\r\n      \"selectors\" : {\r\n        \"toggler\" : '[data-toggle=\"dropdown\"],.dropdown-menu'\r\n      }\r\n\r\n    },\r\n\r\n    _construct : function(elm,options) {\r\n      this.overrided(elm,options);\r\n\r\n      var $el = this.$element = $(this._elm);\r\n      $el.on('click.dropdown', this.toggle);\r\n      $el.on('keydown.dropdown', this.options.selectors.toggler,this.keydown);\r\n    },\r\n\r\n    toggle : function (e) {\r\n      var $this = $(this)\r\n\r\n      if ($this.is('.disabled, :disabled')) {\r\n        return;\r\n      }\r\n\r\n      var $parent  = getParent($this)\r\n      var isActive = $parent.hasClass('open');\r\n\r\n      clearMenus()\r\n\r\n      if (!isActive) {\r\n        if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {\r\n          // if mobile we use a backdrop because click events don't delegate\r\n          $(document.createElement('div'))\r\n            .addClass('dropdown-backdrop')\r\n            .insertAfter($(this))\r\n            .on('click', clearMenus)\r\n        }\r\n\r\n        var relatedTarget = { relatedTarget: this }\r\n        $parent.trigger(e = eventer.create('show.dropdown', relatedTarget))\r\n\r\n        if (e.isDefaultPrevented()) {\r\n          return;\r\n        }\r\n\r\n        $this\r\n          .trigger('focus')\r\n          .attr('aria-expanded', 'true')\r\n\r\n        $parent\r\n          .toggleClass('open')\r\n          .trigger(eventer.create('shown.dropdown', relatedTarget))\r\n      }\r\n\r\n      return false\r\n    },\r\n\r\n    keydown : function (e) {\r\n      if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) {\r\n        return;\r\n      }\r\n\r\n      var $this = $(this);\r\n\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n\r\n      if ($this.is('.disabled, :disabled')) {\r\n        return;\r\n      }\r\n\r\n      var $parent  = getParent($this)\r\n      var isActive = $parent.hasClass('open')\r\n\r\n      if (!isActive && e.which != 27 || isActive && e.which == 27) {\r\n        if (e.which == 27) $parent.find(toggle).trigger('focus')\r\n        return $this.trigger('click')\r\n      }\r\n\r\n      var desc = ' li:not(.disabled):visible a'\r\n      var $items = $parent.find('.dropdown-menu' + desc)\r\n\r\n      if (!$items.length) return\r\n\r\n      var index = $items.index(e.target)\r\n\r\n      if (e.which == 38 && index > 0)                 index--         // up\r\n      if (e.which == 40 && index < $items.length - 1) index++         // down\r\n      if (!~index)                                    index = 0\r\n\r\n      $items.eq(index).trigger('focus');\r\n    }\r\n\r\n  });\r\n\r\n  function getParent($this) {\r\n    var selector = $this.attr('data-target')\r\n\r\n    if (!selector) {\r\n      selector = $this.attr('href')\r\n      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\\s]*$)/, '') // strip for ie7\r\n    }\r\n\r\n    var $parent = selector && $(selector);\r\n\r\n    return $parent && $parent.length ? $parent : $this.parent();\r\n  }\r\n\r\n  function clearMenus(e) {\r\n    if (e && e.which === 3) return\r\n    $(backdrop).remove()\r\n    $(toggle).each(function () {\r\n      var $this         = $(this)\r\n      var $parent       = getParent($this)\r\n      var relatedTarget = { relatedTarget: this }\r\n\r\n      if (!$parent.hasClass('open')) return\r\n\r\n      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && noder.contains($parent[0], e.target)) return\r\n\r\n      $parent.trigger(e = eventer.create('hide.dropdown', relatedTarget))\r\n\r\n      if (e.isDefaultPrevented()) return\r\n\r\n      $this.attr('aria-expanded', 'false')\r\n      $parent.removeClass('open').trigger(eventer.create('hidden.dropdown', relatedTarget))\r\n    })\r\n  }\r\n\r\n\r\n\r\n  // APPLY TO STANDARD DROPDOWN ELEMENTS\r\n  // ===================================\r\n  $(document)\r\n    .on('click.dropdown.data-api', clearMenus)\r\n    .on('click.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() });\r\n\r\n  plugins.register(Dropdown);\r\n\r\n  return popups.Dropdown = Dropdown;\r\n\r\n});\r\n\ndefine('skylark-bootstrap3/dropdown',[\n  \"skylark-langx/langx\",\n  \"skylark-domx-browser\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-noder\",\n  \"skylark-domx-geom\",\n  \"skylark-domx-query\",\n  \"skylark-domx-plugins\",\n  \"skylark-domx-popups/Dropdown\",\n  \"./bs3\"\n],function(langx,browser,eventer,noder,geom,$,plugins,_Dropdown,bs3){\n\n/* ========================================================================\n * Bootstrap: dropdown.js v3.3.7\n * http://getbootstrap.com/javascript/#dropdowns\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n  'use strict';\n\n  // DROPDOWN CLASS DEFINITION\n  // =========================\n\n  var backdrop = '.dropdown-backdrop';\n  var toggle   = '[data-toggle=\"dropdown\"]';\n\n  var Dropdown = bs3.Dropdown = _Dropdown.inherit({\n    klassName: \"Dropdown\",\n\n    pluginName : \"bs3.dropdown\",\n\n\n  });\n\n  Dropdown.VERSION = '3.3.7'\n\n\n  /*\n  // DROPDOWN PLUGIN DEFINITION\n  // ==========================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this = $(this)\n      var data  = $this.data('bs.dropdown')\n\n      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))\n      if (typeof option == 'string') data[option].call($this)\n    })\n  }\n\n  var old = $.fn.dropdown\n\n  $.fn.dropdown             = Plugin;\n  $.fn.dropdown.Constructor = Dropdown;\n\n\n  // DROPDOWN NO CONFLICT\n  // ====================\n\n  $.fn.dropdown.noConflict = function () {\n    $.fn.dropdown = old\n    return this\n  }\n\n\n\n  return $.fn.dropdown;\n  */\n\n  // APPLY TO STANDARD DROPDOWN ELEMENTS\n  // ===================================\n  /*\n  $(document)\n    .on('click.bs.dropdown.data-api', clearMenus)\n    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() });\n  */\n  plugins.register(Dropdown,\"dropdown\");\n\n  return Dropdown;\n\n});\n\ndefine('skylark-bootstrap3/modal',[\n  \"skylark-langx/langx\",\n  \"skylark-domx-browser\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-noder\",\n  \"skylark-domx-geom\",\n  \"skylark-domx-query\",\n  \"skylark-domx-plugins\",\n  \"./bs3\"\n],function(langx,browser,eventer,noder,geom,$,plugins,bs3){\n\n/* ========================================================================\n * Bootstrap: modal.js v3.3.7\n * http://getbootstrap.com/javascript/#modals\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n  'use strict';\n\n  // MODAL CLASS DEFINITION\n  // ======================\n\n  var Modal = bs3.Modal = plugins.Plugin.inherit({\n    klassName: \"Modal\",\n\n    pluginName : \"bs3.modal\",\n\n    _construct : function(element,options) {\n      options = langx.mixin({}, Modal.DEFAULTS, $(element).data(), options)\n      this.overrided(element,options);\n      this.$container               = $(options.container || document.body)\n      this.$element            = $(element)\n      this.$dialog             = this.$element.find('.modal-dialog')\n      if (!this.$container.is(\"body\")) {\n        this.$element.css(\"position\",\"absolute\");\n      }\n      //this.$container.append(this.$element);\n      this.$backdrop           = null\n      this.isShown             = null\n      this.originalBodyPad     = null\n      this.scrollbarWidth      = 0\n      this.ignoreBackdropClick = false\n\n      if (this.options.remote) {\n        this.$element\n          .find('.modal-content')\n          .load(this.options.remote, langx.proxy(function () {\n            this.$element.trigger('loaded.bs.modal')\n          }, this))\n      }\n    },\n\n    toggle : function (_relatedTarget) {\n      return this.isShown ? this.hide() : this.show(_relatedTarget)\n    },\n\n    show : function (_relatedTarget) {\n      var that = this\n      var e    = eventer.create('show.bs.modal', { relatedTarget: _relatedTarget })\n\n      this.$element.trigger(e)\n\n      if (this.isShown || e.isDefaultPrevented()) return\n\n      this.isShown = true\n\n      this.checkScrollbar()\n      this.setScrollbar()\n      this.$container.addClass('modal-open')\n\n      this.escape()\n      this.resize()\n\n      this.$element.on('click.dismiss.bs.modal', '[data-dismiss=\"modal\"]', langx.proxy(this.hide, this))\n\n      this.$dialog.on('mousedown.dismiss.bs.modal', function () {\n        that.$element.one('mouseup.dismiss.bs.modal', function (e) {\n          if ($(e.target).is(that.$element)) that.ignoreBackdropClick = true\n        })\n      })\n\n      this.backdrop(function () {\n        var transition = browser.support.transition && that.$element.hasClass('fade')\n\n        if (!noder.isChildOf(that.$element[0],that.$container[0])) {\n          that.$element.appendTo(that.$container) // don't move modals dom position\n        }\n\n        that.$element\n          .show()\n          .scrollTop(0)\n\n        that.adjustDialog()\n\n        if (transition) {\n          that.$element[0].offsetWidth // force reflow\n        }\n\n        that.$element.addClass('in')\n\n        that.enforceFocus()\n\n        var e = eventer.create('shown.bs.modal', { relatedTarget: _relatedTarget })\n\n        transition ?\n          that.$dialog // wait for modal to slide in\n            .one('transitionEnd', function () {\n              that.$element.trigger('focus').trigger(e)\n            })\n            .emulateTransitionEnd(Modal.TRANSITION_DURATION) :\n          that.$element.trigger('focus').trigger(e)\n      })\n    },\n\n    hide : function (e) {\n      if (e) e.preventDefault()\n\n      e = eventer.create('hide.bs.modal')\n\n      this.$element.trigger(e)\n\n      if (!this.isShown || e.isDefaultPrevented()) return\n\n      this.isShown = false\n\n      this.escape()\n      this.resize()\n\n      $(document).off('focusin.bs.modal')\n\n      this.$element\n        .removeClass('in')\n        .off('click.dismiss.bs.modal')\n        .off('mouseup.dismiss.bs.modal')\n\n      this.$dialog.off('mousedown.dismiss.bs.modal')\n\n      browser.support.transition && this.$element.hasClass('fade') ?\n        this.$element\n          .one('transitionEnd', langx.proxy(this.hideModal, this))\n          .emulateTransitionEnd(Modal.TRANSITION_DURATION) :\n        this.hideModal()\n    },\n\n    enforceFocus : function () {\n      $(document)\n        .off('focusin.bs.modal') // guard against infinite focus loop\n        .on('focusin.bs.modal', langx.proxy(function (e) {\n          if (document !== e.target &&\n              this.$element[0] !== e.target &&\n              !this.$element.has(e.target).length) {\n            this.$element.trigger('focus')\n          }\n        }, this))\n    },\n\n    escape : function () {\n      if (this.isShown && this.options.keyboard) {\n        this.$element.on('keydown.dismiss.bs.modal', langx.proxy(function (e) {\n          e.which == 27 && this.hide()\n        }, this))\n      } else if (!this.isShown) {\n        this.$element.off('keydown.dismiss.bs.modal')\n      }\n    },\n\n    resize : function () {\n      if (this.isShown) {\n        $(window).on('resize.bs.modal', langx.proxy(this.handleUpdate, this))\n      } else {\n        $(window).off('resize.bs.modal')\n      }\n    },\n\n    hideModal : function () {\n      var that = this\n      this.$element.hide()\n      this.backdrop(function () {\n        that.$container.removeClass('modal-open')\n        that.resetAdjustments()\n        that.resetScrollbar()\n        that.$element.trigger('hidden.bs.modal')\n      })\n    },\n\n    removeBackdrop : function () {\n      this.$backdrop && this.$backdrop.remove()\n      this.$backdrop = null\n    },\n\n    backdrop : function (callback) {\n      var that = this\n      var animate = this.$element.hasClass('fade') ? 'fade' : ''\n\n      if (this.isShown && this.options.backdrop) {\n        var doAnimate = browser.support.transition && animate\n\n        this.$backdrop = $(document.createElement('div'))\n          .addClass('modal-backdrop ' + animate)\n          .appendTo(this.$container)\n\n        if (!this.$container.is(\"body\")) {\n          this.$backdrop.css(\"position\",\"absolute\");\n        }\n\n\n        this.$element.on('click.dismiss.bs.modal', langx.proxy(function (e) {\n          if (this.ignoreBackdropClick) {\n            this.ignoreBackdropClick = false\n            return\n          }\n          if (e.target !== e.currentTarget) return\n          this.options.backdrop == 'static'\n            ? this.$element[0].focus()\n            : this.hide()\n        }, this))\n\n        if (doAnimate) this.$backdrop[0].offsetWidth // force reflow\n\n        this.$backdrop.addClass('in')\n\n        if (!callback) return\n\n        doAnimate ?\n          this.$backdrop\n            .one('transitionEnd', callback)\n            .emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION) :\n          callback()\n\n      } else if (!this.isShown && this.$backdrop) {\n        this.$backdrop.removeClass('in')\n\n        var callbackRemove = function () {\n          that.removeBackdrop()\n          callback && callback()\n        }\n        browser.support.transition && this.$element.hasClass('fade') ?\n          this.$backdrop\n            .one('transitionEnd', callbackRemove)\n            .emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION) :\n          callbackRemove()\n\n      } else if (callback) {\n        callback()\n      }\n    },\n\n    // these following methods are used to handle overflowing modals\n\n    handleUpdate : function () {\n      this.adjustDialog()\n    },\n\n    adjustDialog : function () {\n      var modalIsOverflowing = this.$element[0].scrollHeight > document.documentElement.clientHeight\n\n      this.$element.css({\n        paddingLeft:  !this.bodyIsOverflowing && modalIsOverflowing ? this.scrollbarWidth : '',\n        paddingRight: this.bodyIsOverflowing && !modalIsOverflowing ? this.scrollbarWidth : ''\n      })\n    },\n\n    resetAdjustments : function () {\n      this.$element.css({\n        paddingLeft: '',\n        paddingRight: ''\n      })\n    },\n\n    checkScrollbar : function () {\n      var fullWindowWidth = window.innerWidth\n      if (!fullWindowWidth) { // workaround for missing window.innerWidth in IE8\n        var documentElementRect = document.documentElement.getBoundingClientRect()\n        fullWindowWidth = documentElementRect.right - Math.abs(documentElementRect.left)\n      }\n      this.bodyIsOverflowing = document.body.clientWidth < fullWindowWidth\n      this.scrollbarWidth = this.measureScrollbar()\n    },\n\n    setScrollbar : function () {\n      var bodyPad = parseInt((this.$container.css('padding-right') || 0), 10)\n      this.originalBodyPad = document.body.style.paddingRight || ''\n      if (this.bodyIsOverflowing) this.$container.css('padding-right', bodyPad + this.scrollbarWidth)\n    },\n\n    resetScrollbar : function () {\n      this.$container.css('padding-right', this.originalBodyPad)\n    },\n\n    measureScrollbar : function () { // thx walsh\n      var scrollDiv = document.createElement('div')\n      scrollDiv.className = 'modal-scrollbar-measure'\n      this.$container.append(scrollDiv)\n      var scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth\n      this.$container[0].removeChild(scrollDiv)\n      return scrollbarWidth\n    }\n\n  });  \n\n\n  Modal.VERSION  = '3.3.7'\n\n  Modal.TRANSITION_DURATION = 300\n  Modal.BACKDROP_TRANSITION_DURATION = 150\n\n  Modal.DEFAULTS = {\n    backdrop: true,\n    keyboard: true,\n    show: true\n  }\n\n  /*\n\n  // MODAL PLUGIN DEFINITION\n  // =======================\n\n  function Plugin(option, _relatedTarget) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.modal')\n      var options = langx.mixin({}, Modal.DEFAULTS, $this.data(), typeof option == 'object' && option)\n\n      if (!data) $this.data('bs.modal', (data = new Modal(this, options)))\n      if (typeof option == 'string') data[option](_relatedTarget)\n      else if (options.show) data.show(_relatedTarget)\n    })\n  }\n\n  var old = $.fn.modal\n\n  $.fn.modal             = Plugin;\n  $.fn.modal.Constructor = Modal;\n\n\n  // MODAL NO CONFLICT\n  // =================\n\n  $.fn.modal.noConflict = function () {\n    $.fn.modal = old\n    return this\n  }\n\n\n  return $.fn.modal;\n  */\n\n  plugins.register(Modal,\"modal\",function(options,_relatedTarget){\n      //this -> plugin instance\n      if (typeof options == 'string') {\n        this[options](_relatedTarget);\n      } else if (this.options.show) {\n        this.show(_relatedTarget);\n      } \n  });\n\n  return Modal;\n\n});\n\ndefine('skylark-bootstrap3/tooltip',[\n  \"skylark-langx/langx\",\n  \"skylark-domx-browser\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-noder\",\n  \"skylark-domx-geom\",\n  \"skylark-domx-query\",\n  \"skylark-domx-plugins\",\n  \"./bs3\"\n],function(langx,browser,eventer,noder,geom,$,plugins,bs3){\n\n/* ========================================================================\n * Bootstrap: tooltip.js v3.3.7\n * http://getbootstrap.com/javascript/#tooltip\n * Inspired by the original jQuery.tipsy by Jason Frame\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n  'use strict';\n\n  // TOOLTIP PUBLIC CLASS DEFINITION\n  // ===============================\n\n  var Tooltip = bs3.Tooltip = plugins.Plugin.inherit({\n    klassName: \"Tooltip\",\n\n    pluginName : \"bs3.tooltip\",\n\n    _construct : function(element,options) {\n      this.type       = null\n      this.options    = null\n      this.enabled    = null\n      this.timeout    = null\n      this.hoverState = null\n      this.$element   = null\n      this.inState    = null\n\n      this.enabled   = true;\n      this.type      = 'tooltip';\n      this.$element  = $(element)\n      this.options   = this.getOptions(options)\n      this.$viewport = this.options.viewport && $(langx.isFunction(this.options.viewport) ? this.options.viewport.call(this, this.$element) : (this.options.viewport.selector || this.options.viewport))\n      this.inState   = { click: false, hover: false, focus: false }\n\n      if (this.$element[0] instanceof document.constructor && !this.options.selector) {\n        throw new Error('`selector` option must be specified when initializing ' + this.type + ' on the window.document object!')\n      }\n\n      var triggers = this.options.trigger.split(' ')\n\n      for (var i = triggers.length; i--;) {\n        var trigger = triggers[i]\n\n        if (trigger == 'click') {\n          this.$element.on('click.' + this.type, this.options.selector, langx.proxy(this.toggle, this))\n        } else if (trigger != 'manual') {\n          var eventIn  = trigger == 'hover' ? 'mouseenter' : 'focusin'\n          var eventOut = trigger == 'hover' ? 'mouseleave' : 'focusout'\n\n          this.$element.on(eventIn  + '.' + this.type, this.options.selector, langx.proxy(this.enter, this))\n          this.$element.on(eventOut + '.' + this.type, this.options.selector, langx.proxy(this.leave, this))\n        }\n      }\n\n      this.options.selector ?\n        (this._options = langx.mixin({}, this.options, { trigger: 'manual', selector: '' })) :\n        this.fixTitle()\n    },\n\n    getDefaults : function () {\n      return Tooltip.DEFAULTS\n    },\n\n    getOptions : function (options) {\n      options = langx.mixin({}, this.getDefaults(), this.$element.data(), options)\n\n      if (options.delay && typeof options.delay == 'number') {\n        options.delay = {\n          show: options.delay,\n          hide: options.delay\n        }\n      }\n\n      return options\n    },\n\n    getDelegateOptions : function () {\n      var options  = {}\n      var defaults = this.getDefaults()\n\n      this._options && langx.each(this._options, function (key, value) {\n        if (defaults[key] != value) options[key] = value\n      })\n\n      return options\n    },\n\n    enter : function (obj) {\n      var self = obj instanceof this.constructor ?\n        obj : $(obj.currentTarget).plugin(this.pluginName)\n\n      if (!self) {\n        //self = new this.constructor(obj.currentTarget, this.getDelegateOptions())\n        self = $(obj.currentTarget).plugin(this.pluginName, this.getDelegateOptions())\n      }\n\n      if (obj instanceof eventer.create) {\n        self.inState[obj.type == 'focusin' ? 'focus' : 'hover'] = true\n      }\n\n      if (self.tip().hasClass('in') || self.hoverState == 'in') {\n        self.hoverState = 'in'\n        return\n      }\n\n      clearTimeout(self.timeout)\n\n      self.hoverState = 'in'\n\n      if (!self.options.delay || !self.options.delay.show) return self.show()\n\n      self.timeout = setTimeout(function () {\n        if (self.hoverState == 'in') self.show()\n      }, self.options.delay.show)\n    },\n\n    isInStateTrue : function () {\n      for (var key in this.inState) {\n        if (this.inState[key]) return true\n      }\n\n      return false\n    },\n\n    leave : function (obj) {\n      var self = obj instanceof this.constructor ?\n        obj : $(obj.currentTarget).plugin(this.pluginName)\n\n      if (!self) {\n        //self = new this.constructor(obj.currentTarget, this.getDelegateOptions())\n        self = $(obj.currentTarget).plugin(this.pluginName, this.getDelegateOptions())\n      }\n\n      if (obj instanceof eventer.create) {\n        self.inState[obj.type == 'focusout' ? 'focus' : 'hover'] = false\n      }\n\n      if (self.isInStateTrue()) return\n\n      clearTimeout(self.timeout)\n\n      self.hoverState = 'out'\n\n      if (!self.options.delay || !self.options.delay.hide) return self.hide()\n\n      self.timeout = setTimeout(function () {\n        if (self.hoverState == 'out') self.hide()\n      }, self.options.delay.hide)\n    },\n\n    show : function () {\n      var e = eventer.create('show.bs.' + this.type)\n\n      if (this.hasContent() && this.enabled) {\n        this.$element.trigger(e)\n\n        var inDom = noder.contains(this.$element[0].ownerDocument.documentElement, this.$element[0])\n        if (e.isDefaultPrevented() || !inDom) return\n        var that = this\n\n        var $tip = this.tip()\n\n        var tipId = this.getUID(this.type)\n\n        this.setContent()\n        $tip.attr('id', tipId)\n        this.$element.attr('aria-describedby', tipId)\n\n        if (this.options.animation) $tip.addClass('fade')\n\n        var placement = typeof this.options.placement == 'function' ?\n          this.options.placement.call(this, $tip[0], this.$element[0]) :\n          this.options.placement\n\n        var autoToken = /\\s?auto?\\s?/i\n        var autoPlace = autoToken.test(placement)\n        if (autoPlace) placement = placement.replace(autoToken, '') || 'top'\n\n        $tip\n          .detach()\n          .css({ top: 0, left: 0, display: 'block' })\n          .addClass(placement)\n          .data('bs3.' + this.type, this)\n\n        this.options.container ? $tip.appendTo(this.options.container) : $tip.insertAfter(this.$element)\n        this.$element.trigger('inserted.bs3.' + this.type)\n\n        var pos          = this.getPosition()\n        var actualWidth  = $tip[0].offsetWidth\n        var actualHeight = $tip[0].offsetHeight\n\n        if (autoPlace) {\n          var orgPlacement = placement\n          var viewportDim = this.getPosition(this.$viewport)\n\n          placement = placement == 'bottom' && pos.bottom + actualHeight > viewportDim.bottom ? 'top'    :\n                      placement == 'top'    && pos.top    - actualHeight < viewportDim.top    ? 'bottom' :\n                      placement == 'right'  && pos.right  + actualWidth  > viewportDim.width  ? 'left'   :\n                      placement == 'left'   && pos.left   - actualWidth  < viewportDim.left   ? 'right'  :\n                      placement\n\n          $tip\n            .removeClass(orgPlacement)\n            .addClass(placement)\n        }\n\n        var calculatedOffset = this.getCalculatedOffset(placement, pos, actualWidth, actualHeight)\n\n        this.applyPlacement(calculatedOffset, placement)\n\n        var complete = function () {\n          var prevHoverState = that.hoverState\n          that.$element.trigger('shown.bs3.' + that.type)\n          that.hoverState = null\n\n          if (prevHoverState == 'out') that.leave(that)\n        }\n\n        browser.support.transition && this.$tip.hasClass('fade') ?\n          $tip\n            .one('transitionEnd', complete)\n            .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :\n          complete()\n      }\n    },\n\n    applyPlacement : function (offset, placement) {\n      var $tip   = this.tip()\n      var width  = $tip[0].offsetWidth\n      var height = $tip[0].offsetHeight\n\n      // manually read margins because getBoundingClientRect includes difference\n      var marginTop = parseInt($tip.css('margin-top'), 10)\n      var marginLeft = parseInt($tip.css('margin-left'), 10)\n\n      // we must check for NaN for ie 8/9\n      if (isNaN(marginTop))  marginTop  = 0\n      if (isNaN(marginLeft)) marginLeft = 0\n\n      offset.top  += marginTop\n      offset.left += marginLeft\n\n      // $.fn.offset doesn't round pixel values\n      // so we use setOffset directly with our own function B-0\n      //$.offset.setOffset($tip[0], langx.mixin({\n       // using: function (props) {\n       //   $tip.css({\n       //     top: Math.round(props.top),\n       //     left: Math.round(props.left)\n       //   })\n       /// }\n      //}, offset), 0);\n\n      geom.pagePosition($tip[0],offset);\n      \n\n      $tip.addClass('in')\n\n      // check to see if placing tip in new offset caused the tip to resize itself\n      var actualWidth  = $tip[0].offsetWidth\n      var actualHeight = $tip[0].offsetHeight\n\n      if (placement == 'top' && actualHeight != height) {\n        offset.top = offset.top + height - actualHeight\n      }\n\n      var delta = this.getViewportAdjustedDelta(placement, offset, actualWidth, actualHeight)\n\n      if (delta.left) offset.left += delta.left\n      else offset.top += delta.top\n\n      var isVertical          = /top|bottom/.test(placement)\n      var arrowDelta          = isVertical ? delta.left * 2 - width + actualWidth : delta.top * 2 - height + actualHeight\n      var arrowOffsetPosition = isVertical ? 'offsetWidth' : 'offsetHeight'\n\n      $tip.offset(offset)\n      this.replaceArrow(arrowDelta, $tip[0][arrowOffsetPosition], isVertical)\n    },\n\n    replaceArrow : function (delta, dimension, isVertical) {\n      this.arrow()\n        .css(isVertical ? 'left' : 'top', 50 * (1 - delta / dimension) + '%')\n        .css(isVertical ? 'top' : 'left', '')\n    },\n\n    setContent : function () {\n      var $tip  = this.tip()\n      var title = this.getTitle()\n\n      $tip.find('.tooltip-inner')[this.options.html ? 'html' : 'text'](title)\n      $tip.removeClass('fade in top bottom left right')\n    },\n\n    hide : function (callback) {\n      var that = this\n      var $tip = $(this.$tip)\n      var e    = eventer.create('hide.bs3.' + this.type)\n\n      function complete() {\n        if (that.hoverState != 'in') $tip.detach()\n        if (that.$element) { // TODO: Check whether guarding this code with this `if` is really necessary.\n          that.$element\n            .removeAttr('aria-describedby')\n            .trigger('hidden.bs3.' + that.type)\n        }\n        callback && callback()\n      }\n\n      this.$element.trigger(e)\n\n      if (e.isDefaultPrevented()) return\n\n      $tip.removeClass('in')\n\n      browser.support.transition && $tip.hasClass('fade') ?\n        $tip\n          .one('transitionEnd', complete)\n          .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :\n        complete()\n\n      this.hoverState = null\n\n      return this\n    },\n\n    fixTitle : function () {\n      var $e = this.$element\n      if ($e.attr('title') || typeof $e.attr('data-original-title') != 'string') {\n        $e.attr('data-original-title', $e.attr('title') || '').attr('title', '')\n      }\n    },\n\n    hasContent : function () {\n      return this.getTitle()\n    },\n\n    getPosition : function ($element) {\n      $element   = $element || this.$element\n\n      var el     = $element[0]\n      var isBody = el.tagName == 'BODY'\n\n      var elRect    = el.getBoundingClientRect()\n      if (elRect.width == null) {\n        // width and height are missing in IE8, so compute them manually; see https://github.com/twbs/bootstrap/issues/14093\n        elRect = langx.mixin({}, elRect, { width: elRect.right - elRect.left, height: elRect.bottom - elRect.top })\n      }\n      var isSvg = window.SVGElement && el instanceof window.SVGElement\n      // Avoid using $.offset() on SVGs since it gives incorrect results in jQuery 3.\n      // See https://github.com/twbs/bootstrap/issues/20280\n      var elOffset  = isBody ? { top: 0, left: 0 } : (isSvg ? null : $element.offset())\n      var scroll    = { scroll: isBody ? document.documentElement.scrollTop || document.body.scrollTop : $element.scrollTop() }\n      var outerDims = isBody ? { width: $(window).width(), height: $(window).height() } : null\n\n      return langx.mixin({}, elRect, scroll, outerDims, elOffset)\n    },\n\n    getCalculatedOffset : function (placement, pos, actualWidth, actualHeight) {\n      return placement == 'bottom' ? { top: pos.top + pos.height,   left: pos.left + pos.width / 2 - actualWidth / 2 } :\n             placement == 'top'    ? { top: pos.top - actualHeight, left: pos.left + pos.width / 2 - actualWidth / 2 } :\n             placement == 'left'   ? { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth } :\n          /* placement == 'right' */ { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width }\n\n    },\n\n    getViewportAdjustedDelta : function (placement, pos, actualWidth, actualHeight) {\n      var delta = { top: 0, left: 0 }\n      if (!this.$viewport) return delta\n\n      var viewportPadding = this.options.viewport && this.options.viewport.padding || 0\n      var viewportDimensions = this.getPosition(this.$viewport)\n\n      if (/right|left/.test(placement)) {\n        var topEdgeOffset    = pos.top - viewportPadding - viewportDimensions.scroll\n        var bottomEdgeOffset = pos.top + viewportPadding - viewportDimensions.scroll + actualHeight\n        if (topEdgeOffset < viewportDimensions.top) { // top overflow\n          delta.top = viewportDimensions.top - topEdgeOffset\n        } else if (bottomEdgeOffset > viewportDimensions.top + viewportDimensions.height) { // bottom overflow\n          delta.top = viewportDimensions.top + viewportDimensions.height - bottomEdgeOffset\n        }\n      } else {\n        var leftEdgeOffset  = pos.left - viewportPadding\n        var rightEdgeOffset = pos.left + viewportPadding + actualWidth\n        if (leftEdgeOffset < viewportDimensions.left) { // left overflow\n          delta.left = viewportDimensions.left - leftEdgeOffset\n        } else if (rightEdgeOffset > viewportDimensions.right) { // right overflow\n          delta.left = viewportDimensions.left + viewportDimensions.width - rightEdgeOffset\n        }\n      }\n\n      return delta\n    },\n\n    getTitle : function () {\n      var title\n      var $e = this.$element\n      var o  = this.options\n\n      title = $e.attr('data-original-title')\n        || (typeof o.title == 'function' ? o.title.call($e[0]) :  o.title)\n\n      return title\n    },\n\n    getUID : function (prefix) {\n      do prefix += ~~(Math.random() * 1000000)\n      while (document.getElementById(prefix))\n      return prefix\n    },\n\n    tip : function () {\n      if (!this.$tip) {\n        this.$tip = $(this.options.template)\n        if (this.$tip.length != 1) {\n          throw new Error(this.type + ' `template` option must consist of exactly 1 top-level element!')\n        }\n      }\n      return this.$tip\n    },\n\n    arrow : function () {\n      return (this.$arrow = this.$arrow || this.tip().find('.tooltip-arrow'))\n    },\n\n    enable : function () {\n      this.enabled = true\n    },\n\n    disable : function () {\n      this.enabled = false\n    },\n\n    toggleEnabled : function () {\n      this.enabled = !this.enabled\n    },\n\n    toggle : function (e) {\n      var self = this\n      if (e) {\n        self = $(e.currentTarget).plugin(this.pluginName)\n        if (!self) {\n          //self = new this.constructor(e.currentTarget, this.getDelegateOptions())\n          self = $(e.currentTarget).plugin(this.pluginName, this.getDelegateOptions());\n        }\n      }\n\n      if (e) {\n        self.inState.click = !self.inState.click\n        if (self.isInStateTrue()) self.enter(self)\n        else self.leave(self)\n      } else {\n        self.tip().hasClass('in') ? self.leave(self) : self.enter(self)\n      }\n    },\n\n    destroy : function () {\n      var that = this\n      clearTimeout(this.timeout)\n      this.hide(function () {\n        that.$element.off('.' + that.type).removeData('bs3.' + that.type)\n        if (that.$tip) {\n          that.$tip.detach()\n        }\n        that.$tip = null\n        that.$arrow = null\n        that.$viewport = null\n        that.$element = null\n      })\n    }\n\n  }); \n\n\n\n  Tooltip.VERSION  = '3.3.7'\n\n  Tooltip.TRANSITION_DURATION = 150\n\n  Tooltip.DEFAULTS = {\n    animation: true,\n    placement: 'top',\n    selector: false,\n    template: '<div class=\"tooltip\" role=\"tooltip\"><div class=\"tooltip-arrow\"></div><div class=\"tooltip-inner\"></div></div>',\n    trigger: 'hover focus',\n    title: '',\n    delay: 0,\n    html: false,\n    container: false,\n    viewport: {\n      selector: 'body',\n      padding: 0\n    }\n  }\n\n\n  /*\n  // TOOLTIP PLUGIN DEFINITION\n  // =========================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.tooltip')\n      var options = typeof option == 'object' && option\n\n      if (!data && /destroy|hide/.test(option)) return\n      if (!data) $this.data('bs.tooltip', (data = new Tooltip(this, options)))\n      if (typeof option == 'string') data[option]()\n    })\n  }\n\n  var old = $.fn.tooltip\n\n  $.fn.tooltip             = Plugin;\n  $.fn.tooltip.Constructor = Tooltip;\n\n\n  // TOOLTIP NO CONFLICT\n  // ===================\n\n  $.fn.tooltip.noConflict = function () {\n    $.fn.tooltip = old;\n    return this;\n  }\n\n  return $.fn.tooltip;\n  */\n\n  plugins.register(Tooltip,\"tooltip\");\n\n  return Tooltip;\n});\n\ndefine('skylark-bootstrap3/popover',[\n  \"skylark-domx-browser\",\n  \"skylark-langx/langx\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-query\",\n  \"skylark-domx-plugins\",\n  \"./bs3\",\n  \"./tooltip\" \n],function(browser,langx,eventer,$,plugins,bs3,Tooltip){\n/* ========================================================================\n * Bootstrap: popover.js v3.3.7\n * http://getbootstrap.com/javascript/#popovers\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n  'use strict';\n\n  // POPOVER PUBLIC CLASS DEFINITION\n  // ===============================\n\n  var Popover = bs3.Popover = Tooltip.inherit({\n    klassName: \"Popover\",\n\n    pluginName : \"bs3.popover\",\n\n    _construct : function(element,options) {\n      this.overrided(element,options);\n      this.type = \"popover\";\n    },\n    getDefaults : function () {\n      return Popover.DEFAULTS\n    },\n\n    setContent : function () {\n      var $tip    = this.tip()\n      var title   = this.getTitle()\n      var content = this.getContent()\n\n      $tip.find('.popover-title')[this.options.html ? 'html' : 'text'](title)\n      $tip.find('.popover-content').children().detach().end()[ // we use append for html objects to maintain js events\n        this.options.html ? (typeof content == 'string' ? 'html' : 'append') : 'text'\n      ](content)\n\n      $tip.removeClass('fade top bottom left right in')\n\n      // IE8 doesn't accept hiding via the `:empty` pseudo selector, we have to do\n      // this manually by checking the contents.\n      if (!$tip.find('.popover-title').html()) $tip.find('.popover-title').hide()\n    },\n\n    hasContent : function () {\n      return this.getTitle() || this.getContent()\n    },\n\n    getContent : function () {\n      var $e = this.$element\n      var o  = this.options\n\n      return $e.attr('data-content')\n        || (typeof o.content == 'function' ?\n              o.content.call($e[0]) :\n              o.content)\n    },\n\n    arrow : function () {\n      return (this.$arrow = this.$arrow || this.tip().find('.arrow'))\n    }\n\n  });  \n\n  Popover.VERSION  = '3.3.7'\n\n  Popover.DEFAULTS = langx.mixin({}, Tooltip.DEFAULTS, {\n    placement: 'right',\n    trigger: 'click',\n    content: '',\n    template: '<div class=\"popover\" role=\"tooltip\"><div class=\"arrow\"></div><h3 class=\"popover-title\"></h3><div class=\"popover-content\"></div></div>'\n  })\n\n\n  // NOTE: POPOVER EXTENDS tooltip.js\n  // ================================\n\n  /*\n\n  // POPOVER PLUGIN DEFINITION\n  // =========================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.popover')\n      var options = typeof option == 'object' && option\n\n      if (!data && /destroy|hide/.test(option)) return\n      if (!data) $this.data('bs.popover', (data = new Popover(this, options)))\n      if (typeof option == 'string') data[option]()\n    })\n  }\n\n  var old = $.fn.popover;\n\n  $.fn.popover             = Plugin;\n  $.fn.popover.Constructor = Popover;\n\n\n  // POPOVER NO CONFLICT\n  // ===================\n\n  $.fn.popover.noConflict = function () {\n    $.fn.popover = old\n    return this\n  };\n\n  return $.fn.popover;\n  */\n\n  plugins.register(Popover,\"popover\");\n\n  return Popover;\n\n});\n\ndefine('skylark-domx-spy/ScrollSpy',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-browser\",\r\n  \"skylark-domx-eventer\",\r\n  \"skylark-domx-noder\",\r\n  \"skylark-domx-geom\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-domx-plugins\",\r\n  \"./spy\"\r\n],function(langx,browser,eventer,noder,geom,$,plugins,spy){\r\n\r\n  'use strict';\r\n\r\n  // SCROLLSPY CLASS DEFINITION\r\n  // ==========================\r\n\r\n  var ScrollSpy =  plugins.Plugin.inherit({\r\n    klassName: \"ScrollSpy\",\r\n\r\n    pluginName : \"domx.scrollspy\",\r\n\r\n    options: {\r\n      offset: 10\r\n    },\r\n\r\n    _construct : function(elm,options) {\r\n      this.overrided(elm,options);\r\n      this.$body          = $(document.body)\r\n      this.$scrollElement = this.$().is(document.body) ? $(window) : this.$();\r\n      //this.options        = langx.mixin({}, ScrollSpy.DEFAULTS, options)\r\n      this.selector       = (this.options.target || '') + ' .nav li > a'\r\n      this.offsets        = []\r\n      this.targets        = []\r\n      this.activeTarget   = null\r\n      this.scrollHeight   = 0\r\n\r\n      this.$scrollElement.on('scroll.scrollspy', langx.proxy(this.process, this))\r\n      this.refresh()\r\n      this.process()\r\n    },\r\n\r\n    getScrollHeight : function () {\r\n      return this.$scrollElement[0].scrollHeight || Math.max(this.$body[0].scrollHeight, document.documentElement.scrollHeight)\r\n    },\r\n\r\n    refresh : function () {\r\n      var that          = this\r\n      var offsetMethod  = 'offset'\r\n      var offsetBase    = 0\r\n\r\n      this.offsets      = []\r\n      this.targets      = []\r\n      this.scrollHeight = this.getScrollHeight()\r\n\r\n      if (!langx.isWindow(this.$scrollElement[0])) {\r\n        offsetMethod = 'position'\r\n        offsetBase   = this.$scrollElement.scrollTop()\r\n      }\r\n\r\n      this.$body\r\n        .find(this.selector)\r\n        .map(function () {\r\n          var $el   = $(this)\r\n          var href  = $el.data('target') || $el.attr('href')\r\n          var $href = /^#./.test(href) && $(href)\r\n\r\n          return ($href\r\n            && $href.length\r\n            && $href.is(':visible')\r\n            && [[$href[offsetMethod]().top + offsetBase, href]]) || null\r\n        })\r\n        .sort(function (a, b) { return a[0] - b[0] })\r\n        .each(function () {\r\n          that.offsets.push(this[0])\r\n          that.targets.push(this[1])\r\n        })\r\n    },\r\n\r\n    process : function () {\r\n      var scrollTop    = this.$scrollElement.scrollTop() + this.options.offset\r\n      var scrollHeight = this.getScrollHeight()\r\n      var maxScroll    = this.options.offset + scrollHeight - this.$scrollElement.height()\r\n      var offsets      = this.offsets\r\n      var targets      = this.targets\r\n      var activeTarget = this.activeTarget\r\n      var i\r\n\r\n      if (this.scrollHeight != scrollHeight) {\r\n        this.refresh()\r\n      }\r\n\r\n      if (scrollTop >= maxScroll) {\r\n        return activeTarget != (i = targets[targets.length - 1]) && this.activate(i)\r\n      }\r\n\r\n      if (activeTarget && scrollTop < offsets[0]) {\r\n        this.activeTarget = null\r\n        return this.clear()\r\n      }\r\n\r\n      for (i = offsets.length; i--;) {\r\n        activeTarget != targets[i]\r\n          && scrollTop >= offsets[i]\r\n          && (offsets[i + 1] === undefined || scrollTop < offsets[i + 1])\r\n          && this.activate(targets[i])\r\n      }\r\n    },\r\n\r\n    activate : function (target) {\r\n      this.activeTarget = target\r\n\r\n      this.clear()\r\n\r\n      var selector = this.selector +\r\n        '[data-target=\"' + target + '\"],' +\r\n        this.selector + '[href=\"' + target + '\"]'\r\n\r\n      var active = $(selector)\r\n        .parents('li')\r\n        .addClass('active')\r\n\r\n      if (active.parent('.dropdown-menu').length) {\r\n        active = active\r\n          .closest('li.dropdown')\r\n          .addClass('active')\r\n      }\r\n\r\n      active.trigger('activate.scrollspy')\r\n    },\r\n\r\n    clear : function () {\r\n      $(this.selector)\r\n        .parentsUntil(this.options.target, '.active')\r\n        .removeClass('active')\r\n    }\r\n\r\n  });\r\n\r\n  plugins.register(ScrollSpy);\r\n\r\n  return spy.ScrollSpy = ScrollSpy;\r\n\r\n});\r\n\ndefine('skylark-bootstrap3/scrollspy',[\n  \"skylark-domx-plugins\",\n  \"skylark-domx-spy/ScrollSpy\",\n  \"./bs3\"\n],function(plugins,_ScrollSpy,bs3){\n\n\n/* ========================================================================\n * Bootstrap: scrollspy.js v3.3.7\n * http://getbootstrap.com/javascript/#scrollspy\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n  'use strict';\n\n  // SCROLLSPY CLASS DEFINITION\n  // ==========================\n\n  var ScrollSpy = bs3.ScrollSpy = _ScrollSpy.inherit({\n    klassName: \"ScrollSpy\",\n\n    pluginName : \"bs3.scrollspy\"\n\n\n  });\n\n  ScrollSpy.VERSION  = '3.3.7'\n\n  /*\n\n  // SCROLLSPY PLUGIN DEFINITION\n  // ===========================\n  var old = $.fn.scrollspy;\n\n  $.fn.scrollspy = function scrollspy(option) {\n    return this.each(function () {\n      var $this   = $(this)\n      var data    = $this.data('bs.scrollspy')\n      var options = typeof option == 'object' && option\n\n      if (!data) $this.data('bs.scrollspy', (data = new ScrollSpy(this, options)))\n      if (typeof option == 'string') data[option]()\n    })\n  }\n\n\n  $.fn.scrollspy.Constructor = ScrollSpy;\n\n\n  // SCROLLSPY NO CONFLICT\n  // =====================\n\n  $.fn.scrollspy.noConflict = function () {\n    $.fn.scrollspy = old;\n    return this;\n  }\n\n\n  return $.fn.scrollspy;\n  */\n\n  plugins.register(ScrollSpy,\"scrollspy\");\n\n  return ScrollSpy;\n\n});\n\ndefine('skylark-domx-panels/Tab',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-browser\",\r\n  \"skylark-domx-eventer\",\r\n  \"skylark-domx-noder\",\r\n  \"skylark-domx-geom\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-domx-plugins\",\r\n  \"./panels\"\r\n],function(langx,browser,eventer,noder,geom,$,plugins,panels){\r\n\r\n  'use strict';\r\n\r\n  // TAB CLASS DEFINITION\r\n  // ====================\r\n\r\n\r\n  var Tab =  plugins.Plugin.inherit({\r\n    klassName: \"Tab\",\r\n\r\n    pluginName : \"domx.tab\",\r\n\r\n    _construct : function(element,options) {\r\n      // jscs:disable requireDollarBeforejQueryAssignment\r\n      this.element = $(element)\r\n      this.target = options && options.target;\r\n\r\n      // jscs:enable requireDollarBeforejQueryAssignment\r\n      this.element.on(\"click.bs.tab.data-api\",langx.proxy(function(e){\r\n        e.preventDefault()\r\n        this.show();\r\n      },this));    \r\n    },\r\n\r\n    show : function () {\r\n      var $this    = this.element\r\n      var $ul      = $this.closest('ul:not(.dropdown-menu)')\r\n      var selector = this.target || $this.data('target');\r\n\r\n      if (!selector) {\r\n        selector = $this.attr('href')\r\n        selector = selector && selector.replace(/.*(?=#[^\\s]*$)/, '') // strip for ie7\r\n      }\r\n\r\n      if ($this.parent('li').hasClass('active')) return\r\n\r\n      var $previous = $ul.find('.active:last a')\r\n      var hideEvent = eventer.create('hide.bs.tab', {\r\n        relatedTarget: $this[0]\r\n      })\r\n      var showEvent = eventer.create('show.bs.tab', {\r\n        relatedTarget: $previous[0]\r\n      })\r\n\r\n      $previous.trigger(hideEvent)\r\n      $this.trigger(showEvent)\r\n\r\n      if (showEvent.isDefaultPrevented() || hideEvent.isDefaultPrevented()) return\r\n\r\n      var $target = $(selector)\r\n\r\n      this.activate($this.closest('li'), $ul)\r\n      this.activate($target, $target.parent(), function () {\r\n        $previous.trigger({\r\n          type: 'hidden.bs.tab',\r\n          relatedTarget: $this[0]\r\n        })\r\n        $this.trigger({\r\n          type: 'shown.bs.tab',\r\n          relatedTarget: $previous[0]\r\n        })\r\n      })\r\n    },\r\n\r\n    activate : function (element, container, callback) {\r\n      var $active    = container.find('> .active')\r\n      var transition = callback\r\n        && browser.support.transition\r\n        && ($active.length && $active.hasClass('fade') || !!container.find('> .fade').length)\r\n\r\n      function next() {\r\n        $active\r\n          .removeClass('active')\r\n          .find('> .dropdown-menu > .active')\r\n            .removeClass('active')\r\n          .end()\r\n          .find('[data-toggle=\"tab\"]')\r\n            .attr('aria-expanded', false)\r\n\r\n        element\r\n          .addClass('active')\r\n          .find('[data-toggle=\"tab\"]')\r\n            .attr('aria-expanded', true)\r\n\r\n        if (transition) {\r\n          element[0].offsetWidth // reflow for transition\r\n          element.addClass('in')\r\n        } else {\r\n          element.removeClass('fade')\r\n        }\r\n\r\n        if (element.parent('.dropdown-menu').length) {\r\n          element\r\n            .closest('li.dropdown')\r\n              .addClass('active')\r\n            .end()\r\n            .find('[data-toggle=\"tab\"]')\r\n              .attr('aria-expanded', true)\r\n        }\r\n\r\n        callback && callback()\r\n      }\r\n\r\n      $active.length && transition ?\r\n        $active\r\n          .one('transitionEnd', next)\r\n          .emulateTransitionEnd(Tab.TRANSITION_DURATION) :\r\n        next()\r\n\r\n      $active.removeClass('in')\r\n    }\r\n\r\n\r\n  });\r\n\r\n\r\n  Tab.TRANSITION_DURATION = 150\r\n\r\n\r\n  plugins.register(Tab);\r\n\r\n  return panels.Tab = Tab;\r\n});\r\n\ndefine('skylark-bootstrap3/tab',[\n  \"skylark-domx-plugins\",\n  \"skylark-domx-panels/Tab\",\n  \"./bs3\"\n],function(plugins,_Tab,bs3){\n\n/* ========================================================================\n * Bootstrap: tab.js v3.3.7\n * http://getbootstrap.com/javascript/#tabs\n * ========================================================================\n * Copyright 2011-2016 Twitter, Inc.\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * ======================================================================== */\n\n  'use strict';\n\n  // TAB CLASS DEFINITION\n  // ====================\n\n\n  var Tab = bs3.Tab = _Tab.inherit({\n    klassName: \"Tab\",\n\n    pluginName : \"bs3.tab\"\n  });\n\n\n  Tab.VERSION = '3.3.7'\n\n  /*\n  // TAB PLUGIN DEFINITION\n  // =====================\n\n  function Plugin(option) {\n    return this.each(function () {\n      var $this = $(this)\n      var data  = $this.data('bs.tab')\n\n      if (!data) $this.data('bs.tab', (data = new Tab(this,option)))\n      if (typeof option == 'string') data[option]()\n    })\n  }\n\n  var old = $.fn.tab\n\n  $.fn.tab             = Plugin\n  $.fn.tab.Constructor = Tab\n\n\n  // TAB NO CONFLICT\n  // ===============\n\n  $.fn.tab.noConflict = function () {\n    $.fn.tab = old\n    return this\n  }\n\n  return $.fn.tab;\n  */\n\n  plugins.register(Tab,\"tab\");\n\n  return Tab;\n});\n\ndefine('skylark-bootstrap3/taginput',[\n  \"skylark-langx/langx\",\n  \"skylark-domx-browser\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-noder\",\n  \"skylark-domx-geom\",\n  \"skylark-domx-query\",\n  \"skylark-domx-plugins\",\n  \"./bs3\"\n],function(langx,browser,eventer,noder,geom,$,plugins,bs3){\n\n  \"use strict\";\n\n  var defaultOptions = {\n    tagClass: function(item) {\n      return 'label label-info';\n    },\n    focusClass: 'focus',\n    itemValue: function(item) {\n      return item ? item.toString() : item;\n    },\n    itemText: function(item) {\n      return this.itemValue(item);\n    },\n    itemTitle: function(item) {\n      return null;\n    },\n    freeInput: true,\n    addOnBlur: true,\n    maxTags: undefined,\n    maxChars: undefined,\n    confirmKeys: [13, 44],\n    delimiter: ',',\n    delimiterRegex: null,\n    cancelConfirmKeysOnEmpty: false,\n    onTagExists: function(item, $tag) {\n      $tag.hide().fadeIn();\n    },\n    trimValue: false,\n    allowDuplicates: false,\n    triggerChange: true\n  };\n\n\n  var TagsInput = bs3.TagsInput = plugins.Plugin.inherit({\n    klassName: \"TagsInput\",\n\n    pluginName : \"bs3.TagsInput\",\n\n  /**\n   * Constructor function\n   */\n    _construct : function(element, options) {\n      this.objectItems = options && options.itemValue;\n      options = langx.mixin({}, defaultOptions, $(element).data(), options)\n      this.overrided(element,options);\n\n      this.isInit = true;\n      this.itemsArray = [];\n\n\n      this.$element = $(element);\n      this.$element.hide();\n\n      this.isSelect = (element.tagName === 'SELECT');\n      this.multiple = (this.isSelect && element.hasAttribute('multiple'));\n      this.placeholderText = element.hasAttribute('placeholder') ? this.$element.attr('placeholder') : '';\n      this.inputSize = Math.max(1, this.placeholderText.length);\n\n      this.$container = $('<div class=\"bootstrap-tagsinput\"></div>');\n      this.$input = $('<input type=\"text\" placeholder=\"' + this.placeholderText + '\"/>').appendTo(this.$container);\n\n      this.$element.before(this.$container);\n\n      this.build();\n      this.isInit = false;\n    },\n\n\n    /**\n     * Adds the given item as a new tag. Pass true to dontPushVal to prevent\n     * updating the elements val()\n     */\n    add: function(item, dontPushVal, options) {\n      var self = this;\n\n      if (self.options.maxTags && self.itemsArray.length >= self.options.maxTags)\n        return;\n\n      // Ignore falsey values, except false\n      if (item !== false && !item)\n        return;\n\n      // Trim value\n      if (typeof item === \"string\" && self.options.trimValue) {\n        item = langx.trim(item);\n      }\n\n      // Throw an error when trying to add an object while the itemValue option was not set\n      if (typeof item === \"object\" && !self.objectItems)\n        throw(\"Can't add objects when itemValue option is not set\");\n\n      // Ignore strings only containg whitespace\n      if (item.toString().match(/^\\s*$/))\n        return;\n\n      // If SELECT but not multiple, remove current tag\n      if (self.isSelect && !self.multiple && self.itemsArray.length > 0)\n        self.remove(self.itemsArray[0]);\n\n      if (typeof item === \"string\" && this.$element[0].tagName === 'INPUT') {\n        var delimiter = (self.options.delimiterRegex) ? self.options.delimiterRegex : self.options.delimiter;\n        var items = item.split(delimiter);\n        if (items.length > 1) {\n          for (var i = 0; i < items.length; i++) {\n            this.add(items[i], true);\n          }\n\n          if (!dontPushVal)\n            self.pushVal(self.options.triggerChange);\n          return;\n        }\n      }\n\n      var itemValue = self.options.itemValue(item),\n          itemText = self.options.itemText(item),\n          tagClass = self.options.tagClass(item),\n          itemTitle = self.options.itemTitle(item);\n\n      // Ignore items allready added\n      var existing = langx.grep(self.itemsArray, function(item) { return self.options.itemValue(item) === itemValue; } )[0];\n      if (existing && !self.options.allowDuplicates) {\n        // Invoke onTagExists\n        if (self.options.onTagExists) {\n          var $existingTag = $(\".tag\", self.$container).filter(function() { return $(this).data(\"item\") === existing; });\n          self.options.onTagExists(item, $existingTag);\n        }\n        return;\n      }\n\n      // if length greater than limit\n      if (self.items().toString().length + item.length + 1 > self.options.maxInputLength)\n        return;\n\n      // raise beforeItemAdd arg\n      var beforeItemAddEvent = eventer.create('beforeItemAdd', { item: item, cancel: false, options: options});\n      self.$element.trigger(beforeItemAddEvent);\n      if (beforeItemAddEvent.cancel)\n        return;\n\n      // register item in internal array and map\n      self.itemsArray.push(item);\n\n      // add a tag element\n\n      var $tag = $('<span class=\"tag ' + htmlEncode(tagClass) + (itemTitle !== null ? ('\" title=\"' + itemTitle) : '') + '\">' + htmlEncode(itemText) + '<span data-role=\"remove\"></span></span>');\n      $tag.data('item', item);\n      self.findInputWrapper().before($tag);\n      $tag.after(' ');\n\n      // Check to see if the tag exists in its raw or uri-encoded form\n      var optionExists = (\n        $('option[value=\"' + encodeURIComponent(itemValue) + '\"]', self.$element).length ||\n        $('option[value=\"' + htmlEncode(itemValue) + '\"]', self.$element).length\n      );\n\n      // add <option /> if item represents a value not present in one of the <select />'s options\n      if (self.isSelect && !optionExists) {\n        var $option = $('<option selected>' + htmlEncode(itemText) + '</option>');\n        $option.data('item', item);\n        $option.attr('value', itemValue);\n        self.$element.append($option);\n      }\n\n      if (!dontPushVal)\n        self.pushVal(self.options.triggerChange);\n\n      // Add class when reached maxTags\n      if (self.options.maxTags === self.itemsArray.length || self.items().toString().length === self.options.maxInputLength)\n        self.$container.addClass('bootstrap-tagsinput-max');\n\n      // If using typeahead, once the tag has been added, clear the typeahead value so it does not stick around in the input.\n      if ($('.typeahead, .twitter-typeahead', self.$container).length) {\n        self.$input.typeahead('val', '');\n      }\n\n      if (this.isInit) {\n        self.$element.trigger(eventer.create('itemAddedOnInit', { item: item, options: options }));\n      } else {\n        self.$element.trigger(eventer.create('itemAdded', { item: item, options: options }));\n      }\n    },\n\n    /**\n     * Removes the given item. Pass true to dontPushVal to prevent updating the\n     * elements val()\n     */\n    remove: function(item, dontPushVal, options) {\n      var self = this;\n\n      if (self.objectItems) {\n        if (typeof item === \"object\")\n          item = langx.grep(self.itemsArray, function(other) { return self.options.itemValue(other) ==  self.options.itemValue(item); } );\n        else\n          item = langx.grep(self.itemsArray, function(other) { return self.options.itemValue(other) ==  item; } );\n\n        item = item[item.length-1];\n      }\n\n      if (item) {\n        var beforeItemRemoveEvent = eventer.create('beforeItemRemove', { item: item, cancel: false, options: options });\n        self.$element.trigger(beforeItemRemoveEvent);\n        if (beforeItemRemoveEvent.cancel)\n          return;\n\n        $('.tag', self.$container).filter(function() { return $(this).data('item') === item; }).remove();\n        $('option', self.$element).filter(function() { return $(this).data('item') === item; }).remove();\n        if(langx.inArray(item, self.itemsArray) !== -1)\n          self.itemsArray.splice(langx.inArray(item, self.itemsArray), 1);\n      }\n\n      if (!dontPushVal)\n        self.pushVal(self.options.triggerChange);\n\n      // Remove class when reached maxTags\n      if (self.options.maxTags > self.itemsArray.length)\n        self.$container.removeClass('bootstrap-tagsinput-max');\n\n      self.$element.trigger(eventer.create('itemRemoved',  { item: item, options: options }));\n    },\n\n    /**\n     * Removes all items\n     */\n    removeAll: function() {\n      var self = this;\n\n      $('.tag', self.$container).remove();\n      $('option', self.$element).remove();\n\n      while(self.itemsArray.length > 0)\n        self.itemsArray.pop();\n\n      self.pushVal(self.options.triggerChange);\n    },\n\n    /**\n     * Refreshes the tags so they match the text/value of their corresponding\n     * item.\n     */\n    refresh: function() {\n      var self = this;\n      $('.tag', self.$container).each(function() {\n        var $tag = $(this),\n            item = $tag.data('item'),\n            itemValue = self.options.itemValue(item),\n            itemText = self.options.itemText(item),\n            tagClass = self.options.tagClass(item);\n\n          // Update tag's class and inner text\n          $tag.attr('class', null);\n          $tag.addClass('tag ' + htmlEncode(tagClass));\n          $tag.contents().filter(function() {\n            return this.nodeType == 3;\n          })[0].nodeValue = htmlEncode(itemText);\n\n          if (self.isSelect) {\n            var option = $('option', self.$element).filter(function() { return $(this).data('item') === item; });\n            option.attr('value', itemValue);\n          }\n      });\n    },\n\n    /**\n     * Returns the items added as tags\n     */\n    items: function() {\n      return this.itemsArray;\n    },\n\n    /**\n     * Assembly value by retrieving the value of each item, and set it on the\n     * element.\n     */\n    pushVal: function() {\n      var self = this,\n          val = langx.map(self.items(), function(item) {\n            return self.options.itemValue(item).toString();\n          });\n\n      self.$element.val(val, true);\n\n      if (self.options.triggerChange)\n        self.$element.trigger('change');\n    },\n\n    /**\n     * Initializes the tags input behaviour on the element\n     */\n    build: function(options) {\n      var self = this;\n\n      //self.options = $.extend({}, defaultOptions, options);\n\n      // When itemValue is set, freeInput should always be false\n      if (self.objectItems)\n        self.options.freeInput = false;\n\n      makeOptionItemFunction(self.options, 'itemValue');\n      makeOptionItemFunction(self.options, 'itemText');\n      makeOptionFunction(self.options, 'tagClass');\n\n      // Typeahead Bootstrap version 2.3.2\n      if (self.options.typeahead) {\n        var typeahead = self.options.typeahead || {};\n\n        makeOptionFunction(typeahead, 'source');\n\n        self.$input.typeahead(langx.extend({}, typeahead, {\n          source: function (query, process) {\n            function processItems(items) {\n              var texts = [];\n\n              for (var i = 0; i < items.length; i++) {\n                var text = self.options.itemText(items[i]);\n                map[text] = items[i];\n                texts.push(text);\n              }\n              process(texts);\n            }\n\n            this.map = {};\n            var map = this.map,\n                data = typeahead.source(query);\n\n            if (langx.isFunction(data.success)) {\n              // support for Angular callbacks\n              data.success(processItems);\n            } else if (langx.isFunction(data.then)) {\n              // support for Angular promises\n              data.then(processItems);\n            } else {\n              // support for functions and jquery promises\n              langx.Deferred.when(data)\n               .then(processItems);\n            }\n          },\n          updater: function (text) {\n            self.add(this.map[text]);\n            return this.map[text];\n          },\n          matcher: function (text) {\n            return (text.toLowerCase().indexOf(this.query.trim().toLowerCase()) !== -1);\n          },\n          sorter: function (texts) {\n            return texts.sort();\n          },\n          highlighter: function (text) {\n            var regex = new RegExp( '(' + this.query + ')', 'gi' );\n            return text.replace( regex, \"<strong>$1</strong>\" );\n          }\n        }));\n      }\n\n      // typeahead.js\n      if (self.options.typeaheadjs) {\n        // Determine if main configurations were passed or simply a dataset\n        var typeaheadjs = self.options.typeaheadjs;\n        if (!langx.isArray(typeaheadjs)) {\n            typeaheadjs = [null, typeaheadjs];\n        }\n\n        $.fn.typeahead.apply(self.$input, typeaheadjs).on('typeahead:selected', langx.proxy(function (obj, datum, name) {\n          var index = 0;\n          typeaheadjs.some(function(dataset, _index) {\n            if (dataset.name === name) {\n              index = _index;\n              return true;\n            }\n            return false;\n          });\n\n          // @TODO Dep: https://github.com/corejavascript/typeahead.js/issues/89\n          if (typeaheadjs[index].valueKey) {\n            self.add(datum[typeaheadjs[index].valueKey]);\n          } else {\n            self.add(datum);\n          }\n\n          self.$input.typeahead('val', '');\n        }, self));\n      }\n\n      self.$container.on('click', langx.proxy(function(event) {\n        if (! self.$element.attr('disabled')) {\n          self.$input.removeAttr('disabled');\n        }\n        self.$input.focus();\n      }, self));\n\n        if (self.options.addOnBlur && self.options.freeInput) {\n          self.$input.on('focusout', langx.proxy(function(event) {\n              // HACK: only process on focusout when no typeahead opened, to\n              //       avoid adding the typeahead text as tag\n              if ($('.typeahead, .twitter-typeahead', self.$container).length === 0) {\n                self.add(self.$input.val());\n                self.$input.val('');\n              }\n          }, self));\n        }\n\n      // Toggle the 'focus' css class on the container when it has focus\n      self.$container.on({\n        focusin: function() {\n          self.$container.addClass(self.options.focusClass);\n        },\n        focusout: function() {\n          self.$container.removeClass(self.options.focusClass);\n        },\n      });\n\n      self.$container.on('keydown', 'input', langx.proxy(function(event) {\n        var $input = $(event.target),\n            $inputWrapper = self.findInputWrapper();\n\n        if (self.$element.attr('disabled')) {\n          self.$input.attr('disabled', 'disabled');\n          return;\n        }\n\n        switch (event.which) {\n          // BACKSPACE\n          case 8:\n            if (doGetCaretPosition($input[0]) === 0) {\n              var prev = $inputWrapper.prev();\n              if (prev.length) {\n                self.remove(prev.data('item'));\n              }\n            }\n            break;\n\n          // DELETE\n          case 46:\n            if (doGetCaretPosition($input[0]) === 0) {\n              var next = $inputWrapper.next();\n              if (next.length) {\n                self.remove(next.data('item'));\n              }\n            }\n            break;\n\n          // LEFT ARROW\n          case 37:\n            // Try to move the input before the previous tag\n            var $prevTag = $inputWrapper.prev();\n            if ($input.val().length === 0 && $prevTag[0]) {\n              $prevTag.before($inputWrapper);\n              $input.focus();\n            }\n            break;\n          // RIGHT ARROW\n          case 39:\n            // Try to move the input after the next tag\n            var $nextTag = $inputWrapper.next();\n            if ($input.val().length === 0 && $nextTag[0]) {\n              $nextTag.after($inputWrapper);\n              $input.focus();\n            }\n            break;\n         default:\n             // ignore\n         }\n\n        // Reset internal input's size\n        var textLength = $input.val().length,\n            wordSpace = Math.ceil(textLength / 5),\n            size = textLength + wordSpace + 1;\n        $input.attr('size', Math.max(this.inputSize, $input.val().length));\n      }, self));\n\n      self.$container.on('keypress', 'input', langx.proxy(function(event) {\n         var $input = $(event.target);\n\n         if (self.$element.attr('disabled')) {\n            self.$input.attr('disabled', 'disabled');\n            return;\n         }\n\n         var text = $input.val(),\n         maxLengthReached = self.options.maxChars && text.length >= self.options.maxChars;\n         if (self.options.freeInput && (keyCombinationInList(event, self.options.confirmKeys) || maxLengthReached)) {\n            // Only attempt to add a tag if there is data in the field\n            if (text.length !== 0) {\n               self.add(maxLengthReached ? text.substr(0, self.options.maxChars) : text);\n               $input.val('');\n            }\n\n            // If the field is empty, let the event triggered fire as usual\n            if (self.options.cancelConfirmKeysOnEmpty === false) {\n                event.preventDefault();\n            }\n         }\n\n         // Reset internal input's size\n         var textLength = $input.val().length,\n            wordSpace = Math.ceil(textLength / 5),\n            size = textLength + wordSpace + 1;\n         $input.attr('size', Math.max(this.inputSize, $input.val().length));\n      }, self));\n\n      // Remove icon clicked\n      self.$container.on('click', '[data-role=remove]', langx.proxy(function(event) {\n        if (self.$element.attr('disabled')) {\n          return;\n        }\n        self.remove($(event.target).closest('.tag').data('item'));\n      }, self));\n\n      // Only add existing value as tags when using strings as tags\n      if (self.options.itemValue === defaultOptions.itemValue) {\n        if (self.$element[0].tagName === 'INPUT') {\n            self.add(self.$element.val());\n        } else {\n          $('option', self.$element).each(function() {\n            self.add($(this).attr('value'), true);\n          });\n        }\n      }\n    },\n\n    /**\n     * Removes all tagsinput behaviour and unregsiter all event handlers\n     */\n    destroy: function() {\n      var self = this;\n\n      // Unbind events\n      self.$container.off('keypress', 'input');\n      self.$container.off('click', '[role=remove]');\n\n      self.$container.remove();\n      self.$element.removeData('tagsinput');\n      self.$element.show();\n    },\n\n    /**\n     * Sets focus on the tagsinput\n     */\n    focus: function() {\n      this.$input.focus();\n    },\n\n    /**\n     * Returns the internal input element\n     */\n    input: function() {\n      return this.$input;\n    },\n\n    /**\n     * Returns the element which is wrapped around the internal input. This\n     * is normally the $container, but typeahead.js moves the $input element.\n     */\n    findInputWrapper: function() {\n      var elt = this.$input[0],\n          container = this.$container[0];\n      while(elt && elt.parentNode !== container)\n        elt = elt.parentNode;\n\n      return $(elt);\n    }\n  });\n\n  /**\n   * Register JQuery plugin\n   */\n  $.fn.tagsinput = function(arg1, arg2, arg3) {\n    var results = [];\n\n    this.each(function() {\n      var tagsinput = $(this).data('tagsinput');\n      // Initialize a new tags input\n      if (!tagsinput) {\n          tagsinput = new TagsInput(this, arg1);\n          $(this).data('tagsinput', tagsinput);\n          results.push(tagsinput);\n\n          if (this.tagName === 'SELECT') {\n              $('option', $(this)).attr('selected', 'selected');\n          }\n\n          // Init tags from $(this).val()\n          $(this).val($(this).val());\n      } else if (!arg1 && !arg2) {\n          // tagsinput already exists\n          // no function, trying to init\n          results.push(tagsinput);\n      } else if(tagsinput[arg1] !== undefined) {\n          // Invoke function on existing tags input\n            if(tagsinput[arg1].length === 3 && arg3 !== undefined){\n               var retVal = tagsinput[arg1](arg2, null, arg3);\n            }else{\n               var retVal = tagsinput[arg1](arg2);\n            }\n          if (retVal !== undefined)\n              results.push(retVal);\n      }\n    });\n\n    if ( typeof arg1 == 'string') {\n      // Return the results from the invoked function calls\n      return results.length > 1 ? results : results[0];\n    } else {\n      return results;\n    }\n  };\n\n  $.fn.tagsinput.Constructor = TagsInput;\n\n  /**\n   * Most options support both a string or number as well as a function as\n   * option value. This function makes sure that the option with the given\n   * key in the given options is wrapped in a function\n   */\n  function makeOptionItemFunction(options, key) {\n    if (typeof options[key] !== 'function') {\n      var propertyName = options[key];\n      options[key] = function(item) { return item[propertyName]; };\n    }\n  }\n  function makeOptionFunction(options, key) {\n    if (typeof options[key] !== 'function') {\n      var value = options[key];\n      options[key] = function() { return value; };\n    }\n  }\n  /**\n   * HtmlEncodes the given value\n   */\n  var htmlEncodeContainer = $('<div />');\n  function htmlEncode(value) {\n    if (value) {\n      return htmlEncodeContainer.text(value).html();\n    } else {\n      return '';\n    }\n  }\n\n  /**\n   * Returns the position of the caret in the given input field\n   * http://flightschool.acylt.com/devnotes/caret-position-woes/\n   */\n  function doGetCaretPosition(oField) {\n    var iCaretPos = 0;\n    if (document.selection) {\n      oField.focus ();\n      var oSel = document.selection.createRange();\n      oSel.moveStart ('character', -oField.value.length);\n      iCaretPos = oSel.text.length;\n    } else if (oField.selectionStart || oField.selectionStart == '0') {\n      iCaretPos = oField.selectionStart;\n    }\n    return (iCaretPos);\n  }\n\n  /**\n    * Returns boolean indicates whether user has pressed an expected key combination.\n    * @param object keyPressEvent: JavaScript event object, refer\n    *     http://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html\n    * @param object lookupList: expected key combinations, as in:\n    *     [13, {which: 188, shiftKey: true}]\n    */\n  function keyCombinationInList(keyPressEvent, lookupList) {\n      var found = false;\n      langx.each(lookupList, function (index, keyCombination) {\n          if (typeof (keyCombination) === 'number' && keyPressEvent.which === keyCombination) {\n              found = true;\n              return false;\n          }\n\n          if (keyPressEvent.which === keyCombination.which) {\n              var alt = !keyCombination.hasOwnProperty('altKey') || keyPressEvent.altKey === keyCombination.altKey,\n                  shift = !keyCombination.hasOwnProperty('shiftKey') || keyPressEvent.shiftKey === keyCombination.shiftKey,\n                  ctrl = !keyCombination.hasOwnProperty('ctrlKey') || keyPressEvent.ctrlKey === keyCombination.ctrlKey;\n              if (alt && shift && ctrl) {\n                  found = true;\n                  return false;\n              }\n          }\n      });\n\n      return found;\n  }\n\n  return TagsInput;\n\n});\ndefine('skylark-bootstrap3/loadedInit',[\n \t\"skylark-langx/langx\",\n \t\"skylark-domx-query\",\n\t\"./affix\",\n\t\"./alert\",\n\t\"./button\",\n\t\"./carousel\",\n\t\"./collapse\",\n\t\"./dropdown\",\n\t\"./modal\",\n\t\"./popover\",\n\t\"./scrollspy\",\n\t\"./tab\",\n\t\"./taginput\",\n\t\"./tooltip\",\n\t\"./transition\"\n],function(langx,$,Affix,Alert,Button,Carousel,Collapse,Dropdown,Modal,Popover,ScrollSpy,Tab,Tooltip){\n\tfunction getTargetFromTrigger($trigger) {\n\t\tvar href\n\t\tvar target = $trigger.attr('data-target')\n\t\t  || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\\s]+$)/, '') // strip for ie7\n\n\t\treturn $(target);\n\t}\n\n\tvar init = function() {\n    \n\t\t$(function () {\n\t\t    // AFFIX DATA-API\n\t\t    // =================\n\t\t\t$('[data-spy=\"affix\"]').each(function () {\n\t\t\t\tvar $spy = $(this)\n\t\t\t\tvar data = $spy.data()\n\n\t\t\t\tdata.offset = data.offset || {};\n\n\t\t\t\tif (data.offsetBottom != null) data.offset.bottom = data.offsetBottom\n\t\t\t\tif (data.offsetTop    != null) data.offset.top    = data.offsetTop\n\n\t\t\t\t$spy.affix(data);\n\t\t\t});\n\n\n\t\t  \t// ALERT DATA-API\n\t\t    // =================\n  \t\t\t//$(document).on('click.bs.alert.data-api', dismiss, Alert.prototype.close)\n\n  \t\t\t// BUTTON DATA-API\n\t\t    // =================\n\t\t\t$(document).on('click.bs3.button.data-api', '[data-toggle^=\"button\"]', function (e) {\n\t\t\t\tvar $btn = $(e.target).closest('.btn')\n\t\t\t\t$btn.button('toggle');\n\t\t\t\tif (!($(e.target).is('input[type=\"radio\"], input[type=\"checkbox\"]'))) {\n\t\t\t\t\t// Prevent double click on radios, and the double selections (so cancellation) on checkboxes\n\t\t\t\t\te.preventDefault()\n\t\t\t\t\t// The target component still receive the focus\n\t\t\t\t\tif ($btn.is('input,button')) {\n\t\t\t\t\t\t$btn.trigger('focus');\n\t\t\t\t\t}else {\n\t\t\t\t\t\t$btn.find('input:visible,button:visible').first().trigger('focus');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).on('focus.bs3.button.data-api blur.bs3.button.data-api', '[data-toggle^=\"button\"]', function (e) {\n\t\t\t\t$(e.target).closest('.btn').toggleClass('focus', /^focus(in)?$/.test(e.type));\n\t\t\t});\n\n\t\t    // CAROUSEL DATA-API\n\t\t    // =================\n\t\t\t$('[data-ride=\"carousel\"]').each(function () {\n\t\t\t\t$this = $(this);\n\t\t\t\t$this.carousel($this.data());\n\t\t\t});\n\n            $(document).on(\"click.bs3.carousel.data-api\", \"[data-target][data-slide],[data-target][data-slide-to],[href][data-slide],[href][data-slide-to]\", function(e) {\n\t            var href\n\t            var $this = $(this)\n\t            var $target = $($this.attr('data-target') || (href = $this.attr('href')) && href.replace(/.*(?=#[^\\s]+$)/, '')) // strip for ie7\n\t            if (!$target.hasClass('carousel')) return\n\t            var options = langx.mixin({}, $target.data(), $this.data());\n\t            var slideIndex = $this.attr('data-slide-to')\n\t            if (slideIndex) options.interval = false\n\n\t            $target.carousel(options);\n\n\t            if (slideIndex) {\n\t                $target.plugin('bs3.carousel').to(slideIndex);\n\t            }\n\n\t            e.preventDefault();\n\n\t        });\n \n\t\t\t// COLLAPSE DATA-API\n\t\t\t// =================\n \t\t    $(document).on('click.bs3.collapse.data-api', '[data-target][data-toggle=\"collapse\"]', function (e) {\n\t\t\t    var $this   = $(this)\n\n\t\t\t    if (!$this.attr('data-target')) e.preventDefault()\n\n\t\t\t    var $target = getTargetFromTrigger($this)\n\t\t\t    var data    = $target.plugin('bs3.collapse')\n\t\t\t    var option  = data ? 'toggle' : $this.data()\n\n\t\t\t    $target.collapse(option);\n\t\t    });\n\n\t\t\t    // Dropdown DATA-API\n\t\t\t    // =================\n\t       \t$(document)\n\t        .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })\n\t        .on('click.bs.dropdown.data-api', '[data-toggle=\"dropdown\"]', Dropdown.prototype.toggle)\n\t        .on('keydown.bs.dropdown.data-api', '[data-toggle=\"dropdown\"]', Dropdown.prototype.keydown)\n\t        .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown);\n\n\n\t\t\t// MODAL DATA-API\n\t\t\t// ==============\n\t\t\t$(document).on('click.bs3.modal.data-api', '[data-toggle=\"modal\"]', function (e) {\n\t\t\t\tvar $this   = $(this)\n\t\t\t\tvar href    = $this.attr('href')\n\t\t\t\tvar $target = $($this.attr('data-target') || (href && href.replace(/.*(?=#[^\\s]+$)/, ''))) // strip for ie7\n\t\t\t\tvar option  = $target.data('bs3.modal') ? 'toggle' : langx.mixin({ remote: !/#/.test(href) && href }, $target.data(), $this.data())\n\n\t\t\t\tif ($this.is('a')) e.preventDefault()\n\n\t\t\t\t$target.one('show.bs3.modal', function (showEvent) {\n\t\t\t  \t\tif (showEvent.isDefaultPrevented()) return // only register focus restorer if modal will actually get shown\n\t\t\t  \t\t$target.one('hidden.bs3.modal', function () {\n\t\t\t    \t\t$this.is(':visible') && $this.trigger('focus')\n\t\t\t  \t\t})\n\t\t\t\t})\n\t\t\t\t$target.modal(option, this);\n\t\t\t});\n\n\t\t\t\t// SCROLLSPY DATA-API\n\t\t\t\t// ==================\n\t\t\t$('[data-spy=\"scroll\"]').each(function () {\n\t\t\t\tvar $spy = $(this)\n\t\t\t\t$spy.scrollspy($spy.data());\n\t\t\t});\n\n\t\t\t// TAB DATA-API\n\t\t\t// ============\n\n\t\t\tvar clickHandler = function (e) {\n\t\t\t    e.preventDefault()\n\t\t\t    $(this).tab('show');\n\t\t\t};\n\n\t\t\t$(document)\n\t\t\t.on('click.bs3.tab.data-api', '[data-toggle=\"tab\"]', clickHandler)\n\t\t\t.on('click.bs3.tab.data-api', '[data-toggle=\"pill\"]', clickHandler);\n\n\t\t  \t/**\n\t\t   \t* Initialize tagsinput behaviour on inputs and selects which have\n\t\t   \t* data-role=tagsinput\n\t\t   \t*/\n\n\t\t    $(\"input[data-role=tagsinput], select[multiple][data-role=tagsinput]\").tagsinput();\n\n  \t\t});\n\t};\n\n\treturn init;\n});\n\ndefine('skylark-bootstrap3/main',[\n    \"skylark-domx-query\",\n    \"./affix\",\n    \"./alert\",\n    \"./button\",\n    \"./carousel\",\n    \"./collapse\",\n    \"./dropdown\",\n    \"./modal\",\n    \"./popover\",\n    \"./scrollspy\",\n    \"./tab\",\n    \"./taginput\",\n    \"./tooltip\",\n    \"./transition\",\n    \"./loadedInit\"\n], function($) {\n    return $;\n});\ndefine('skylark-bootstrap3', ['skylark-bootstrap3/main'], function (main) { return main; });\n\ndefine('skylark-fuelux/fuelux',[\n  \"skylark-langx/skylark\",\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\"\n],function(skylark,langx,browser,eventer,noder,geom,$){\n\tvar ui = skylark.ui = skylark.ui || {}, \n\t\tfuelux = ui.fuelux = {};\n\n/*---------------------------------------------------------------------------------*/\n\t/*\n\t * Fuel UX utilities.js\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\tvar CONST = {\n\t\tBACKSPACE_KEYCODE: 8,\n\t\tCOMMA_KEYCODE: 188, // `,` & `<`\n\t\tDELETE_KEYCODE: 46,\n\t\tDOWN_ARROW_KEYCODE: 40,\n\t\tENTER_KEYCODE: 13,\n\t\tTAB_KEYCODE: 9,\n\t\tUP_ARROW_KEYCODE: 38\n\t};\n\n\tvar isShiftHeld = function isShiftHeld (e) { return e.shiftKey === true; };\n\n\tvar isKey = function isKey (keyCode) {\n\t\treturn function compareKeycodes (e) {\n\t\t\treturn e.keyCode === keyCode;\n\t\t};\n\t};\n\n\tvar isBackspaceKey = isKey(CONST.BACKSPACE_KEYCODE);\n\tvar isDeleteKey = isKey(CONST.DELETE_KEYCODE);\n\tvar isTabKey = isKey(CONST.TAB_KEYCODE);\n\tvar isUpArrow = isKey(CONST.UP_ARROW_KEYCODE);\n\tvar isDownArrow = isKey(CONST.DOWN_ARROW_KEYCODE);\n\n\tvar ENCODED_REGEX = /&[^\\s]*;/;\n\t/*\n\t * to prevent double encoding decodes content in loop until content is encoding free\n\t */\n\tvar cleanInput = function cleanInput (questionableMarkup) {\n\t\t// check for encoding and decode\n\t\twhile (ENCODED_REGEX.test(questionableMarkup)) {\n\t\t\tquestionableMarkup = $('<i>').html(questionableMarkup).text();\n\t\t}\n\n\t\t// string completely decoded now encode it\n\t\treturn $('<i>').text(questionableMarkup).html();\n\t};\n\n\n\n\n\tlangx.mixin(fuelux, {\n\t\tCONST: CONST,\n\t\tcleanInput: cleanInput,\n\t\tisBackspaceKey: isBackspaceKey,\n\t\tisDeleteKey: isDeleteKey,\n\t\tisShiftHeld: isShiftHeld,\n\t\tisTabKey: isTabKey,\n\t\tisUpArrow: isUpArrow,\n\t\tisDownArrow: isDownArrow\n\t});\n\n/*---------------------------------------------------------------------------------*/\n\n\tlangx.mixin(fuelux, {\n\t\tWidgetBase : langx.Evented\n\t});\n\n\treturn fuelux;\n});\n\ndefine('skylark-fuelux/checkbox',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\"\n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\tvar old = $.fn.checkbox;\n\n\t// CHECKBOX CONSTRUCTOR AND PROTOTYPE\n\n\tvar logError = function logError (error) {\n\t\tif (window && window.console && window.console.error) {\n\t\t\twindow.console.error(error);\n\t\t}\n\t};\n\n\n\tvar Checkbox = fuelux.Checkbox = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Checkbox\",\n\n\t\tinit : function(element,options) {\n\t\t\tthis.options = langx.mixin({}, $.fn.checkbox.defaults, options);\n\t\t\tvar $element = $(element);\n\n\t\t\tif (element.tagName.toLowerCase() !== 'label') {\n\t\t\t\tlogError('Checkbox must be initialized on the `label` that wraps the `input` element. See https://github.com/ExactTarget/fuelux/blob/master/reference/markup/checkbox.html for example of proper markup. Call `.checkbox()` on the `<label>` not the `<input>`');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// cache elements\n\t\t\tthis.$label = $element;\n\t\t\tthis.$chk = this.$label.find('input[type=\"checkbox\"]');\n\t\t\tthis.$container = $element.parent('.checkbox'); // the container div\n\n\t\t\tif (!this.options.ignoreVisibilityCheck && this.$chk.css('visibility').match(/hidden|collapse/)) {\n\t\t\t\tlogError('For accessibility reasons, in order for tab and space to function on checkbox, checkbox `<input />`\\'s `visibility` must not be set to `hidden` or `collapse`. See https://github.com/ExactTarget/fuelux/pull/1996 for more details.');\n\t\t\t}\n\n\t\t\t// determine if a toggle container is specified\n\t\t\tvar containerSelector = this.$chk.attr('data-toggle');\n\t\t\tthis.$toggleContainer = $(containerSelector);\n\n\t\t\t// handle internal events\n\t\t\tthis.$chk.on('change', langx.proxy(this.itemchecked, this));\n\n\t\t\t// set default state\n\t\t\tthis.setInitialState();\n\t\t},\n\n\t\tsetInitialState: function setInitialState () {\n\t\t\tvar $chk = this.$chk;\n\n\t\t\t// get current state of input\n\t\t\tvar checked = $chk.prop('checked');\n\t\t\tvar disabled = $chk.prop('disabled');\n\n\t\t\t// sync label class with input state\n\t\t\tthis.setCheckedState($chk, checked);\n\t\t\tthis.setDisabledState($chk, disabled);\n\t\t},\n\n\t\tsetCheckedState: function setCheckedState (element, checked) {\n\t\t\tvar $chk = element;\n\t\t\tvar $lbl = this.$label;\n\t\t\tvar $containerToggle = this.$toggleContainer;\n\n\t\t\tif (checked) {\n\t\t\t\t$chk.prop('checked', true);\n\t\t\t\t$lbl.addClass('checked');\n\t\t\t\t$containerToggle.removeClass('hide hidden');\n\t\t\t\t$lbl.trigger('checked.fu.checkbox');\n\t\t\t} else {\n\t\t\t\t$chk.prop('checked', false);\n\t\t\t\t$lbl.removeClass('checked');\n\t\t\t\t$containerToggle.addClass('hidden');\n\t\t\t\t$lbl.trigger('unchecked.fu.checkbox');\n\t\t\t}\n\n\t\t\t$lbl.trigger('changed.fu.checkbox', checked);\n\t\t},\n\n\t\tsetDisabledState: function setDisabledState (element, disabled) {\n\t\t\tvar $chk = $(element);\n\t\t\tvar $lbl = this.$label;\n\n\t\t\tif (disabled) {\n\t\t\t\t$chk.prop('disabled', true);\n\t\t\t\t$lbl.addClass('disabled');\n\t\t\t\t$lbl.trigger('disabled.fu.checkbox');\n\t\t\t} else {\n\t\t\t\t$chk.prop('disabled', false);\n\t\t\t\t$lbl.removeClass('disabled');\n\t\t\t\t$lbl.trigger('enabled.fu.checkbox');\n\t\t\t}\n\n\t\t\treturn $chk;\n\t\t},\n\n\t\titemchecked: function itemchecked (evt) {\n\t\t\tvar $chk = $(evt.target);\n\t\t\tvar checked = $chk.prop('checked');\n\n\t\t\tthis.setCheckedState($chk, checked);\n\t\t},\n\n\t\ttoggle: function toggle () {\n\t\t\tvar checked = this.isChecked();\n\n\t\t\tif (checked) {\n\t\t\t\tthis.uncheck();\n\t\t\t} else {\n\t\t\t\tthis.check();\n\t\t\t}\n\t\t},\n\n\t\tcheck: function check () {\n\t\t\tthis.setCheckedState(this.$chk, true);\n\t\t},\n\n\t\tuncheck: function uncheck () {\n\t\t\tthis.setCheckedState(this.$chk, false);\n\t\t},\n\n\t\tisChecked: function isChecked () {\n\t\t\tvar checked = this.$chk.prop('checked');\n\t\t\treturn checked;\n\t\t},\n\n\t\tenable: function enable () {\n\t\t\tthis.setDisabledState(this.$chk, false);\n\t\t},\n\n\t\tdisable: function disable () {\n\t\t\tthis.setDisabledState(this.$chk, true);\n\t\t},\n\n\t\tdestroy: function destroy () {\n\t\t\tthis.$label.remove();\n\t\t\treturn this.$label[0].outerHTML;\n\t\t}\n\t});\n\n\n\n\tCheckbox.prototype.getValue = Checkbox.prototype.isChecked;\n\n\t// CHECKBOX PLUGIN DEFINITION\n\n\t$.fn.checkbox = function checkbox (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function applyData () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.checkbox');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.checkbox', (data = new Checkbox(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.checkbox.defaults = {\n\t\tignoreVisibilityCheck: false\n\t};\n\n\t$.fn.checkbox.Constructor = Checkbox;\n\n\t$.fn.checkbox.noConflict = function noConflict () {\n\t\t$.fn.checkbox = old;\n\t\treturn this;\n\t};\n\n\t// DATA-API\n\n\t/*\n\t$(document).on('mouseover.fu.checkbox.data-api', '[data-initialize=checkbox]', function initializeCheckboxes (e) {\n\t\tvar $control = $(e.target);\n\t\tif (!$control.data('fu.checkbox')) {\n\t\t\t$control.checkbox($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function onReadyInitializeCheckboxes () {\n\t\t$('[data-initialize=checkbox]').each(function initializeCheckbox () {\n\t\t\tvar $this = $(this);\n\t\t\tif (!$this.data('fu.checkbox')) {\n\t\t\t\t$this.checkbox($this.data());\n\t\t\t}\n\t\t});\n\t});\n\t*/\n\n\treturn $.fn.checkbox;\n});\n\ndefine('skylark-fuelux/combobox',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\",\n  \"skylark-bootstrap3/dropdown\"  \n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\tvar old = $.fn.combobox;\n\n\n\t// COMBOBOX CONSTRUCTOR AND PROTOTYPE\n\n\tvar Combobox = fuelux.Combobox = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Combobox\",\n\n\t\tinit : function(element,options) {\n\t\t\tthis.$element = $(element);\n\t\t\tthis.options = langx.mixin({}, $.fn.combobox.defaults, options);\n\n\t\t\tthis.$dropMenu = this.$element.find('.dropdown-menu');\n\t\t\tthis.$input = this.$element.find('input');\n\t\t\tthis.$button = this.$element.find('.btn');\n\t\t\tthis.$button.dropdown();\n\t\t\tthis.$inputGroupBtn = this.$element.find('.input-group-btn');\n\n\t\t\tthis.$element.on('click.fu.combobox', 'a', langx.proxy(this.itemclicked, this));\n\t\t\tthis.$element.on('change.fu.combobox', 'input', langx.proxy(this.inputchanged, this));\n\t\t\tthis.$element.on('shown.bs.dropdown', langx.proxy(this.menuShown, this));\n\t\t\tthis.$input.on('keyup.fu.combobox', langx.proxy(this.keypress, this));\n\n\t\t\t// set default selection\n\t\t\tthis.setDefaultSelection();\n\n\t\t\t// if dropdown is empty, disable it\n\t\t\tvar items = this.$dropMenu.children('li');\n\t\t\tif( items.length === 0) {\n\t\t\t\tthis.$button.addClass('disabled');\n\t\t\t}\n\n\t\t\t// filter on load in case the first thing they do is press navigational key to pop open the menu\n\t\t\tif (this.options.filterOnKeypress) {\n\t\t\t\tthis.options.filter(this.$dropMenu.find('li'), this.$input.val(), this);\n\t\t\t}\n\t\t},\n\n\t\tdestroy: function () {\n\t\t\tthis.$element.remove();\n\t\t\t// remove any external bindings\n\t\t\t// [none]\n\n\t\t\t// set input value attrbute in markup\n\t\t\tthis.$element.find('input').each(function () {\n\t\t\t\t$(this).attr('value', $(this).val());\n\t\t\t});\n\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tdoSelect: function ($item) {\n\n\t\t\tif (typeof $item[0] !== 'undefined') {\n\t\t\t\t// remove selection from old item, may result in remove and\n\t\t\t\t// re-addition of class if item is the same\n\t\t\t\tthis.$element.find('li.selected:first').removeClass('selected');\n\n\t\t\t\t// add selection to new item\n\t\t\t\tthis.$selectedItem = $item;\n\t\t\t\tthis.$selectedItem.addClass('selected');\n\n\t\t\t\t// update input\n\t\t\t\tthis.$input.val(this.$selectedItem.text().trim());\n\t\t\t} else {\n\t\t\t\t// this is a custom input, not in the menu\n\t\t\t\tthis.$selectedItem = null;\n\t\t\t\tthis.$element.find('li.selected:first').removeClass('selected');\n\t\t\t}\n\t\t},\n\n\t\tclearSelection: function () {\n\t\t\tthis.$selectedItem = null;\n\t\t\tthis.$input.val('');\n\t\t\tthis.$dropMenu.find('li').removeClass('selected');\n\t\t},\n\n\t\tmenuShown: function () {\n\t\t\tif (this.options.autoResizeMenu) {\n\t\t\t\tthis.resizeMenu();\n\t\t\t}\n\t\t},\n\n\t\tresizeMenu: function () {\n\t\t\tvar width = this.$element.outerWidth();\n\t\t\tthis.$dropMenu.outerWidth(width);\n\t\t},\n\n\t\tselectedItem: function () {\n\t\t\tvar item = this.$selectedItem;\n\t\t\tvar data = {};\n\n\t\t\tif (item) {\n\t\t\t\tvar txt = this.$selectedItem.text().trim();\n\t\t\t\tdata = langx.mixin({\n\t\t\t\t\ttext: txt\n\t\t\t\t}, this.$selectedItem.data());\n\t\t\t} else {\n\t\t\t\tdata = {\n\t\t\t\t\ttext: this.$input.val().trim(),\n\t\t\t\t\tnotFound: true\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn data;\n\t\t},\n\n\t\tselectByText: function (text) {\n\t\t\tvar $item = $([]);\n\t\t\tthis.$element.find('li').each(function () {\n\t\t\t\tif ((this.textContent || this.innerText || $(this).text() || '').trim().toLowerCase() === (text || '').trim().toLowerCase()) {\n\t\t\t\t\t$item = $(this);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.doSelect($item);\n\t\t},\n\n\t\tselectByValue: function (value) {\n\t\t\tvar selector = 'li[data-value=\"' + value + '\"]';\n\t\t\tthis.selectBySelector(selector);\n\t\t},\n\n\t\tselectByIndex: function (index) {\n\t\t\t// zero-based index\n\t\t\tvar selector = 'li:eq(' + index + ')';\n\t\t\tthis.selectBySelector(selector);\n\t\t},\n\n\t\tselectBySelector: function (selector) {\n\t\t\tvar $item = this.$element.find(selector);\n\t\t\tthis.doSelect($item);\n\t\t},\n\n\t\tsetDefaultSelection: function () {\n\t\t\tvar selector = 'li[data-selected=true]:first';\n\t\t\tvar item = this.$element.find(selector);\n\n\t\t\tif (item.length > 0) {\n\t\t\t\t// select by data-attribute\n\t\t\t\tthis.selectBySelector(selector);\n\t\t\t\titem.removeData('selected');\n\t\t\t\titem.removeAttr('data-selected');\n\t\t\t}\n\t\t},\n\n\t\tenable: function () {\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$input.removeAttr('disabled');\n\t\t\tthis.$button.removeClass('disabled');\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$input.attr('disabled', true);\n\t\t\tthis.$button.addClass('disabled');\n\t\t},\n\n\t\titemclicked: function (e) {\n\t\t\tthis.$selectedItem = $(e.target).parent();\n\n\t\t\t// set input text and trigger input change event marked as synthetic\n\t\t\tthis.$input.val(this.$selectedItem.text().trim()).trigger('change', {\n\t\t\t\tsynthetic: true\n\t\t\t});\n\n\t\t\t// pass object including text and any data-attributes\n\t\t\t// to onchange event\n\t\t\tvar data = this.selectedItem();\n\n\t\t\t// trigger changed event\n\t\t\tthis.$element.trigger('changed.fu.combobox', data);\n\n\t\t\te.preventDefault();\n\n\t\t\t// return focus to control after selecting an option\n\t\t\tthis.$element.find('.dropdown-toggle').focus();\n\t\t},\n\n\t\tkeypress: function (e) {\n\t\t\tvar ENTER = 13;\n\t\t\t//var TAB = 9;\n\t\t\tvar ESC = 27;\n\t\t\tvar LEFT = 37;\n\t\t\tvar UP = 38;\n\t\t\tvar RIGHT = 39;\n\t\t\tvar DOWN = 40;\n\n\t\t\tvar IS_NAVIGATIONAL = (\n\t\t\t\te.which === UP ||\n\t\t\t\te.which === DOWN ||\n\t\t\t\te.which === LEFT ||\n\t\t\t\te.which === RIGHT\n\t\t\t);\n\n\t\t\tif(this.options.showOptionsOnKeypress && !this.$inputGroupBtn.hasClass('open')){\n\t\t\t\tthis.$button.dropdown('toggle');\n\t\t\t\tthis.$input.focus();\n\t\t\t}\n\n\t\t\tif (e.which === ENTER) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\tvar selected = this.$dropMenu.find('li.selected').text().trim();\n\t\t\t\tif(selected.length > 0){\n\t\t\t\t\tthis.selectByText(selected);\n\t\t\t\t}else{\n\t\t\t\t\tthis.selectByText(this.$input.val());\n\t\t\t\t}\n\n\t\t\t\tthis.$inputGroupBtn.removeClass('open');\n\t\t\t} else if (e.which === ESC) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.clearSelection();\n\t\t\t\tthis.$inputGroupBtn.removeClass('open');\n\t\t\t} else if (this.options.showOptionsOnKeypress) {\n\t\t\t\tif (e.which === DOWN || e.which === UP) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar $selected = this.$dropMenu.find('li.selected');\n\t\t\t\t\tif ($selected.length > 0) {\n\t\t\t\t\t\tif (e.which === DOWN) {\n\t\t\t\t\t\t\t$selected = $selected.next(':not(.hidden)');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$selected = $selected.prev(':not(.hidden)');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ($selected.length === 0){\n\t\t\t\t\t\tif (e.which === DOWN) {\n\t\t\t\t\t\t\t$selected = this.$dropMenu.find('li:not(.hidden):first');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$selected = this.$dropMenu.find('li:not(.hidden):last');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.doSelect($selected);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Avoid filtering on navigation key presses\n\t\t\tif (this.options.filterOnKeypress && !IS_NAVIGATIONAL) {\n\t\t\t\tthis.options.filter(this.$dropMenu.find('li'), this.$input.val(), this);\n\t\t\t}\n\n\t\t\tthis.previousKeyPress = e.which;\n\t\t},\n\n\t\tinputchanged: function (e, extra) {\n\t\t\tvar val = $(e.target).val();\n\t\t\t// skip processing for internally-generated synthetic event\n\t\t\t// to avoid double processing\n\t\t\tif (extra && extra.synthetic) {\n\t\t\t\tthis.selectByText(val);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.selectByText(val);\n\n\t\t\t// find match based on input\n\t\t\t// if no match, pass the input value\n\t\t\tvar data = this.selectedItem();\n\t\t\tif (data.text.length === 0) {\n\t\t\t\tdata = {\n\t\t\t\t\ttext: val\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// trigger changed event\n\t\t\tthis.$element.trigger('changed.fu.combobox', data);\n\t\t}\n\n\t});\n\n\n\n\tCombobox.prototype.getValue = Combobox.prototype.selectedItem;\n\n\t// COMBOBOX PLUGIN DEFINITION\n\n\t$.fn.combobox = function (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.combobox');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.combobox', (data = new Combobox(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.combobox.defaults = {\n\n\t\tautoResizeMenu: true,\n\t\tfilterOnKeypress: false,\n\t\tshowOptionsOnKeypress: false,\n\t\tfilter: function filter (list, predicate, self) {\n\t\t\tvar visible = 0;\n\t\t\tself.$dropMenu.find('.empty-indicator').remove();\n\n\t\t\tlist.each(function (i) {\n\t\t\t\tvar $li = $(this);\n\t\t\t\tvar text = $(this).text().trim();\n\n\t\t\t\t$li.removeClass();\n\n\t\t\t\tif (text === predicate) {\n\t\t\t\t\t$li.addClass('text-success');\n\t\t\t\t\tvisible++;\n\t\t\t\t} else if (text.substr(0, predicate.length) === predicate) {\n\t\t\t\t\t$li.addClass('text-info');\n\t\t\t\t\tvisible++;\n\t\t\t\t} else {\n\t\t\t\t\t$li.addClass('hidden');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (visible === 0) {\n\t\t\t\tself.$dropMenu.append('<li class=\"empty-indicator text-muted\"><em>No Matches</em></li>');\n\t\t\t}\n\t\t}\n\t};\n\n\t$.fn.combobox.Constructor =  Combobox;\n\n\t$.fn.combobox.noConflict = function () {\n\t\t$.fn.combobox = old;\n\t\treturn this;\n\t};\n\n\t// DATA-API\n\n\t/*\n\n\t$(document).on('mousedown.fu.combobox.data-api', '[data-initialize=combobox]', function (e) {\n\t\tvar $control = $(e.target).closest('.combobox');\n\t\tif (!$control.data('fu.combobox')) {\n\t\t\t$control.combobox($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function () {\n\t\t$('[data-initialize=combobox]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif (!$this.data('fu.combobox')) {\n\t\t\t\t$this.combobox($this.data());\n\t\t\t}\n\t\t});\n\t});\n\t*/\n\n\treturn $.fn.combobox;\n});\n\ndefine('skylark-fuelux/datepicker',[\n    \"skylark-langx/langx\",\n    \"skylark-domx/browser\",\n    \"skylark-domx/eventer\",\n    \"skylark-domx/noder\",\n    \"skylark-domx/geom\",\n    \"skylark-domx/query\",\n    \"./fuelux\",\n    \"skylark-bootstrap3/dropdown\"  \n], function(langx, browser, eventer, noder, geom, $, fuelux) {\n\n\n    /*\n     * Fuel UX Checkbox\n     * https://github.com/ExactTarget/fuelux\n     *\n     * Copyright (c) 2014 ExactTarget\n     * Licensed under the BSD New license.\n     */\n\n    var INVALID_DATE = 'Invalid Date';\n    var MOMENT_NOT_AVAILABLE = 'moment.js is not available so you cannot use this function';\n\n    var datepickerStack = [];\n    var moment = false;\n    var old = $.fn.datepicker;\n    var requestedMoment = false;\n\n    var runStack = function() {\n        var i, l;\n        requestedMoment = true;\n        for (i = 0, l = datepickerStack.length; i < l; i++) {\n            datepickerStack[i].init.call(datepickerStack[i].scope);\n        }\n        datepickerStack = [];\n    };\n\n    /*\n    \t//only load moment if it's there. otherwise we'll look for it in window.moment\n    \tif (typeof define === 'function' && define.amd) {//check if AMD is available\n    \t\trequire(['moment'], function (amdMoment) {\n    \t\t\tmoment = amdMoment;\n    \t\t\trunStack();\n    \t\t}, function (err) {\n    \t\t\t\tvar failedId = err.requireModules && err.requireModules[0];\n    \t\t\t\tif (failedId === 'moment') {\n    \t\t\t\t\trunStack();\n    \t\t\t\t}\n    \t\t\t});\n    \t} else {\n    \t\trunStack();\n    \t}\n    */\n    // DATEPICKER CONSTRUCTOR AND PROTOTYPE\n\n    var Datepicker = fuelux.Datepicker = fuelux.WidgetBase.inherit({\n        klassName: \"Datepicker\",\n\n        init: function(element, options) {\n            this.$element = $(element);\n            this.options = langx.mixin({}, $.fn.datepicker.defaults, options);\n\n            this.$calendar = this.$element.find('.datepicker-calendar');\n            this.$days = this.$calendar.find('.datepicker-calendar-days');\n            this.$header = this.$calendar.find('.datepicker-calendar-header');\n            this.$headerTitle = this.$header.find('.title');\n            this.$input = this.$element.find('input');\n            this.$inputGroupBtn = this.$element.find('.input-group-btn');\n            this.$wheels = this.$element.find('.datepicker-wheels');\n            this.$wheelsMonth = this.$element.find('.datepicker-wheels-month');\n            this.$wheelsYear = this.$element.find('.datepicker-wheels-year');\n            this.$dropdown = this.$element.find('[data-toggle=\"dropdown\"]');\n            this.$dropdown.dropdown();\n\n            this.artificialScrolling = false;\n            this.formatDate = this.options.formatDate || this.formatDate;\n            this.inputValue = null;\n            this.moment = false;\n            this.momentFormat = null;\n            this.parseDate = this.options.parseDate || this.parseDate;\n            this.preventBlurHide = false;\n            this.restricted = this.options.restricted || [];\n            this.restrictedParsed = [];\n            this.restrictedText = this.options.restrictedText;\n            this.sameYearOnly = this.options.sameYearOnly;\n            this.selectedDate = null;\n            this.yearRestriction = null;\n\n            this.$calendar.find('.datepicker-today').on('click.fu.datepicker', langx.proxy(this.todayClicked, this));\n            this.$days.on('click.fu.datepicker', 'tr td button', langx.proxy(this.dateClicked, this));\n            this.$header.find('.next').on('click.fu.datepicker', langx.proxy(this.next, this));\n            this.$header.find('.prev').on('click.fu.datepicker', langx.proxy(this.prev, this));\n            this.$headerTitle.on('click.fu.datepicker', langx.proxy(this.titleClicked, this));\n            this.$input.on('change.fu.datepicker', langx.proxy(this.inputChanged, this));\n            this.$input.on('mousedown.fu.datepicker', langx.proxy(this.showDropdown, this));\n            this.$inputGroupBtn.on('hidden.bs.dropdown', langx.proxy(this.hide, this));\n            this.$inputGroupBtn.on('shown.bs.dropdown', langx.proxy(this.show, this));\n            this.$wheels.find('.datepicker-wheels-back').on('click.fu.datepicker', langx.proxy(this.backClicked, this));\n            this.$wheels.find('.datepicker-wheels-select').on('click.fu.datepicker', langx.proxy(this.selectClicked, this));\n            this.$wheelsMonth.on('click.fu.datepicker', 'ul button', langx.proxy(this.monthClicked, this));\n            this.$wheelsYear.on('click.fu.datepicker', 'ul button', langx.proxy(this.yearClicked, this));\n            this.$wheelsYear.find('ul').on('scroll.fu.datepicker', langx.proxy(this.onYearScroll, this));\n\n            this.$element.on('click.fu.datepicker.data-api', '.datepicker input', function(e) {\n                e.stopPropagation();\n            });\n\n            this.$element.on('click.fu.datepicker.data-api', '.datepicker .dropdown-menu', function(e) {\n                var $target = $(e.target);\n                if (!$target.is('.datepicker-date') || $target.closest('.restricted').length) {\n                    e.stopPropagation();\n                }\n            });\n\n            var init = function() {\n                if (this.checkForMomentJS()) {\n                    moment = moment || window.moment; // need to pull in the global moment if they didn't do it via require\n                    this.moment = true;\n                    this.momentFormat = this.options.momentConfig.format;\n                    this.setCulture(this.options.momentConfig.culture);\n\n                    // support moment with lang (< v2.8) or locale\n                    moment.locale = moment.locale || moment.lang;\n                }\n\n                this.setRestrictedDates(this.restricted);\n                if (!this.setDate(this.options.date)) {\n                    this.$input.val('');\n                    this.inputValue = this.$input.val();\n                }\n\n                if (this.sameYearOnly) {\n                    this.yearRestriction = (this.selectedDate) ? this.selectedDate.getFullYear() : new Date().getFullYear();\n                }\n            };\n\n            if (requestedMoment) {\n                init.call(this);\n            } else {\n                datepickerStack.push({\n                    init: init,\n                    scope: this\n                });\n            }\n        },\n\n        backClicked: function() {\n            this.changeView('calendar');\n        },\n\n        changeView: function(view, date) {\n            if (view === 'wheels') {\n                this.$calendar.hide().attr('aria-hidden', 'true');\n                this.$wheels.show().removeAttr('aria-hidden', '');\n                if (date) {\n                    this.renderWheel(date);\n                }\n\n            } else {\n                this.$wheels.hide().attr('aria-hidden', 'true');\n                this.$calendar.show().removeAttr('aria-hidden', '');\n                if (date) {\n                    this.renderMonth(date);\n                }\n\n            }\n        },\n\n        checkForMomentJS: function() {\n            if (\n                ($.isFunction(window.moment) || (typeof moment !== 'undefined' && $.isFunction(moment))) &&\n                $.isPlainObject(this.options.momentConfig) &&\n                (typeof this.options.momentConfig.culture === 'string' && typeof this.options.momentConfig.format === 'string')\n            ) {\n                return true;\n            } else {\n                return false;\n            }\n        },\n\n        dateClicked: function(e) {\n            var $td = $(e.currentTarget).parents('td').first();\n            var date;\n\n            if ($td.hasClass('restricted')) {\n                return;\n            }\n\n            this.$days.find('td.selected').removeClass('selected');\n            $td.addClass('selected');\n\n            date = new Date($td.attr('data-year'), $td.attr('data-month'), $td.attr('data-date'));\n            this.selectedDate = date;\n            this.$input.val(this.formatDate(date));\n            this.inputValue = this.$input.val();\n            this.hide();\n            this.$input.focus();\n            this.$element.trigger('dateClicked.fu.datepicker', date);\n        },\n\n        destroy: function() {\n            this.$element.remove();\n            // any external bindings\n            // [none]\n\n            // empty elements to return to original markup\n            this.$days.find('tbody').empty();\n            this.$wheelsYear.find('ul').empty();\n\n            return this.$element[0].outerHTML;\n        },\n\n        disable: function() {\n            this.$element.addClass('disabled');\n            this.$element.find('input, button').attr('disabled', 'disabled');\n            this.$inputGroupBtn.removeClass('open');\n        },\n\n        enable: function() {\n            this.$element.removeClass('disabled');\n            this.$element.find('input, button').removeAttr('disabled');\n        },\n\n        formatDate: function(date) {\n            var padTwo = function(value) {\n                var s = '0' + value;\n                return s.substr(s.length - 2);\n            };\n\n            if (this.moment) {\n                return moment(date).format(this.momentFormat);\n            } else {\n                return padTwo(date.getMonth() + 1) + '/' + padTwo(date.getDate()) + '/' + date.getFullYear();\n            }\n        },\n\n        getCulture: function() {\n            if (this.moment) {\n                return moment.locale();\n            } else {\n                throw MOMENT_NOT_AVAILABLE;\n            }\n        },\n\n        getDate: function() {\n            return (!this.selectedDate) ? new Date(NaN) : this.selectedDate;\n        },\n\n        getFormat: function() {\n            if (this.moment) {\n                return this.momentFormat;\n            } else {\n                throw MOMENT_NOT_AVAILABLE;\n            }\n        },\n\n        getFormattedDate: function() {\n            return (!this.selectedDate) ? INVALID_DATE : this.formatDate(this.selectedDate);\n        },\n\n        getRestrictedDates: function() {\n            return this.restricted;\n        },\n\n        inputChanged: function() {\n            var inputVal = this.$input.val();\n            var date;\n            if (inputVal !== this.inputValue) {\n                date = this.setDate(inputVal);\n                if (date === null) {\n                    this.$element.trigger('inputParsingFailed.fu.datepicker', inputVal);\n                } else if (date === false) {\n                    this.$element.trigger('inputRestrictedDate.fu.datepicker', date);\n                } else {\n                    this.$element.trigger('changed.fu.datepicker', date);\n                }\n\n            }\n        },\n\n        show: function() {\n            var date = (this.selectedDate) ? this.selectedDate : new Date();\n            this.changeView('calendar', date);\n            this.$inputGroupBtn.addClass('open');\n            this.$element.trigger('shown.fu.datepicker');\n        },\n\n        showDropdown: function(e) { //input mousedown handler, name retained for legacy support of showDropdown\n            if (!this.$input.is(':focus') && !this.$inputGroupBtn.hasClass('open')) {\n                this.show();\n            }\n        },\n\n        hide: function() {\n            this.$inputGroupBtn.removeClass('open');\n            this.$element.trigger('hidden.fu.datepicker');\n        },\n\n        hideDropdown: function() { //for legacy support of hideDropdown\n            this.hide();\n        },\n\n        isInvalidDate: function(date) {\n            var dateString = date.toString();\n            if (dateString === INVALID_DATE || dateString === 'NaN') {\n                return true;\n            }\n\n            return false;\n        },\n\n        isRestricted: function(date, month, year) {\n            var restricted = this.restrictedParsed;\n            var i, from, l, to;\n\n            if (this.sameYearOnly && this.yearRestriction !== null && year !== this.yearRestriction) {\n                return true;\n            }\n\n            for (i = 0, l = restricted.length; i < l; i++) {\n                from = restricted[i].from;\n                to = restricted[i].to;\n                if (\n                    (year > from.year || (year === from.year && month > from.month) || (year === from.year && month === from.month && date >= from.date)) &&\n                    (year < to.year || (year === to.year && month < to.month) || (year === to.year && month === to.month && date <= to.date))\n                ) {\n                    return true;\n                }\n\n            }\n\n            return false;\n        },\n\n        monthClicked: function(e) {\n            this.$wheelsMonth.find('.selected').removeClass('selected');\n            $(e.currentTarget).parent().addClass('selected');\n        },\n\n        next: function() {\n            var month = this.$headerTitle.attr('data-month');\n            var year = this.$headerTitle.attr('data-year');\n            month++;\n            if (month > 11) {\n                if (this.sameYearOnly) {\n                    return;\n                }\n\n                month = 0;\n                year++;\n            }\n\n            this.renderMonth(new Date(year, month, 1));\n        },\n\n        onYearScroll: function(e) {\n            if (this.artificialScrolling) {\n                return;\n            }\n\n            var $yearUl = $(e.currentTarget);\n            var height = ($yearUl.css('box-sizing') === 'border-box') ? $yearUl.outerHeight() : $yearUl.height();\n            var scrollHeight = $yearUl.get(0).scrollHeight;\n            var scrollTop = $yearUl.scrollTop();\n            var bottomPercentage = (height / (scrollHeight - scrollTop)) * 100;\n            var topPercentage = (scrollTop / scrollHeight) * 100;\n            var i, start;\n\n            if (topPercentage < 5) {\n                start = parseInt($yearUl.find('li:first').attr('data-year'), 10);\n                for (i = (start - 1); i > (start - 11); i--) {\n                    $yearUl.prepend('<li data-year=\"' + i + '\"><button type=\"button\">' + i + '</button></li>');\n                }\n                this.artificialScrolling = true;\n                $yearUl.scrollTop(($yearUl.get(0).scrollHeight - scrollHeight) + scrollTop);\n                this.artificialScrolling = false;\n            } else if (bottomPercentage > 90) {\n                start = parseInt($yearUl.find('li:last').attr('data-year'), 10);\n                for (i = (start + 1); i < (start + 11); i++) {\n                    $yearUl.append('<li data-year=\"' + i + '\"><button type=\"button\">' + i + '</button></li>');\n                }\n            }\n        },\n\n        //some code ripped from http://stackoverflow.com/questions/2182246/javascript-dates-in-ie-nan-firefox-chrome-ok\n        parseDate: function(date) {\n            var self = this;\n            var BAD_DATE = new Date(NaN);\n            var dt, isoExp, momentParse, momentParseWithFormat, tryMomentParseAll, month, parts, use;\n\n            if (date) {\n                if (this.moment) { //if we have moment, use that to parse the dates\n                    momentParseWithFormat = function(d) {\n                        var md = moment(d, self.momentFormat);\n                        return (true === md.isValid()) ? md.toDate() : BAD_DATE;\n                    };\n                    momentParse = function(d) {\n                        var md = moment(new Date(d));\n                        return (true === md.isValid()) ? md.toDate() : BAD_DATE;\n                    };\n\n                    tryMomentParseAll = function(rawDateString, parseFunc1, parseFunc2) {\n                        var pd = parseFunc1(rawDateString);\n                        if (!self.isInvalidDate(pd)) {\n                            return pd;\n                        }\n\n                        pd = parseFunc2(rawDateString);\n                        if (!self.isInvalidDate(pd)) {\n                            return pd;\n                        }\n\n                        return BAD_DATE;\n                    };\n\n                    if ('string' === typeof(date)) {\n                        // Attempts to parse date strings using this.momentFormat, falling back on newing a date\n                        return tryMomentParseAll(date, momentParseWithFormat, momentParse);\n                    } else {\n                        // Attempts to parse date by newing a date object directly, falling back on parsing using this.momentFormat\n                        return tryMomentParseAll(date, momentParse, momentParseWithFormat);\n                    }\n\n                } else { //if moment isn't present, use previous date parsing strategy\n                    if (typeof(date) === 'string') {\n                        dt = new Date(Date.parse(date));\n                        if (!this.isInvalidDate(dt)) {\n                            return dt;\n                        } else {\n                            date = date.split('T')[0];\n                            isoExp = /^\\s*(\\d{4})-(\\d\\d)-(\\d\\d)\\s*$/;\n                            parts = isoExp.exec(date);\n                            if (parts) {\n                                month = parseInt(parts[2], 10);\n                                dt = new Date(parts[1], month - 1, parts[3]);\n                                if (month === (dt.getMonth() + 1)) {\n                                    return dt;\n                                }\n\n                            }\n\n                        }\n\n                    } else {\n                        dt = new Date(date);\n                        if (!this.isInvalidDate(dt)) {\n                            return dt;\n                        }\n\n                    }\n\n                }\n\n            }\n\n            return new Date(NaN);\n        },\n\n        prev: function() {\n            var month = this.$headerTitle.attr('data-month');\n            var year = this.$headerTitle.attr('data-year');\n            month--;\n            if (month < 0) {\n                if (this.sameYearOnly) {\n                    return;\n                }\n\n                month = 11;\n                year--;\n            }\n\n            this.renderMonth(new Date(year, month, 1));\n        },\n\n        renderMonth: function(date) {\n            date = date || new Date();\n\n            var firstDay = new Date(date.getFullYear(), date.getMonth(), 1).getDay();\n            var lastDate = new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();\n            var lastMonthDate = new Date(date.getFullYear(), date.getMonth(), 0).getDate();\n            var $month = this.$headerTitle.find('.month');\n            var month = date.getMonth();\n            var now = new Date();\n            var nowDate = now.getDate();\n            var nowMonth = now.getMonth();\n            var nowYear = now.getFullYear();\n            var selected = this.selectedDate;\n            var $tbody = this.$days.find('tbody');\n            var year = date.getFullYear();\n            var curDate, curMonth, curYear, i, j, rows, stage, previousStage, lastStage, $td, $tr;\n\n            if (selected) {\n                selected = {\n                    date: selected.getDate(),\n                    month: selected.getMonth(),\n                    year: selected.getFullYear()\n                };\n            }\n\n            $month.find('.current').removeClass('current');\n            $month.find('span[data-month=\"' + month + '\"]').addClass('current');\n            this.$headerTitle.find('.year').text(year);\n            this.$headerTitle.attr({\n                'data-month': month,\n                'data-year': year\n            });\n\n\n            $tbody.empty();\n            if (firstDay !== 0) {\n                curDate = lastMonthDate - firstDay + 1;\n                stage = -1;\n            } else {\n                curDate = 1;\n                stage = 0;\n            }\n\n            rows = (lastDate <= (35 - firstDay)) ? 5 : 6;\n            for (i = 0; i < rows; i++) {\n                $tr = $('<tr></tr>');\n                for (j = 0; j < 7; j++) {\n                    $td = $('<td></td>');\n                    if (stage === -1) {\n                        $td.addClass('last-month');\n                        if (previousStage !== stage) {\n                            $td.addClass('first');\n                        }\n                    } else if (stage === 1) {\n                        $td.addClass('next-month');\n                        if (previousStage !== stage) {\n                            $td.addClass('first');\n                        }\n                    }\n\n                    curMonth = month + stage;\n                    curYear = year;\n                    if (curMonth < 0) {\n                        curMonth = 11;\n                        curYear--;\n                    } else if (curMonth > 11) {\n                        curMonth = 0;\n                        curYear++;\n                    }\n\n                    $td.attr({\n                        'data-date': curDate,\n                        'data-month': curMonth,\n                        'data-year': curYear\n                    });\n                    if (curYear === nowYear && curMonth === nowMonth && curDate === nowDate) {\n                        $td.addClass('current-day');\n                    } else if (curYear < nowYear || (curYear === nowYear && curMonth < nowMonth) ||\n                        (curYear === nowYear && curMonth === nowMonth && curDate < nowDate)) {\n                        $td.addClass('past');\n                        if (!this.options.allowPastDates) {\n                            $td.addClass('restricted').attr('title', this.restrictedText);\n                        }\n\n                    }\n\n                    if (this.isRestricted(curDate, curMonth, curYear)) {\n                        $td.addClass('restricted').attr('title', this.restrictedText);\n                    }\n\n                    if (selected && curYear === selected.year && curMonth === selected.month && curDate === selected.date) {\n                        $td.addClass('selected');\n                    }\n\n                    if ($td.hasClass('restricted')) {\n                        $td.html('<span><b class=\"datepicker-date\">' + curDate + '</b></span>');\n                    } else {\n                        $td.html('<span><button type=\"button\" class=\"datepicker-date\">' + curDate + '</button></span>');\n                    }\n\n                    curDate++;\n                    lastStage = previousStage;\n                    previousStage = stage;\n                    if (stage === -1 && curDate > lastMonthDate) {\n                        curDate = 1;\n                        stage = 0;\n                        if (lastStage !== stage) {\n                            $td.addClass('last');\n                        }\n                    } else if (stage === 0 && curDate > lastDate) {\n                        curDate = 1;\n                        stage = 1;\n                        if (lastStage !== stage) {\n                            $td.addClass('last');\n                        }\n                    }\n                    if (i === (rows - 1) && j === 6) {\n                        $td.addClass('last');\n                    }\n\n                    $tr.append($td);\n                }\n                $tbody.append($tr);\n            }\n        },\n\n        renderWheel: function(date) {\n            var month = date.getMonth();\n            var $monthUl = this.$wheelsMonth.find('ul');\n            var year = date.getFullYear();\n            var $yearUl = this.$wheelsYear.find('ul');\n            var i, $monthSelected, $yearSelected;\n\n            if (this.sameYearOnly) {\n                this.$wheelsMonth.addClass('full');\n                this.$wheelsYear.addClass('hidden');\n            } else {\n                this.$wheelsMonth.removeClass('full');\n                this.$wheelsYear.removeClass('hide hidden'); // .hide is deprecated\n            }\n\n            $monthUl.find('.selected').removeClass('selected');\n            $monthSelected = $monthUl.find('li[data-month=\"' + month + '\"]');\n            $monthSelected.addClass('selected');\n            $monthUl.scrollTop($monthUl.scrollTop() + ($monthSelected.position().top - $monthUl.outerHeight() / 2 - $monthSelected.outerHeight(true) / 2));\n\n            $yearUl.empty();\n            for (i = (year - 10); i < (year + 11); i++) {\n                $yearUl.append('<li data-year=\"' + i + '\"><button type=\"button\">' + i + '</button></li>');\n            }\n            $yearSelected = $yearUl.find('li[data-year=\"' + year + '\"]');\n            $yearSelected.addClass('selected');\n            this.artificialScrolling = true;\n            $yearUl.scrollTop($yearUl.scrollTop() + ($yearSelected.position().top - $yearUl.outerHeight() / 2 - $yearSelected.outerHeight(true) / 2));\n            this.artificialScrolling = false;\n            $monthSelected.find('button').focus();\n        },\n\n        selectClicked: function() {\n            var month = this.$wheelsMonth.find('.selected').attr('data-month');\n            var year = this.$wheelsYear.find('.selected').attr('data-year');\n            this.changeView('calendar', new Date(year, month, 1));\n        },\n\n        setCulture: function(cultureCode) {\n            if (!cultureCode) {\n                return false;\n            }\n\n            if (this.moment) {\n                moment.locale(cultureCode);\n            } else {\n                throw MOMENT_NOT_AVAILABLE;\n            }\n        },\n\n        setDate: function(date) {\n            var parsed = this.parseDate(date);\n            if (!this.isInvalidDate(parsed)) {\n                if (!this.isRestricted(parsed.getDate(), parsed.getMonth(), parsed.getFullYear())) {\n                    this.selectedDate = parsed;\n                    this.renderMonth(parsed);\n                    this.$input.val(this.formatDate(parsed));\n                } else {\n                    this.selectedDate = false;\n                    this.renderMonth();\n                }\n\n            } else {\n                this.selectedDate = null;\n                this.renderMonth();\n            }\n\n            this.inputValue = this.$input.val();\n            return this.selectedDate;\n        },\n\n        setFormat: function(format) {\n            if (!format) {\n                return false;\n            }\n\n            if (this.moment) {\n                this.momentFormat = format;\n            } else {\n                throw MOMENT_NOT_AVAILABLE;\n            }\n        },\n\n        setRestrictedDates: function(restricted) {\n            var parsed = [];\n            var self = this;\n            var i, l;\n\n            var parseItem = function(val) {\n                if (val === -Infinity) {\n                    return {\n                        date: -Infinity,\n                        month: -Infinity,\n                        year: -Infinity\n                    };\n                } else if (val === Infinity) {\n                    return {\n                        date: Infinity,\n                        month: Infinity,\n                        year: Infinity\n                    };\n                } else {\n                    val = self.parseDate(val);\n                    return {\n                        date: val.getDate(),\n                        month: val.getMonth(),\n                        year: val.getFullYear()\n                    };\n                }\n            };\n\n            this.restricted = restricted;\n            for (i = 0, l = restricted.length; i < l; i++) {\n                parsed.push({\n                    from: parseItem(restricted[i].from),\n                    to: parseItem(restricted[i].to)\n                });\n            }\n            this.restrictedParsed = parsed;\n        },\n\n        titleClicked: function(e) {\n            this.changeView('wheels', new Date(this.$headerTitle.attr('data-year'), this.$headerTitle.attr('data-month'), 1));\n        },\n\n        todayClicked: function(e) {\n            var date = new Date();\n\n            if ((date.getMonth() + '') !== this.$headerTitle.attr('data-month') || (date.getFullYear() + '') !== this.$headerTitle.attr('data-year')) {\n                this.renderMonth(date);\n            }\n        },\n\n        yearClicked: function(e) {\n            this.$wheelsYear.find('.selected').removeClass('selected');\n            $(e.currentTarget).parent().addClass('selected');\n        }\n\n    });\n\n    //for control library consistency\n    Datepicker.prototype.getValue = Datepicker.prototype.getDate;\n\n    // DATEPICKER PLUGIN DEFINITION\n\n    $.fn.datepicker = function(option) {\n        var args = Array.prototype.slice.call(arguments, 1);\n        var methodReturn;\n\n        var $set = this.each(function() {\n            var $this = $(this);\n            var data = $this.data('fu.datepicker');\n            var options = typeof option === 'object' && option;\n\n            if (!data) {\n                $this.data('fu.datepicker', (data = new Datepicker(this, options)));\n            }\n\n            if (typeof option === 'string') {\n                methodReturn = data[option].apply(data, args);\n            }\n        });\n\n        return (methodReturn === undefined) ? $set : methodReturn;\n    };\n\n    $.fn.datepicker.defaults = {\n        allowPastDates: false,\n        date: new Date(),\n        formatDate: null,\n        momentConfig: {\n            culture: 'en',\n            format: 'L' // more formats can be found here http://momentjs.com/docs/#/customization/long-date-formats/.\n        },\n        parseDate: null,\n        restricted: [], //accepts an array of objects formatted as so: { from: {{date}}, to: {{date}} }  (ex: [ { from: new Date('12/11/2014'), to: new Date('03/31/2015') } ])\n        restrictedText: 'Restricted',\n        sameYearOnly: false\n    };\n\n    $.fn.datepicker.Constructor = Datepicker;\n\n    $.fn.datepicker.noConflict = function() {\n        $.fn.datepicker = old;\n        return this;\n    };\n\n    // DATA-API\n\n    /*\n    $(document).on('mousedown.fu.datepicker.data-api', '[data-initialize=datepicker]', function (e) {\n    \tvar $control = $(e.target).closest('.datepicker');\n    \tif (!$control.data('datepicker')) {\n    \t\t$control.datepicker($control.data());\n    \t}\n    });\n\n    //used to prevent the dropdown from closing when clicking within it's bounds\n    $(document).on('click.fu.datepicker.data-api', '.datepicker .dropdown-menu', function (e) {\n    \tvar $target = $(e.target);\n    \tif (!$target.is('.datepicker-date') || $target.closest('.restricted').length) {\n    \t\te.stopPropagation();\n    \t}\n    });\n\n    //used to prevent the dropdown from closing when clicking on the input\n    $(document).on('click.fu.datepicker.data-api', '.datepicker input', function (e) {\n    \te.stopPropagation();\n    });\n\n    $(function () {\n    \t$('[data-initialize=datepicker]').each(function () {\n    \t\tvar $this = $(this);\n    \t\tif ($this.data('datepicker')) {\n    \t\t\treturn;\n    \t\t}\n\n    \t\t$this.datepicker($this.data());\n    \t});\n    });\n    */\n\n    return $.fn.datepicker;\n});\ndefine('skylark-fuelux/dropdown-autoflip',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\",\n  \"skylark-bootstrap3/dropdown\"    \n],function(langx,browser,eventer,noder,geom,$){\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\t$(document).on('click.fu.dropdown-autoflip', '[data-toggle=dropdown][data-flip]', function (event) {\n\t\tif ($(this).data().flip === \"auto\") {\n\t\t\t// have the drop down decide where to place itself\n\t\t\t_autoFlip($(this).next('.dropdown-menu'));\n\t\t}\n\t});\n\n\t// For pillbox suggestions dropdown\n\t$(document).on('suggested.fu.pillbox', function (event, element) {\n\t\t_autoFlip($(element));\n\t\t$(element).parent().addClass('open');\n\t});\n\n\tfunction _autoFlip(menu) {\n\t\t// hide while the browser thinks\n\t\t$(menu).css({\n\t\t\tvisibility: \"hidden\"\n\t\t});\n\n\t\t// decide where to put menu\n\t\tif (dropUpCheck(menu)) {\n\t\t\tmenu.parent().addClass(\"dropup\");\n\t\t} else {\n\t\t\tmenu.parent().removeClass(\"dropup\");\n\t\t}\n\n\t\t// show again\n\t\t$(menu).css({\n\t\t\tvisibility: \"visible\"\n\t\t});\n\t}\n\n\tfunction dropUpCheck(element) {\n\t\t// caching container\n\t\tvar $container = _getContainer(element);\n\n\t\t// building object with measurementsances for later use\n\t\tvar measurements = {};\n\t\tmeasurements.parentHeight = element.parent().outerHeight();\n\t\tmeasurements.parentOffsetTop = element.parent().offset().top;\n\t\tmeasurements.dropdownHeight = element.outerHeight();\n\t\tmeasurements.containerHeight = $container.overflowElement.outerHeight();\n\n\t\t// this needs to be different if the window is the container or another element is\n\t\tmeasurements.containerOffsetTop = (!!$container.isWindow) ? $container.overflowElement.scrollTop() : $container.overflowElement.offset().top;\n\n\t\t// doing the calculations\n\t\tmeasurements.fromTop = measurements.parentOffsetTop - measurements.containerOffsetTop;\n\t\tmeasurements.fromBottom = measurements.containerHeight - measurements.parentHeight - (measurements.parentOffsetTop - measurements.containerOffsetTop);\n\n\t\t// actual determination of where to put menu\n\t\t// false = drop down\n\t\t// true = drop up\n\t\tif (measurements.dropdownHeight < measurements.fromBottom) {\n\t\t\treturn false;\n\t\t} else if (measurements.dropdownHeight < measurements.fromTop) {\n\t\t\treturn true;\n\t\t} else if (measurements.dropdownHeight >= measurements.fromTop && measurements.dropdownHeight >= measurements.fromBottom) {\n\t\t\t// decide which one is bigger and put it there\n\t\t\tif (measurements.fromTop >= measurements.fromBottom) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction _getContainer(element) {\n\t\tvar targetSelector = element.attr('data-target');\n\t\tvar isWindow = true;\n\t\tvar containerElement;\n\n\t\tif(!targetSelector) {\n\t\t\t// no selection so find the relevant ancestor\n\t\t\tlangx.each(element.parents(), function (index, parentElement) {\n\t\t\t\tif ($(parentElement).css('overflow') !== 'visible') {\n\t\t\t\t\tcontainerElement = parentElement;\n\t\t\t\t\tisWindow = false;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (targetSelector !== 'window') {\n\t\t\tcontainerElement = $(targetSelector);\n\t\t\tisWindow = false;\n\t\t}\n\n\t\t// fallback to window\n\t\tif (isWindow) {\n\t\t\tcontainerElement = window;\n\t\t}\n\n\t\treturn {\n\t\t\t\toverflowElement: $(containerElement),\n\t\t\t\tisWindow: isWindow\n\t\t};\n\t}\n\n\t// register empty plugin\n\t$.fn.dropdownautoflip = function () {\n\t\t/* empty */\n\t};\n\t\n\n});\n\ndefine('skylark-fuelux/infinite-scroll',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\"\n],function(langx,browser,eventer,noder,geom,$){\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\tvar old = $.fn.infinitescroll;\n\n\t// INFINITE SCROLL CONSTRUCTOR AND PROTOTYPE\n\n\tvar InfiniteScroll = function (element, options) {\n\t\tthis.$element = $(element);\n\t\tthis.$element.addClass('infinitescroll');\n\t\tthis.options = langx.mixin({}, $.fn.infinitescroll.defaults, options);\n\n\t\tthis.curScrollTop = this.$element.scrollTop();\n\t\tthis.curPercentage = this.getPercentage();\n\t\tthis.fetchingData = false;\n\n\t\tthis.$element.on('scroll.fu.infinitescroll', langx.proxy(this.onScroll, this));\n\t\tthis.onScroll();\n\t};\n\n\tInfiniteScroll.prototype = {\n\n\t\tconstructor: InfiniteScroll,\n\n\t\tdestroy: function () {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\n\t\t\t// empty elements to return to original markup\n\t\t\tthis.$element.empty();\n\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.$element.off('scroll.fu.infinitescroll');\n\t\t},\n\n\t\tenable: function () {\n\t\t\tthis.$element.on('scroll.fu.infinitescroll', langx.proxy(this.onScroll, this));\n\t\t},\n\n\t\tend: function (content) {\n\t\t\tvar end = $('<div class=\"infinitescroll-end\"></div>');\n\t\t\tif (content) {\n\t\t\t\tend.append(content);\n\t\t\t} else {\n\t\t\t\tend.append('---------');\n\t\t\t}\n\n\t\t\tthis.$element.append(end);\n\t\t\tthis.disable();\n\t\t},\n\n\t\tgetPercentage: function () {\n\t\t\tvar height = (this.$element.css('box-sizing') === 'border-box') ? this.$element.outerHeight() : this.$element.height();\n\t\t\tvar scrollHeight = this.$element.get(0).scrollHeight;\n\t\t\treturn (scrollHeight > height) ? ((height / (scrollHeight - this.curScrollTop)) * 100) : 0;\n\t\t},\n\n\t\tfetchData: function (force) {\n\t\t\tvar load = $('<div class=\"infinitescroll-load\"></div>');\n\t\t\tvar self = this;\n\t\t\tvar moreBtn;\n\n\t\t\tvar fetch = function () {\n\t\t\t\tvar helpers = {\n\t\t\t\t\tpercentage: self.curPercentage,\n\t\t\t\t\tscrollTop: self.curScrollTop\n\t\t\t\t};\n\t\t\t\tvar $loader = $('<div class=\"loader\"></div>');\n\t\t\t\tload.append($loader);\n\t\t\t\t$loader.loader();\n\t\t\t\tif (self.options.dataSource) {\n\t\t\t\t\tself.options.dataSource(helpers, function (resp) {\n\t\t\t\t\t\tvar end;\n\t\t\t\t\t\tload.remove();\n\t\t\t\t\t\tif (resp.content) {\n\t\t\t\t\t\t\tself.$element.append(resp.content);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (resp.end) {\n\t\t\t\t\t\t\tend = (resp.end !== true) ? resp.end : undefined;\n\t\t\t\t\t\t\tself.end(end);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tself.fetchingData = false;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.fetchingData = true;\n\t\t\tthis.$element.append(load);\n\t\t\tif (this.options.hybrid && force !== true) {\n\t\t\t\tmoreBtn = $('<button type=\"button\" class=\"btn btn-primary\"></button>');\n\t\t\t\tif (typeof this.options.hybrid === 'object') {\n\t\t\t\t\tmoreBtn.append(this.options.hybrid.label);\n\t\t\t\t} else {\n\t\t\t\t\tmoreBtn.append('<span class=\"glyphicon glyphicon-repeat\"></span>');\n\t\t\t\t}\n\n\t\t\t\tmoreBtn.on('click.fu.infinitescroll', function () {\n\t\t\t\t\tmoreBtn.remove();\n\t\t\t\t\tfetch();\n\t\t\t\t});\n\t\t\t\tload.append(moreBtn);\n\t\t\t} else {\n\t\t\t\tfetch();\n\t\t\t}\n\t\t},\n\n\t\tonScroll: function (e) {\n\t\t\tthis.curScrollTop = this.$element.scrollTop();\n\t\t\tthis.curPercentage = this.getPercentage();\n\t\t\tif (!this.fetchingData && this.curPercentage >= this.options.percentage) {\n\t\t\t\tthis.fetchData();\n\t\t\t}\n\t\t}\n\t};\n\n\t// INFINITE SCROLL PLUGIN DEFINITION\n\n\t$.fn.infinitescroll = function (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.infinitescroll');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.infinitescroll', (data = new InfiniteScroll(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.infinitescroll.defaults = {\n\t\tdataSource: null,\n\t\thybrid: false,//can be true or an object with structure: { 'label': (markup or jQuery obj) }\n\t\tpercentage: 95//percentage scrolled to the bottom before more is loaded\n\t};\n\n\t$.fn.infinitescroll.Constructor = InfiniteScroll;\n\n\t$.fn.infinitescroll.noConflict = function () {\n\t\t$.fn.infinitescroll = old;\n\t\treturn this;\n\t};\n\n});\n\ndefine('skylark-fuelux/loader',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\"\n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\n\tvar old = $.fn.loader;\n\n\t// LOADER CONSTRUCTOR AND PROTOTYPE\n\n\tvar Loader = fuelux.Loader = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Loader\",\n\n\t\tinit : function(element,options) {\n\t\t\tthis.$element = $(element);\n\t\t\tthis.options = langx.mixin({}, $.fn.loader.defaults, options);\n\t\t},\n\t\tdestroy: function () {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tieRepaint: function () {},\n\n\t\tmsieVersion: function () {},\n\n\t\tnext: function () {},\n\n\t\tpause: function () {},\n\n\t\tplay: function () {},\n\n\t\tprevious: function () {},\n\n\t\treset: function () {}\n\t});\n\n\t// LOADER PLUGIN DEFINITION\n\n\t$.fn.loader = function (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.loader');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.loader', (data = new Loader(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.loader.defaults = {};\n\n\t$.fn.loader.Constructor = Loader;\n\n\t$.fn.loader.noConflict = function () {\n\t\t$.fn.loader = old;\n\t\treturn this;\n\t};\n\n\t// INIT LOADER ON DOMCONTENTLOADED\n\t/*\n\t$(function () {\n\t\t$('[data-initialize=loader]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif (!$this.data('fu.loader')) {\n\t\t\t\t$this.loader($this.data());\n\t\t\t}\n\t\t});\n\t});\n\t*/\n\n\treturn $.fn.loader;\n});\n\ndefine('skylark-fuelux/picker',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\"\n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\tvar old = $.fn.picker;\n\n\t// PLACARD CONSTRUCTOR AND PROTOTYPE\n\n\n\tvar Picker = fuelux.Picker = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Picker\",\n\n\t\tinit : function(element,options) {\n\t\t\tvar self = this;\n\t\t\tthis.$element = $(element);\n\t\t\tthis.options = langx.mixin({}, $.fn.picker.defaults, options);\n\n\t\t\tthis.$accept = this.$element.find('.picker-accept');\n\t\t\tthis.$cancel = this.$element.find('.picker-cancel');\n\t\t\tthis.$trigger = this.$element.find('.picker-trigger');\n\t\t\tthis.$footer = this.$element.find('.picker-footer');\n\t\t\tthis.$header = this.$element.find('.picker-header');\n\t\t\tthis.$popup = this.$element.find('.picker-popup');\n\t\t\tthis.$body = this.$element.find('.picker-body');\n\n\t\t\tthis.clickStamp = '_';\n\n\t\t\tthis.isInput = this.$trigger.is('input');\n\n\t\t\tthis.$trigger.on('keydown.fu.picker', langx.proxy(this.keyComplete, this));\n\t\t\tthis.$trigger.on('focus.fu.picker', langx.proxy(function inputFocus(e){\n\t\t\t\tif(typeof e === \"undefined\" || $(e.target).is('input[type=text]')){\n\t\t\t\t\tlangx.proxy(this.show(), this);\n\t\t\t\t}\n\t\t\t}, this));\n\t\t\tthis.$trigger.on('click.fu.picker', langx.proxy(function triggerClick(e){\n\t\t\t\tif(!$(e.target).is('input[type=text]')){\n\t\t\t\t\tlangx.proxy(this.toggle(), this);\n\t\t\t\t}else{\n\t\t\t\t\tlangx.proxy(this.show(), this);\n\t\t\t\t}\n\t\t\t}, this));\n\t\t\tthis.$accept.on('click.fu.picker', langx.proxy(this.complete, this, 'accepted'));\n\t\t\tthis.$cancel.on('click.fu.picker', function (e) {\n\t\t\t\te.preventDefault(); self.complete('cancelled');\n\t\t\t});\n\t\t},\n\n\t\tcomplete: function complete(action) {\n\t\t\tvar EVENT_CALLBACK_MAP = {\n\t\t\t\t'accepted': 'onAccept',\n\t\t\t\t'cancelled': 'onCancel',\n\t\t\t\t'exited': 'onExit'\n\t\t\t};\n\t\t\tvar func = this.options[ EVENT_CALLBACK_MAP[action] ];\n\n\t\t\tvar obj = {\n\t\t\t\tcontents: this.$body\n\t\t\t};\n\n\t\t\tif (func) {\n\t\t\t\tfunc(obj);\n\t\t\t\tthis.$element.trigger(action + '.fu.picker', obj);\n\t\t\t} else {\n\t\t\t\tthis.$element.trigger(action + '.fu.picker', obj);\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t},\n\n\t\tkeyComplete: function keyComplete(e) {\n\t\t\tif (this.isInput && e.keyCode === 13) {\n\t\t\t\tthis.complete('accepted');\n\t\t\t\tthis.$trigger.blur();\n\t\t\t} else if (e.keyCode === 27) {\n\t\t\t\tthis.complete('exited');\n\t\t\t\tthis.$trigger.blur();\n\t\t\t}\n\t\t},\n\n\t\tdestroy: function destroy() {\n\t\t\tthis.$element.remove();\n\t\t\t// remove any external bindings\n\t\t\t$(document).off('click.fu.picker.externalClick.' + this.clickStamp);\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// return string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tdisable: function disable() {\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$trigger.attr('disabled', 'disabled');\n\t\t},\n\n\t\tenable: function enable() {\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$trigger.removeAttr('disabled');\n\t\t},\n\n\t\ttoggle: function toggle() {\n\t\t\tif (this.$element.hasClass('showing')) {\n\t\t\t\tthis.hide();\n\t\t\t}else{\n\t\t\t\tthis.show();\n\t\t\t}\n\t\t},\n\n\t\thide: function hide() {\n\t\t\tif (!this.$element.hasClass('showing')) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$element.removeClass('showing');\n\t\t\t$(document).off('click.fu.picker.externalClick.' + this.clickStamp);\n\t\t\tthis.$element.trigger('hidden.fu.picker');\n\t\t},\n\n\t\texternalClickListener: function externalClickListener(e, force) {\n\t\t\tif (force === true || this.isExternalClick(e)) {\n\t\t\t\tthis.complete('exited');\n\t\t\t}\n\t\t},\n\n\t\tisExternalClick: function isExternalClick(e) {\n\t\t\tvar el = this.$element.get(0);\n\t\t\tvar exceptions = this.options.externalClickExceptions || [];\n\t\t\tvar $originEl = $(e.target);\n\t\t\tvar i, l;\n\n\t\t\tif (e.target === el || $originEl.parents('.picker').get(0) === el) {\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\tfor (i = 0, l = exceptions.length; i < l; i++) {\n\t\t\t\t\tif ($originEl.is(exceptions[i]) || $originEl.parents(exceptions[i]).length > 0) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tshow: function show() {\n\t\t\tvar other;\n\n\t\t\tother = $(document).find('.picker.showing');\n\t\t\tif (other.length > 0) {\n\t\t\t\tif (other.data('fu.picker') && other.data('fu.picker').options.explicit) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tother.picker('externalClickListener', {}, true);\n\t\t\t}\n\n\t\t\tthis.$element.addClass('showing');\n\n\t\t\t_display(this);\n\n\t\t\tthis.$element.trigger('shown.fu.picker');\n\n\t\t\tthis.clickStamp = new Date().getTime() + (Math.floor(Math.random() * 100) + 1);\n\t\t\tif (!this.options.explicit) {\n\t\t\t\t$(document).on('click.fu.picker.externalClick.' + this.clickStamp, langx.proxy(this.externalClickListener, this));\n\t\t\t}\n\t\t}\n\t});\n\n\tvar _isOffscreen = function _isOffscreen(picker) {\n\t\tvar windowHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n\t\tvar scrollTop = $(document).scrollTop();\n\t\tvar popupTop = picker.$popup.offset();\n\t\tvar popupBottom = popupTop.top + picker.$popup.outerHeight(true);\n\n\t\t//if the bottom of the popup goes off the page, but the top does not, dropup.\n\t\tif (popupBottom > windowHeight + scrollTop || popupTop.top < scrollTop){\n\t\t\treturn true;\n\t\t}else{//otherwise, prefer showing the top of the popup only vs the bottom\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tvar _display = function _display(picker) {\n\t\tpicker.$popup.css('visibility', 'hidden');\n\n\t\t_showBelow(picker);\n\n\t\t//if part of the popup is offscreen try to show it above\n\t\tif(_isOffscreen(picker)){\n\t\t\t_showAbove(picker);\n\n\t\t\t//if part of the popup is still offscreen, prefer cutting off the bottom\n\t\t\tif(_isOffscreen(picker)){\n\t\t\t\t_showBelow(picker);\n\t\t\t}\n\t\t}\n\n\t\tpicker.$popup.css('visibility', 'visible');\n\t};\n\n\tvar _showAbove = function _showAbove(picker) {\n\t\tpicker.$popup.css('top', - picker.$popup.outerHeight(true) + 'px');\n\t};\n\n\tvar _showBelow = function _showBelow(picker) {\n\t\tpicker.$popup.css('top', picker.$trigger.outerHeight(true) + 'px');\n\t};\n\n\n\t// PLACARD PLUGIN DEFINITION\n\n\t$.fn.picker = function picker(option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.picker');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.picker', (data = new Picker(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.picker.defaults = {\n\t\tonAccept: undefined,\n\t\tonCancel: undefined,\n\t\tonExit: undefined,\n\t\texternalClickExceptions: [],\n\t\texplicit: false\n\t};\n\n\t$.fn.picker.Constructor = Picker;\n\n\t$.fn.picker.noConflict = function noConflict() {\n\t\t$.fn.picker = old;\n\t\treturn this;\n\t};\n\n\t// DATA-API\n\n\t/*\n\t$(document).on('focus.fu.picker.data-api', '[data-initialize=picker]', function (e) {\n\t\tvar $control = $(e.target).closest('.picker');\n\t\tif (!$control.data('fu.picker')) {\n\t\t\t$control.picker($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function () {\n\t\t$('[data-initialize=picker]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.data('fu.picker')) return;\n\t\t\t$this.picker($this.data());\n\t\t});\n\t});\n\t*/\n\n\treturn $.fn.picker;\n});\n\ndefine('skylark-fuelux/pillbox',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\",\n  \"./dropdown-autoflip\"\n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\t// -- END UMD WRAPPER PREFACE --\n\n\t// -- BEGIN MODULE CODE HERE --\n\n\tvar old = $.fn.pillbox;\n\n\tvar CONST = fuelux.CONST;\n\tvar COMMA_KEYCODE = CONST.COMMA_KEYCODE;\n\tvar ENTER_KEYCODE = CONST.ENTER_KEYCODE;\n\tvar isBackspaceKey = fuelux.isBackspaceKey;\n\tvar isDeleteKey = fuelux.isDeleteKey;\n\tvar isTabKey = fuelux.isTabKey;\n\tvar isUpArrow = fuelux.isUpArrow;\n\tvar isDownArrow = fuelux.isDownArrow;\n\tvar cleanInput = fuelux.cleanInput;\n\tvar isShiftHeld = fuelux.isShiftHeld;\n\n\t// PILLBOX CONSTRUCTOR AND PROTOTYPE\n\n\tvar Pillbox = fuelux.Pillbox = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Pillbox\",\n\n\t\tinit : function(element,options) {\n\t\t\tthis.$element = $(element);\n\t\t\tthis.$moreCount = this.$element.find('.pillbox-more-count');\n\t\t\tthis.$pillGroup = this.$element.find('.pill-group');\n\t\t\tthis.$addItem = this.$element.find('.pillbox-add-item');\n\t\t\tthis.$addItemWrap = this.$addItem.parent();\n\t\t\tthis.$suggest = this.$element.find('.suggest');\n\t\t\tthis.$pillHTML = '<li class=\"btn btn-default pill\">' +\n\t\t\t'\t<span></span>' +\n\t\t\t'\t<span class=\"glyphicon glyphicon-close\">' +\n\t\t\t'\t\t<span class=\"sr-only\">Remove</span>' +\n\t\t\t'\t</span>' +\n\t\t\t'</li>';\n\n\t\t\tthis.options = langx.mixin({}, $.fn.pillbox.defaults, options);\n\n\t\t\tif (this.options.readonly === -1) {\n\t\t\t\tif (this.$element.attr('data-readonly') !== undefined) {\n\t\t\t\t\tthis.readonly(true);\n\t\t\t\t}\n\t\t\t} else if (this.options.readonly) {\n\t\t\t\tthis.readonly(true);\n\t\t\t}\n\n\t\t\t// EVENTS\n\t\t\tthis.acceptKeyCodes = this._generateObject(this.options.acceptKeyCodes);\n\t\t\t// Create an object out of the key code array, so we don't have to loop through it on every key stroke\n\n\t\t\tthis.$element.on('click.fu.pillbox', '.pill-group > .pill', langx.proxy(this.itemClicked, this));\n\t\t\tthis.$element.on('click.fu.pillbox', langx.proxy(this.inputFocus, this));\n\t\t\tthis.$element.on('keydown.fu.pillbox', '.pillbox-add-item', langx.proxy(this.inputEvent, this));\n\t\t\tif (this.options.onKeyDown) {\n\t\t\t\tthis.$element.on('mousedown.fu.pillbox', '.suggest > li', langx.proxy(this.suggestionClick, this));\n\t\t\t}\n\n\t\t\tif (this.options.edit) {\n\t\t\t\tthis.$element.addClass('pills-editable');\n\t\t\t\tthis.$element.on('blur.fu.pillbox', '.pillbox-add-item', langx.proxy(this.cancelEdit, this));\n\t\t\t}\n\t\t\tthis.$element.on('blur.fu.pillbox', '.pillbox-add-item', langx.proxy(this.inputEvent, this));\n\t\t},\n\n\t\tdestroy: function destroy () {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\titems: function items () {\n\t\t\tvar self = this;\n\n\t\t\treturn this.$pillGroup.children('.pill').map(function getItemsData () {\n\t\t\t\treturn self.getItemData($(this));\n\t\t\t}).get();\n\t\t},\n\n\t\titemClicked: function itemClicked (e) {\n\t\t\tvar $target = $(e.target);\n\t\t\tvar $item;\n\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tthis._closeSuggestions();\n\n\t\t\tif (!$target.hasClass('pill')) {\n\t\t\t\t$item = $target.parent();\n\t\t\t\tif (this.$element.attr('data-readonly') === undefined) {\n\t\t\t\t\tif ($target.hasClass('glyphicon-close')) {\n\t\t\t\t\t\tif (this.options.onRemove) {\n\t\t\t\t\t\t\tthis.options.onRemove(this.getItemData($item, {\n\t\t\t\t\t\t\t\tel: $item\n\t\t\t\t\t\t\t}), langx.proxy(this._removeElement, this));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._removeElement(this.getItemData($item, {\n\t\t\t\t\t\t\t\tel: $item\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if (this.options.edit) {\n\t\t\t\t\t\tif ($item.find('.pillbox-list-edit').length) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.openEdit($item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$item = $target;\n\t\t\t}\n\n\t\t\tthis.$element.trigger('clicked.fu.pillbox', this.getItemData($item));\n\n\t\t\treturn true;\n\t\t},\n\n\t\treadonly: function readonly (enable) {\n\t\t\tif (enable) {\n\t\t\t\tthis.$element.attr('data-readonly', 'readonly');\n\t\t\t} else {\n\t\t\t\tthis.$element.removeAttr('data-readonly');\n\t\t\t}\n\n\t\t\tif (this.options.truncate) {\n\t\t\t\tthis.truncate(enable);\n\t\t\t}\n\t\t},\n\n\t\tsuggestionClick: function suggestionClick (e) {\n\t\t\tvar $item = $(e.currentTarget);\n\t\t\tvar item = {\n\t\t\t\ttext: $item.html(),\n\t\t\t\tvalue: $item.data('value')\n\t\t\t};\n\n\t\t\te.preventDefault();\n\t\t\tthis.$addItem.val('');\n\n\t\t\tif ($item.data('attr')) {\n\t\t\t\titem.attr = JSON.parse($item.data('attr'));\n\t\t\t}\n\n\t\t\titem.data = $item.data('data');\n\n\t\t\tthis.addItems(item, true);\n\n\t\t\t// needs to be after addItems for IE\n\t\t\tthis._closeSuggestions();\n\t\t},\n\n\t\titemCount: function itemCount () {\n\t\t\treturn this.$pillGroup.children('.pill').length;\n\t\t},\n\n\t\t// First parameter is 1 based index (optional, if index is not passed all new items will be appended)\n\t\t// Second parameter can be array of objects [{ ... }, { ... }] or you can pass n additional objects as args\n\t\t// object structure is as follows (attr and value are optional): { text: '', value: '', attr: {}, data: {} }\n\t\taddItems: function addItems () {\n\t\t\tvar self = this;\n\t\t\tvar items;\n\t\t\tvar index;\n\t\t\tvar isInternal;\n\n\t\t\tif (isFinite(String(arguments[0])) && !(arguments[0] instanceof Array)) {\n\t\t\t\titems = [].slice.call(arguments).slice(1);\n\t\t\t\tindex = arguments[0];\n\t\t\t} else {\n\t\t\t\titems = [].slice.call(arguments).slice(0);\n\t\t\t\tisInternal = items[1] && !items[1].text;\n\t\t\t}\n\n\t\t\t// If first argument is an array, use that, otherwise they probably passed each thing through as a separate arg, so use items as-is\n\t\t\tif (items[0] instanceof Array) {\n\t\t\t\titems = items[0];\n\t\t\t}\n\n\t\t\tif (items.length) {\n\t\t\t\tlangx.each(items, function normalizeItemsObject (i, value) {\n\t\t\t\t\tvar data = {\n\t\t\t\t\t\ttext: value.text,\n\t\t\t\t\t\tvalue: (value.value ? value.value : value.text),\n\t\t\t\t\t\tel: self.$pillHTML\n\t\t\t\t\t};\n\n\t\t\t\t\tif (value.attr) {\n\t\t\t\t\t\tdata.attr = value.attr;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (value.data) {\n\t\t\t\t\t\tdata.data = value.data;\n\t\t\t\t\t}\n\n\t\t\t\t\titems[i] = data;\n\t\t\t\t});\n\n\t\t\t\tif (this.options.edit && this.currentEdit) {\n\t\t\t\t\titems[0].el = this.currentEdit.wrap('<div></div>').parent().html();\n\t\t\t\t}\n\n\t\t\t\tif (isInternal) {\n\t\t\t\t\titems.pop(1);\n\t\t\t\t}\n\n\t\t\t\tif (self.options.onAdd && isInternal) {\n\t\t\t\t\tif (this.options.edit && this.currentEdit) {\n\t\t\t\t\t\tself.options.onAdd(items[0], langx.proxy(self.saveEdit, this));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.options.onAdd(items[0], langx.proxy(self.placeItems, this));\n\t\t\t\t\t}\n\t\t\t\t} else if (this.options.edit && this.currentEdit) {\n\t\t\t\t\tself.saveEdit(items);\n\t\t\t\t} else if (index) {\n\t\t\t\t\tself.placeItems(index, items);\n\t\t\t\t} else {\n\t\t\t\t\tself.placeItems(items, isInternal);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t// First parameter is the index (1 based) to start removing items\n\t\t// Second parameter is the number of items to be removed\n\t\tremoveItems: function removeItems (index, howMany) {\n\t\t\tvar self = this;\n\n\t\t\tif (!index) {\n\t\t\t\tthis.$pillGroup.find('.pill').remove();\n\t\t\t\tthis._removePillTrigger({\n\t\t\t\t\tmethod: 'removeAll'\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tvar itemsToRemove = howMany ? howMany : 1;\n\n\t\t\t\tfor (var item = 0; item < itemsToRemove; item++) {\n\t\t\t\t\tvar $currentItem = self.$pillGroup.find('> .pill:nth-child(' + index + ')');\n\n\t\t\t\t\tif ($currentItem) {\n\t\t\t\t\t\t$currentItem.remove();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t// First parameter is index (optional)\n\t\t// Second parameter is new arguments\n\t\tplaceItems: function placeItems () {\n\t\t\tvar items;\n\t\t\tvar index;\n\t\t\tvar $neighbor;\n\t\t\tvar isInternal;\n\n\t\t\tif (isFinite(String(arguments[0])) && !(arguments[0] instanceof Array)) {\n\t\t\t\titems = [].slice.call(arguments).slice(1);\n\t\t\t\tindex = arguments[0];\n\t\t\t} else {\n\t\t\t\titems = [].slice.call(arguments).slice(0);\n\t\t\t\tisInternal = items[1] && !items[1].text;\n\t\t\t}\n\n\t\t\tif (items[0] instanceof Array) {\n\t\t\t\titems = items[0];\n\t\t\t}\n\n\t\t\tif (items.length) {\n\t\t\t\tvar newItems = [];\n\t\t\t\tlangx.each(items, function prepareItemForAdd (i, item) {\n\t\t\t\t\tvar $item = $(item.el);\n\n\t\t\t\t\t$item.attr('data-value', item.value);\n\t\t\t\t\t$item.find('span:first').html(item.text);\n\n\t\t\t\t\t// DOM attributes\n\t\t\t\t\tif (item.attr) {\n\t\t\t\t\t\tlangx.each(item.attr, function handleDOMAttributes (key, value) {\n\t\t\t\t\t\t\tif (key === 'cssClass' || key === 'class') {\n\t\t\t\t\t\t\t\t$item.addClass(value);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$item.attr(key, value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (item.data) {\n\t\t\t\t\t\t$item.data('data', item.data);\n\t\t\t\t\t}\n\n\t\t\t\t\tnewItems.push($item);\n\t\t\t\t});\n\n\t\t\t\tif (this.$pillGroup.children('.pill').length > 0) {\n\t\t\t\t\tif (index) {\n\t\t\t\t\t\t$neighbor = this.$pillGroup.find('.pill').eq(index);\n\n\t\t\t\t\t\tif ($neighbor.length) {\n\t\t\t\t\t\t\t$neighbor.before(newItems);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.$pillGroup.children('.pill').last().after(newItems);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.$pillGroup.children('.pill').last().after(newItems);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.$pillGroup.prepend(newItems);\n\t\t\t\t}\n\n\t\t\t\tif (isInternal) {\n\t\t\t\t\tthis.$element.trigger('added.fu.pillbox', {\n\t\t\t\t\t\ttext: items[0].text,\n\t\t\t\t\t\tvalue: items[0].value\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tinputEvent: function inputEvent (e) {\n\t\t\tvar self = this;\n\t\t\tvar text = self.options.cleanInput(this.$addItem.val());\n\t\t\tvar isFocusOutEvent = e.type === 'focusout';\n\t\t\tvar blurredAfterInput = (isFocusOutEvent && text.length > 0);\n\t\t\t// If we test for keycode only, it will match for `<` & `,` instead of just `,`\n\t\t\t// This way users can type `<3` and `1 < 3`, etc...\n\t\t\tvar acceptKeyPressed = (this.acceptKeyCodes[e.keyCode] && !isShiftHeld(e));\n\n\t\t\tif (acceptKeyPressed || blurredAfterInput) {\n\t\t\t\tvar attr;\n\t\t\t\tvar value;\n\n\t\t\t\tif (this.options.onKeyDown && this._isSuggestionsOpen()) {\n\t\t\t\t\tvar $selection = this.$suggest.find('.pillbox-suggest-sel');\n\n\t\t\t\t\tif ($selection.length) {\n\t\t\t\t\t\ttext = self.options.cleanInput($selection.html());\n\t\t\t\t\t\tvalue = self.options.cleanInput($selection.data('value'));\n\t\t\t\t\t\tattr = $selection.data('attr');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// ignore comma and make sure text that has been entered (protects against \" ,\". https://github.com/ExactTarget/fuelux/issues/593), unless allowEmptyPills is true.\n\t\t\t\tif (text.replace(/[ ]*\\,[ ]*/, '').match(/\\S/) || (this.options.allowEmptyPills && text.length)) {\n\t\t\t\t\tthis._closeSuggestions();\n\t\t\t\t\tthis.$addItem.val('').hide();\n\n\t\t\t\t\tif (attr) {\n\t\t\t\t\t\tthis.addItems({\n\t\t\t\t\t\t\ttext: text,\n\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\tattr: JSON.parse(attr)\n\t\t\t\t\t\t}, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.addItems({\n\t\t\t\t\t\t\ttext: text,\n\t\t\t\t\t\t\tvalue: value\n\t\t\t\t\t\t}, true);\n\t\t\t\t\t}\n\n\t\t\t\t\tsetTimeout(function clearAddItemInput () {\n\t\t\t\t\t\tself.$addItem.show().attr({\n\t\t\t\t\t\t\tsize: 10\n\t\t\t\t\t\t}).focus();\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\t\t\t\treturn true;\n\t\t\t} else if (isBackspaceKey(e) || isDeleteKey(e)) {\n\t\t\t\tif (!text.length) {\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tif (this.options.edit && this.currentEdit) {\n\t\t\t\t\t\tthis.cancelEdit();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._closeSuggestions();\n\t\t\t\t\tvar $lastItem = this.$pillGroup.children('.pill:last');\n\n\t\t\t\t\tif ($lastItem.hasClass('pillbox-highlight')) {\n\t\t\t\t\t\tthis._removeElement(this.getItemData($lastItem, {\n\t\t\t\t\t\t\tel: $lastItem\n\t\t\t\t\t\t}));\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$lastItem.addClass('pillbox-highlight');\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else if (text.length > 10) {\n\t\t\t\tif (this.$addItem.width() < (this.$pillGroup.width() - 6)) {\n\t\t\t\t\tthis.$addItem.attr({\n\t\t\t\t\t\tsize: text.length + 3\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.$pillGroup.find('.pill').removeClass('pillbox-highlight');\n\n\t\t\tif (this.options.onKeyDown && !isFocusOutEvent) {\n\t\t\t\tif (\n\t\t\t\t\tisTabKey(e) ||\n\t\t\t\t\tisUpArrow(e) ||\n\t\t\t\t\tisDownArrow(e)\n\t\t\t\t) {\n\t\t\t\t\tif (this._isSuggestionsOpen()) {\n\t\t\t\t\t\tthis._keySuggestions(e);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\t// only allowing most recent event callback to register\n\t\t\t\tthis.callbackId = e.timeStamp;\n\t\t\t\tthis.options.onKeyDown({\n\t\t\t\t\tevent: e,\n\t\t\t\t\tvalue: text\n\t\t\t\t}, function callOpenSuggestions (data) {\n\t\t\t\t\tself._openSuggestions(e, data);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\topenEdit: function openEdit (el) {\n\t\t\tvar targetChildIndex = el.index() + 1;\n\t\t\tvar $addItemWrap = this.$addItemWrap.detach().hide();\n\n\t\t\tthis.$pillGroup.find('.pill:nth-child(' + targetChildIndex + ')').before($addItemWrap);\n\t\t\tthis.currentEdit = el.detach();\n\n\t\t\t$addItemWrap.addClass('editing');\n\t\t\tthis.$addItem.val(el.find('span:first').html());\n\t\t\t$addItemWrap.show();\n\t\t\tthis.$addItem.focus().select();\n\t\t},\n\n\t\tcancelEdit: function cancelEdit (e) {\n\t\t\tvar $addItemWrap;\n\t\t\tif (!this.currentEdit) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis._closeSuggestions();\n\t\t\tif (e) {\n\t\t\t\tthis.$addItemWrap.before(this.currentEdit);\n\t\t\t}\n\n\t\t\tthis.currentEdit = false;\n\n\t\t\t$addItemWrap = this.$addItemWrap.detach();\n\t\t\t$addItemWrap.removeClass('editing');\n\t\t\tthis.$addItem.val('');\n\t\t\tthis.$pillGroup.append($addItemWrap);\n\n\t\t\treturn true;\n\t\t},\n\n\t\t// Must match syntax of placeItem so addItem callback is called when an item is edited\n\t\t// expecting to receive an array back from the callback containing edited items\n\t\tsaveEdit: function saveEdit () {\n\t\t\tvar item = arguments[0][0] ? arguments[0][0] : arguments[0];\n\n\t\t\tthis.currentEdit = $(item.el);\n\t\t\tthis.currentEdit.data('value', item.value);\n\t\t\tthis.currentEdit.find('span:first').html(item.text);\n\n\t\t\tthis.$addItemWrap.hide();\n\t\t\tthis.$addItemWrap.before(this.currentEdit);\n\t\t\tthis.currentEdit = false;\n\n\t\t\tthis.$addItem.val('');\n\t\t\tthis.$addItemWrap.removeClass('editing');\n\t\t\tthis.$pillGroup.append(this.$addItemWrap.detach().show());\n\t\t\tthis.$element.trigger('edited.fu.pillbox', {\n\t\t\t\tvalue: item.value,\n\t\t\t\ttext: item.text\n\t\t\t});\n\t\t},\n\n\t\tremoveBySelector: function removeBySelector () {\n\t\t\tvar selectors = [].slice.call(arguments).slice(0);\n\t\t\tvar self = this;\n\n\t\t\tlangx.each(selectors, function doRemove (i, sel) {\n\t\t\t\tself.$pillGroup.find(sel).remove();\n\t\t\t});\n\n\t\t\tthis._removePillTrigger({\n\t\t\t\tmethod: 'removeBySelector',\n\t\t\t\tremovedSelectors: selectors\n\t\t\t});\n\t\t},\n\n\t\tremoveByValue: function removeByValue () {\n\t\t\tvar values = [].slice.call(arguments).slice(0);\n\t\t\tvar self = this;\n\n\t\t\tlangx.each(values, function doRemove (i, val) {\n\t\t\t\tself.$pillGroup.find('> .pill[data-value=\"' + val + '\"]').remove();\n\t\t\t});\n\n\t\t\tthis._removePillTrigger({\n\t\t\t\tmethod: 'removeByValue',\n\t\t\t\tremovedValues: values\n\t\t\t});\n\t\t},\n\n\t\tremoveByText: function removeByText () {\n\t\t\tvar text = [].slice.call(arguments).slice(0);\n\t\t\tvar self = this;\n\n\t\t\tlangx.each(text, function doRemove (i, matchingText) {\n\t\t\t\tself.$pillGroup.find('> .pill:contains(\"' + matchingText + '\")').remove();\n\t\t\t});\n\n\t\t\tthis._removePillTrigger({\n\t\t\t\tmethod: 'removeByText',\n\t\t\t\tremovedText: text\n\t\t\t});\n\t\t},\n\n\t\ttruncate: function truncate (enable) {\n\t\t\tvar self = this;\n\n\t\t\tthis.$element.removeClass('truncate');\n\t\t\tthis.$addItemWrap.removeClass('truncated');\n\t\t\tthis.$pillGroup.find('.pill').removeClass('truncated');\n\n\t\t\tif (enable) {\n\t\t\t\tthis.$element.addClass('truncate');\n\n\t\t\t\tvar availableWidth = this.$element.width();\n\t\t\t\tvar containerFull = false;\n\t\t\t\tvar processedPills = 0;\n\t\t\t\tvar totalPills = this.$pillGroup.find('.pill').length;\n\t\t\t\tvar widthUsed = 0;\n\n\t\t\t\tthis.$pillGroup.find('.pill').each(function processPills () {\n\t\t\t\t\tvar pill = $(this);\n\t\t\t\t\tif (!containerFull) {\n\t\t\t\t\t\tprocessedPills++;\n\t\t\t\t\t\tself.$moreCount.text(totalPills - processedPills);\n\t\t\t\t\t\tif ((widthUsed + pill.outerWidth(true) + self.$addItemWrap.outerWidth(true)) <= availableWidth) {\n\t\t\t\t\t\t\twidthUsed += pill.outerWidth(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tself.$moreCount.text((totalPills - processedPills) + 1);\n\t\t\t\t\t\t\tpill.addClass('truncated');\n\t\t\t\t\t\t\tcontainerFull = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpill.addClass('truncated');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (processedPills === totalPills) {\n\t\t\t\t\tthis.$addItemWrap.addClass('truncated');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tinputFocus: function inputFocus () {\n\t\t\tthis.$element.find('.pillbox-add-item').focus();\n\t\t},\n\n\t\tgetItemData: function getItemData (el, data) {\n\t\t\treturn langx.mixin({\n\t\t\t\ttext: el.find('span:first').html()\n\t\t\t}, el.data(), data);\n\t\t},\n\n\t\t_removeElement: function _removeElement (data) {\n\t\t\tdata.el.remove();\n\t\t\tdelete data.el;\n\t\t\tthis.$element.trigger('removed.fu.pillbox', data);\n\t\t},\n\n\t\t_removePillTrigger: function _removePillTrigger (removedBy) {\n\t\t\tthis.$element.trigger('removed.fu.pillbox', removedBy);\n\t\t},\n\n\t\t_generateObject: function _generateObject (data) {\n\t\t\tvar obj = {};\n\n\t\t\tlangx.each(data, function setObjectValue (index, value) {\n\t\t\t\tobj[value] = true;\n\t\t\t});\n\n\t\t\treturn obj;\n\t\t},\n\n\t\t_openSuggestions: function _openSuggestions (e, data) {\n\t\t\tvar $suggestionList = $('<ul>');\n\n\t\t\tif (this.callbackId !== e.timeStamp) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (data.data && data.data.length) {\n\t\t\t\tlangx.each(data.data, function appendSuggestions (index, value) {\n\t\t\t\t\tvar val = value.value ? value.value : value.text;\n\n\t\t\t\t\t// markup concatentation is 10x faster, but does not allow data store\n\t\t\t\t\tvar $suggestion = $('<li data-value=\"' + val + '\">' + value.text + '</li>');\n\n\t\t\t\t\tif (value.attr) {\n\t\t\t\t\t\t$suggestion.data('attr', JSON.stringify(value.attr));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (value.data) {\n\t\t\t\t\t\t$suggestion.data('data', value.data);\n\t\t\t\t\t}\n\n\t\t\t\t\t$suggestionList.append($suggestion);\n\t\t\t\t});\n\n\t\t\t\t// suggestion dropdown\n\t\t\t\tthis.$suggest.html('').append($suggestionList.children());\n\t\t\t\t$(document).trigger('suggested.fu.pillbox', this.$suggest);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\t_closeSuggestions: function _closeSuggestions () {\n\t\t\tthis.$suggest.html('').parent().removeClass('open');\n\t\t},\n\n\t\t_isSuggestionsOpen: function _isSuggestionsOpen () {\n\t\t\treturn this.$suggest.parent().hasClass('open');\n\t\t},\n\n\t\t_keySuggestions: function _keySuggestions (e) {\n\t\t\tvar $first = this.$suggest.find('li.pillbox-suggest-sel');\n\t\t\tvar dir = isUpArrow(e);\n\n\t\t\te.preventDefault();\n\n\t\t\tif (!$first.length) {\n\t\t\t\t$first = this.$suggest.find('li:first');\n\t\t\t\t$first.addClass('pillbox-suggest-sel');\n\t\t\t} else {\n\t\t\t\tvar $next = dir ? $first.prev() : $first.next();\n\n\t\t\t\tif (!$next.length) {\n\t\t\t\t\t$next = dir ? this.$suggest.find('li:last') : this.$suggest.find('li:first');\n\t\t\t\t}\n\n\t\t\t\tif ($next) {\n\t\t\t\t\t$next.addClass('pillbox-suggest-sel');\n\t\t\t\t\t$first.removeClass('pillbox-suggest-sel');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\n\tPillbox.prototype.getValue = Pillbox.prototype.items;\n\n\t// PILLBOX PLUGIN DEFINITION\n\n\t$.fn.pillbox = function pillbox (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function set () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.pillbox');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.pillbox', (data = new Pillbox(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.pillbox.defaults = {\n\t\tedit: false,\n\t\treadonly: -1, // can be true or false. -1 means it will check for data-readonly=\"readonly\"\n\t\ttruncate: false,\n\t\tacceptKeyCodes: [\n\t\t\tENTER_KEYCODE,\n\t\t\tCOMMA_KEYCODE\n\t\t],\n\t\tallowEmptyPills: false,\n\t\tcleanInput: cleanInput\n\n\t\t// example on remove\n\t\t/* onRemove: function(data,callback){\n\t\t\tconsole.log('onRemove');\n\t\t\tcallback(data);\n\t\t} */\n\n\t\t// example on key down\n\t\t/* onKeyDown: function(event, data, callback ){\n\t\t\tcallback({data:[\n\t\t\t\t{text: Math.random(),value:'sdfsdfsdf'},\n\t\t\t\t{text: Math.random(),value:'sdfsdfsdf'}\n\t\t\t]});\n\t\t}\n\t\t*/\n\t\t// example onAdd\n\t\t/* onAdd: function( data, callback ){\n\t\t\tconsole.log(data, callback);\n\t\t\tcallback(data);\n\t\t} */\n\t};\n\n\t$.fn.pillbox.Constructor = Pillbox;\n\n\t$.fn.pillbox.noConflict = function noConflict () {\n\t\t$.fn.pillbox = old;\n\t\treturn this;\n\t};\n\n\n\t// DATA-API\n\n\t/*\n\t$(document).on('mousedown.fu.pillbox.data-api', '[data-initialize=pillbox]', function dataAPI (e) {\n\t\tvar $control = $(e.target).closest('.pillbox');\n\t\tif (!$control.data('fu.pillbox')) {\n\t\t\t$control.pillbox($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function DOMReady () {\n\t\t$('[data-initialize=pillbox]').each(function init () {\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.data('fu.pillbox')) return;\n\t\t\t$this.pillbox($this.data());\n\t\t});\n\t});\n\t*/\n\n\treturn $.fn.pillbox;\n});\n\ndefine('skylark-fuelux/placard',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\"\n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\tvar old = $.fn.placard;\n\tvar EVENT_CALLBACK_MAP = { 'accepted': 'onAccept', 'cancelled': 'onCancel' };\n\n\n\t// PLACARD CONSTRUCTOR AND PROTOTYPE\n\n\tvar Placard = fuelux.Placard = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Placard\",\n\n\t\tinit : function(element,options) {\n\t\t\tvar self = this;\n\t\t\tthis.$element = $(element);\n\t\t\tthis.options = langx.mixin({}, $.fn.placard.defaults, options);\n\n\t\t\tif(this.$element.attr('data-ellipsis') === 'true'){\n\t\t\t\tthis.options.applyEllipsis = true;\n\t\t\t}\n\n\t\t\tthis.$accept = this.$element.find('.placard-accept');\n\t\t\tthis.$cancel = this.$element.find('.placard-cancel');\n\t\t\tthis.$field = this.$element.find('.placard-field');\n\t\t\tthis.$footer = this.$element.find('.placard-footer');\n\t\t\tthis.$header = this.$element.find('.placard-header');\n\t\t\tthis.$popup = this.$element.find('.placard-popup');\n\n\t\t\tthis.actualValue = null;\n\t\t\tthis.clickStamp = '_';\n\t\t\tthis.previousValue = '';\n\t\t\tif (this.options.revertOnCancel === -1) {\n\t\t\t\tthis.options.revertOnCancel = (this.$accept.length > 0);\n\t\t\t}\n\n\t\t\t// Placard supports inputs, textareas, or contenteditable divs. These checks determine which is being used\n\t\t\tthis.isContentEditableDiv = this.$field.is('div');\n\t\t\tthis.isInput = this.$field.is('input');\n\t\t\tthis.divInTextareaMode = (this.isContentEditableDiv && this.$field.attr('data-textarea') === 'true');\n\n\t\t\tthis.$field.on('focus.fu.placard', langx.proxy(this.show, this));\n\t\t\tthis.$field.on('keydown.fu.placard', langx.proxy(this.keyComplete, this));\n\t\t\tthis.$element.on('close.fu.placard', langx.proxy(this.hide, this));\n\t\t\tthis.$accept.on('click.fu.placard', langx.proxy(this.complete, this, 'accepted'));\n\t\t\tthis.$cancel.on('click.fu.placard', function (e) {\n\t\t\t\te.preventDefault(); self.complete('cancelled');\n\t\t\t});\n\n\t\t\tthis.applyEllipsis();\n\t\t},\n\n\t\tcomplete: function complete(action) {\n\t\t\tvar func = this.options[ EVENT_CALLBACK_MAP[action] ];\n\n\t\t\tvar obj = {\n\t\t\t\tpreviousValue: this.previousValue,\n\t\t\t\tvalue: this.getValue()\n\t\t\t};\n\n\t\t\tif (func) {\n\t\t\t\tfunc(obj);\n\t\t\t\tthis.$element.trigger(action + '.fu.placard', obj);\n\t\t\t} else {\n\t\t\t\tif (action === 'cancelled' && this.options.revertOnCancel) {\n\t\t\t\t\tthis.setValue(this.previousValue, true);\n\t\t\t\t}\n\n\t\t\t\tthis.$element.trigger(action + '.fu.placard', obj);\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t},\n\n\t\tkeyComplete: function keyComplete(e) {\n\t\t\tif (((this.isContentEditableDiv && !this.divInTextareaMode) || this.isInput) && e.keyCode === 13) {\n\t\t\t\tthis.complete('accepted');\n\t\t\t\tthis.$field.blur();\n\t\t\t} else if (e.keyCode === 27) {\n\t\t\t\tthis.complete('cancelled');\n\t\t\t\tthis.$field.blur();\n\t\t\t}\n\t\t},\n\n\t\tdestroy: function destroy() {\n\t\t\tthis.$element.remove();\n\t\t\t// remove any external bindings\n\t\t\t$(document).off('click.fu.placard.externalClick.' + this.clickStamp);\n\t\t\t// set input value attribute\n\t\t\tthis.$element.find('input').each(function () {\n\t\t\t\t$(this).attr('value', $(this).val());\n\t\t\t});\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// return string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tdisable: function disable() {\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$field.attr('disabled', 'disabled');\n\t\t\tif (this.isContentEditableDiv) {\n\t\t\t\tthis.$field.removeAttr('contenteditable');\n\t\t\t}\n\t\t\tthis.hide();\n\t\t},\n\n\t\tapplyEllipsis: function applyEllipsis() {\n\t\t\tvar field, i, str;\n\t\t\tif (this.options.applyEllipsis) {\n\t\t\t\tfield = this.$field.get(0);\n\t\t\t\tif ((this.isContentEditableDiv && !this.divInTextareaMode) || this.isInput) {\n\t\t\t\t\tfield.scrollLeft = 0;\n\t\t\t\t} else {\n\t\t\t\t\tfield.scrollTop = 0;\n\t\t\t\t\tif (field.clientHeight < field.scrollHeight) {\n\t\t\t\t\t\tthis.actualValue = this.getValue();\n\t\t\t\t\t\tthis.setValue('', true);\n\t\t\t\t\t\tstr = '';\n\t\t\t\t\t\ti = 0;\n\t\t\t\t\t\twhile (field.clientHeight >= field.scrollHeight) {\n\t\t\t\t\t\t\tstr += this.actualValue[i];\n\t\t\t\t\t\t\tthis.setValue(str + '...', true);\n\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstr = (str.length > 0) ? str.substring(0, str.length - 1) : '';\n\t\t\t\t\t\tthis.setValue(str + '...', true);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t},\n\n\t\tenable: function enable() {\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$field.removeAttr('disabled');\n\t\t\tif (this.isContentEditableDiv) {\n\t\t\t\tthis.$field.attr('contenteditable', 'true');\n\t\t\t}\n\t\t},\n\n\t\texternalClickListener: function externalClickListener(e, force) {\n\t\t\tif (force === true || this.isExternalClick(e)) {\n\t\t\t\tthis.complete(this.options.externalClickAction);\n\t\t\t}\n\t\t},\n\n\t\tgetValue: function getValue() {\n\t\t\tif (this.actualValue !== null) {\n\t\t\t\treturn this.actualValue;\n\t\t\t} else if (this.isContentEditableDiv) {\n\t\t\t\treturn this.$field.html();\n\t\t\t} else {\n\t\t\t\treturn this.$field.val();\n\t\t\t}\n\t\t},\n\n\t\thide: function hide() {\n\t\t\tif (!this.$element.hasClass('showing')) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$element.removeClass('showing');\n\t\t\tthis.applyEllipsis();\n\t\t\t$(document).off('click.fu.placard.externalClick.' + this.clickStamp);\n\t\t\tthis.$element.trigger('hidden.fu.placard');\n\t\t},\n\n\t\tisExternalClick: function isExternalClick(e) {\n\t\t\tvar el = this.$element.get(0);\n\t\t\tvar exceptions = this.options.externalClickExceptions || [];\n\t\t\tvar $originEl = $(e.target);\n\t\t\tvar i, l;\n\n\t\t\tif (noder.contains(el,e.target)) {\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\tfor (i = 0, l = exceptions.length; i < l; i++) {\n\t\t\t\t\tif ($originEl.is(exceptions[i]) || $originEl.parents(exceptions[i]).length > 0) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * setValue() sets the Placard triggering DOM element's display value\n\t\t *\n\t\t * @param {String} the value to be displayed\n\t\t * @param {Boolean} If you want to explicitly suppress the application\n\t\t *\t\t\t\t\tof ellipsis, pass `true`. This would typically only be\n\t\t *\t\t\t\t\tdone from internal functions (like `applyEllipsis`)\n\t\t *\t\t\t\t\tthat want to avoid circular logic. Otherwise, the\n\t\t *\t\t\t\t\tvalue of the option applyEllipsis will be used.\n\t\t * @return {Object} jQuery object representing the DOM element whose\n\t\t *\t\t\t\t\tvalue was set\n\t\t */\n\t\tsetValue: function setValue(val, suppressEllipsis) {\n\t\t\t//if suppressEllipsis is undefined, check placards init settings\n\t\t\tif (typeof suppressEllipsis === 'undefined') {\n\t\t\t\tsuppressEllipsis = !this.options.applyEllipsis;\n\t\t\t}\n\n\t\t\tif (this.isContentEditableDiv) {\n\t\t\t\tthis.$field.empty().append(val);\n\t\t\t} else {\n\t\t\t\tthis.$field.val(val);\n\t\t\t}\n\n\t\t\tif (!suppressEllipsis && !_isShown(this)) {\n\t\t\t\tthis.applyEllipsis();\n\t\t\t}\n\n\t\t\treturn this.$field;\n\t\t},\n\n\t\tshow: function show() {\n\t\t\tif (_isShown(this)) { return; }\n\t\t\tif (!_closeOtherPlacards()) { return; }\n\n\t\t\tthis.previousValue = (this.isContentEditableDiv) ? this.$field.html() : this.$field.val();\n\n\t\t\tif (this.actualValue !== null) {\n\t\t\t\tthis.setValue(this.actualValue, true);\n\t\t\t\tthis.actualValue = null;\n\t\t\t}\n\n\t\t\tthis.showPlacard();\n\t\t},\n\n\t\tshowPlacard: function showPlacard() {\n\t\t\tthis.$element.addClass('showing');\n\n\t\t\tif (this.$header.length > 0) {\n\t\t\t\tthis.$popup.css('top', '-' + this.$header.outerHeight(true) + 'px');\n\t\t\t}\n\n\t\t\tif (this.$footer.length > 0) {\n\t\t\t\tthis.$popup.css('bottom', '-' + this.$footer.outerHeight(true) + 'px');\n\t\t\t}\n\n\t\t\tthis.$element.trigger('shown.fu.placard');\n\t\t\tthis.clickStamp = new Date().getTime() + (Math.floor(Math.random() * 100) + 1);\n\t\t\tif (!this.options.explicit) {\n\t\t\t\t$(document).on('click.fu.placard.externalClick.' + this.clickStamp, langx.proxy(this.externalClickListener, this));\n\t\t\t}\n\t\t}\n\t\t\n\t});\n\n\tvar _isShown = function _isShown(placard) {\n\t\treturn placard.$element.hasClass('showing');\n\t};\n\n\tvar _closeOtherPlacards = function _closeOtherPlacards() {\n\t\tvar otherPlacards;\n\n\t\totherPlacards = $(document).find('.placard.showing');\n\t\tif (otherPlacards.length > 0) {\n\t\t\tif (otherPlacards.data('fu.placard') && otherPlacards.data('fu.placard').options.explicit) {\n\t\t\t\treturn false;//failed\n\t\t\t}\n\n\t\t\totherPlacards.placard('externalClickListener', {}, true);\n\t\t}\n\n\t\treturn true;//succeeded\n\t};\n\n\n\t// PLACARD PLUGIN DEFINITION\n\n\t$.fn.placard = function (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.placard');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.placard', (data = new Placard(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.placard.defaults = {\n\t\tonAccept: undefined,\n\t\tonCancel: undefined,\n\t\texternalClickAction: 'cancelled',\n\t\texternalClickExceptions: [],\n\t\texplicit: false,\n\t\trevertOnCancel: -1,//negative 1 will check for an '.placard-accept' button. Also can be set to true or false\n\t\tapplyEllipsis: false\n\t};\n\n\t$.fn.placard.Constructor = Placard;\n\n\t$.fn.placard.noConflict = function () {\n\t\t$.fn.placard = old;\n\t\treturn this;\n\t};\n\n\t/*\n\t// DATA-API\n\t$(document).on('focus.fu.placard.data-api', '[data-initialize=placard]', function (e) {\n\t\tvar $control = $(e.target).closest('.placard');\n\t\tif (!$control.data('fu.placard')) {\n\t\t\t$control.placard($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function () {\n\t\t$('[data-initialize=placard]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.data('fu.placard')) return;\n\t\t\t$this.placard($this.data());\n\t\t});\n\t});\n\t*/\n\t\n\treturn $.fn.placard;\n\n});\n\ndefine('skylark-fuelux/radio',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\"\n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\tvar old = $.fn.radio;\n\n\t// RADIO CONSTRUCTOR AND PROTOTYPE\n\tvar logError = function logError (error) {\n\t\tif (window && window.console && window.console.error) {\n\t\t\twindow.console.error(error);\n\t\t}\n\t};\n\n\tvar Radio = fuelux.Radio = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Radio\",\n\n\t\tinit : function(element,options) {\n\t\t\tthis.options = langx.mixin({}, $.fn.radio.defaults, options);\n\n\t\t\tif (element.tagName.toLowerCase() !== 'label') {\n\t\t\t\tlogError('Radio must be initialized on the `label` that wraps the `input` element. See https://github.com/ExactTarget/fuelux/blob/master/reference/markup/radio.html for example of proper markup. Call `.radio()` on the `<label>` not the `<input>`');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// cache elements\n\t\t\tthis.$label = $(element);\n\t\t\tthis.$radio = this.$label.find('input[type=\"radio\"]');\n\t\t\tthis.groupName = this.$radio.attr('name'); // don't cache group itself since items can be added programmatically\n\n\t\t\tif (!this.options.ignoreVisibilityCheck && this.$radio.css('visibility').match(/hidden|collapse/)) {\n\t\t\t\tlogError('For accessibility reasons, in order for tab and space to function on radio, `visibility` must not be set to `hidden` or `collapse`. See https://github.com/ExactTarget/fuelux/pull/1996 for more details.');\n\t\t\t}\n\n\t\t\t// determine if a toggle container is specified\n\t\t\tvar containerSelector = this.$radio.attr('data-toggle');\n\t\t\tthis.$toggleContainer = $(containerSelector);\n\n\t\t\t// handle internal events\n\t\t\tthis.$radio.on('change', langx.proxy(this.itemchecked, this));\n\n\t\t\t// set default state\n\t\t\tthis.setInitialState();\n\t\t},\n\n\t\tsetInitialState: function setInitialState () {\n\t\t\tvar $radio = this.$radio;\n\n\t\t\t// get current state of input\n\t\t\tvar checked = $radio.prop('checked');\n\t\t\tvar disabled = $radio.prop('disabled');\n\n\t\t\t// sync label class with input state\n\t\t\tthis.setCheckedState($radio, checked);\n\t\t\tthis.setDisabledState($radio, disabled);\n\t\t},\n\n\t\tresetGroup: function resetGroup () {\n\t\t\tvar $radios = $('input[name=\"' + this.groupName + '\"]');\n\t\t\t$radios.each(function resetRadio (index, item) {\n\t\t\t\tvar $radio = $(item);\n\t\t\t\tvar $lbl = $radio.parent();\n\t\t\t\tvar containerSelector = $radio.attr('data-toggle');\n\t\t\t\tvar $containerToggle = $(containerSelector);\n\n\n\t\t\t\t$lbl.removeClass('checked');\n\t\t\t\t$containerToggle.addClass('hidden');\n\t\t\t});\n\t\t},\n\n\t\tsetCheckedState: function setCheckedState (element, checked) {\n\t\t\tvar $radio = element;\n\t\t\tvar $lbl = $radio.parent();\n\t\t\tvar containerSelector = $radio.attr('data-toggle');\n\t\t\tvar $containerToggle = $(containerSelector);\n\n\t\t\tif (checked) {\n\t\t\t\t// reset all items in group\n\t\t\t\tthis.resetGroup();\n\n\t\t\t\t$radio.prop('checked', true);\n\t\t\t\t$lbl.addClass('checked');\n\t\t\t\t$containerToggle.removeClass('hide hidden');\n\t\t\t\t$lbl.trigger('checked.fu.radio');\n\t\t\t} else {\n\t\t\t\t$radio.prop('checked', false);\n\t\t\t\t$lbl.removeClass('checked');\n\t\t\t\t$containerToggle.addClass('hidden');\n\t\t\t\t$lbl.trigger('unchecked.fu.radio');\n\t\t\t}\n\n\t\t\t$lbl.trigger('changed.fu.radio', checked);\n\t\t},\n\n\t\tsetDisabledState: function setDisabledState (element, disabled) {\n\t\t\tvar $radio = $(element);\n\t\t\tvar $lbl = this.$label;\n\n\t\t\tif (disabled) {\n\t\t\t\t$radio.prop('disabled', true);\n\t\t\t\t$lbl.addClass('disabled');\n\t\t\t\t$lbl.trigger('disabled.fu.radio');\n\t\t\t} else {\n\t\t\t\t$radio.prop('disabled', false);\n\t\t\t\t$lbl.removeClass('disabled');\n\t\t\t\t$lbl.trigger('enabled.fu.radio');\n\t\t\t}\n\n\t\t\treturn $radio;\n\t\t},\n\n\t\titemchecked: function itemchecked (evt) {\n\t\t\tvar $radio = $(evt.target);\n\t\t\tthis.setCheckedState($radio, true);\n\t\t},\n\n\t\tcheck: function check () {\n\t\t\tthis.setCheckedState(this.$radio, true);\n\t\t},\n\n\t\tuncheck: function uncheck () {\n\t\t\tthis.setCheckedState(this.$radio, false);\n\t\t},\n\n\t\tisChecked: function isChecked () {\n\t\t\tvar checked = this.$radio.prop('checked');\n\t\t\treturn checked;\n\t\t},\n\n\t\tenable: function enable () {\n\t\t\tthis.setDisabledState(this.$radio, false);\n\t\t},\n\n\t\tdisable: function disable () {\n\t\t\tthis.setDisabledState(this.$radio, true);\n\t\t},\n\n\t\tdestroy: function destroy () {\n\t\t\tthis.$label.remove();\n\t\t\treturn this.$label[0].outerHTML;\n\t\t}\n\n\t});\n\n\n\tRadio.prototype.getValue = Radio.prototype.isChecked;\n\n\t// RADIO PLUGIN DEFINITION\n\n\t$.fn.radio = function radio (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function applyData () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.radio');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.radio', (data = new Radio(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.radio.defaults = {\n\t\tignoreVisibilityCheck: false\n\t};\n\n\t$.fn.radio.Constructor = Radio;\n\n\t$.fn.radio.noConflict = function noConflict () {\n\t\t$.fn.radio = old;\n\t\treturn this;\n\t};\n\n\n\t// DATA-API\n\t/*\n\t$(document).on('mouseover.fu.radio.data-api', '[data-initialize=radio]', function initializeRadios (e) {\n\t\tvar $control = $(e.target);\n\t\tif (!$control.data('fu.radio')) {\n\t\t\t$control.radio($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function onReadyInitializeRadios () {\n\t\t$('[data-initialize=radio]').each(function initializeRadio () {\n\t\t\tvar $this = $(this);\n\t\t\tif (!$this.data('fu.radio')) {\n\t\t\t\t$this.radio($this.data());\n\t\t\t}\n\t\t});\n\t});\n\t*/\n\n\treturn $.fn.radio;\n});\n\ndefine('skylark-fuelux/selectlist',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\",\n  \"skylark-bootstrap3/dropdown\"\n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\tvar old = $.fn.selectlist;\n\t// SELECT CONSTRUCTOR AND PROTOTYPE\n\n\tvar Selectlist = fuelux.Selectlist = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Selectlist\",\n\n\t\tinit : function(element,options) {\n\t\t\tthis.$element = $(element);\n\t\t\tthis.options = langx.mixin({}, $.fn.selectlist.defaults, options);\n\n\n\t\t\tthis.$button = this.$element.find('.btn.dropdown-toggle');\n\t\t\tthis.$hiddenField = this.$element.find('.hidden-field');\n\t\t\tthis.$label = this.$element.find('.selected-label');\n\t\t\tthis.$dropdownMenu = this.$element.find('.dropdown-menu');\n\n\t\t\tthis.$button.dropdown();\n\n\t\t\tthis.$element.on('click.fu.selectlist', '.dropdown-menu a', langx.proxy(this.itemClicked, this));\n\t\t\tthis.setDefaultSelection();\n\n\t\t\tif (options.resize === 'auto' || this.$element.attr('data-resize') === 'auto') {\n\t\t\t\tthis.resize();\n\t\t\t}\n\n\t\t\t// if selectlist is empty or is one item, disable it\n\t\t\tvar items = this.$dropdownMenu.children('li');\n\t\t\tif( items.length === 0) {\n\t\t\t\tthis.disable();\n\t\t\t\tthis.doSelect( $(this.options.emptyLabelHTML));\n\t\t\t}\n\n\t\t\t// support jumping focus to first letter in dropdown when key is pressed\n\t\t\tthis.$element.on('shown.bs.dropdown', function () {\n\t\t\t\t\tvar $this = $(this);\n\t\t\t\t\t// attach key listener when dropdown is shown\n\t\t\t\t\t$(document).on('keypress.fu.selectlist', function(e){\n\n\t\t\t\t\t\t// get the key that was pressed\n\t\t\t\t\t\tvar key = String.fromCharCode(e.which);\n\t\t\t\t\t\t// look the items to find the first item with the first character match and set focus\n\t\t\t\t\t\t$this.find(\"li\").each(function(idx,item){\n\t\t\t\t\t\t\tif ($(item).text().charAt(0).toLowerCase() === key) {\n\t\t\t\t\t\t\t\t$(item).children('a').focus();\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// unbind key event when dropdown is hidden\n\t\t\tthis.$element.on('hide.bs.dropdown', function () {\n\t\t\t\t\t$(document).off('keypress.fu.selectlist');\n\t\t\t});\n\t\t},\n\n\t\tdestroy: function () {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tdoSelect: function ($item) {\n\t\t\tvar $selectedItem;\n\t\t\tthis.$selectedItem = $selectedItem = $item;\n\n\t\t\tthis.$hiddenField.val(this.$selectedItem.attr('data-value'));\n\t\t\tthis.$label.html($(this.$selectedItem.children()[0]).html());\n\n\t\t\t// clear and set selected item to allow declarative init state\n\t\t\t// unlike other controls, selectlist's value is stored internal, not in an input\n\t\t\tthis.$element.find('li').each(function () {\n\t\t\t\tif ($selectedItem.is($(this))) {\n\t\t\t\t\t$(this).attr('data-selected', true);\n\t\t\t\t} else {\n\t\t\t\t\t$(this).removeData('selected').removeAttr('data-selected');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\titemClicked: function (e) {\n\t\t\tthis.$element.trigger('clicked.fu.selectlist', this.$selectedItem);\n\n\t\t\te.preventDefault();\n\t\t\t// ignore if a disabled item is clicked\n\t\t\tif ($(e.currentTarget).parent('li').is('.disabled, :disabled')) { return; }\n\n\t\t\t// is clicked element different from currently selected element?\n\t\t\tif (!($(e.target).parent().is(this.$selectedItem))) {\n\t\t\t\tthis.itemChanged(e);\n\t\t\t}\n\n\t\t\t// return focus to control after selecting an option\n\t\t\tthis.$element.find('.dropdown-toggle').focus();\n\t\t},\n\n\t\titemChanged: function (e) {\n\t\t\t//selectedItem needs to be <li> since the data is stored there, not in <a>\n\t\t\tthis.doSelect($(e.target).closest('li'));\n\n\t\t\t// pass object including text and any data-attributes\n\t\t\t// to onchange event\n\t\t\tvar data = this.selectedItem();\n\t\t\t// trigger changed event\n\t\t\tthis.$element.trigger('changed.fu.selectlist', data);\n\t\t},\n\n\t\tresize: function () {\n\t\t\tvar width = 0;\n\t\t\tvar newWidth = 0;\n\t\t\tvar sizer = $('<div/>').addClass('selectlist-sizer');\n\n\n\t\t\tif (Boolean($(document).find('html').hasClass('fuelux'))) {\n\t\t\t\t// default behavior for fuel ux setup. means fuelux was a class on the html tag\n\t\t\t\t$(document.body).append(sizer);\n\t\t\t} else {\n\t\t\t\t// fuelux is not a class on the html tag. So we'll look for the first one we find so the correct styles get applied to the sizer\n\t\t\t\t$('.fuelux:first').append(sizer);\n\t\t\t}\n\n\t\t\tsizer.append(this.$element.clone());\n\n\t\t\tthis.$element.find('a').each(function () {\n\t\t\t\tsizer.find('.selected-label').text($(this).text());\n\t\t\t\tnewWidth = sizer.find('.selectlist').outerWidth();\n\t\t\t\tnewWidth = newWidth + sizer.find('.sr-only').outerWidth();\n\t\t\t\tif (newWidth > width) {\n\t\t\t\t\twidth = newWidth;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (width <= 1) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$button.css('width', width);\n\t\t\tthis.$dropdownMenu.css('width', width);\n\n\t\t\tsizer.remove();\n\t\t},\n\n\t\tselectedItem: function () {\n\t\t\tvar txt = this.$selectedItem.text();\n\t\t\treturn langx.mixin({\n\t\t\t\ttext: txt\n\t\t\t}, this.$selectedItem.data());\n\t\t},\n\n\t\tselectByText: function (text) {\n\t\t\tvar $item = $([]);\n\t\t\tthis.$element.find('li').each(function () {\n\t\t\t\tif ((this.textContent || this.innerText || $(this).text() || '').toLowerCase() === (text || '').toLowerCase()) {\n\t\t\t\t\t$item = $(this);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.doSelect($item);\n\t\t},\n\n\t\tselectByValue: function (value) {\n\t\t\tvar selector = 'li[data-value=\"' + value + '\"]';\n\t\t\tthis.selectBySelector(selector);\n\t\t},\n\n\t\tselectByIndex: function (index) {\n\t\t\t// zero-based index\n\t\t\tvar selector = 'li:eq(' + index + ')';\n\t\t\tthis.selectBySelector(selector);\n\t\t},\n\n\t\tselectBySelector: function (selector) {\n\t\t\tvar $item = this.$element.find(selector);\n\t\t\tthis.doSelect($item);\n\t\t},\n\n\t\tsetDefaultSelection: function () {\n\t\t\tvar $item = this.$element.find('li[data-selected=true]').eq(0);\n\n\t\t\tif ($item.length === 0) {\n\t\t\t\t$item = this.$element.find('li').has('a').eq(0);\n\t\t\t}\n\n\t\t\tthis.doSelect($item);\n\t\t},\n\n\t\tenable: function () {\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$button.removeClass('disabled');\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$button.addClass('disabled');\n\t\t}\n\n\t});\t\n\n\n\tSelectlist.prototype.getValue = Selectlist.prototype.selectedItem;\n\n\n\t// SELECT PLUGIN DEFINITION\n\n\t$.fn.selectlist = function (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.selectlist');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.selectlist', (data = new Selectlist(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.selectlist.defaults = {\n\t\temptyLabelHTML: '<li data-value=\"\"><a href=\"#\">No items</a></li>'\n\t};\n\n\t$.fn.selectlist.Constructor = Selectlist;\n\n\t$.fn.selectlist.noConflict = function () {\n\t\t$.fn.selectlist = old;\n\t\treturn this;\n\t};\n\n\n\t// DATA-API\n\n\t/*\n\t$(document).on('mousedown.fu.selectlist.data-api', '[data-initialize=selectlist]', function (e) {\n\t\tvar $control = $(e.target).closest('.selectlist');\n\t\tif (!$control.data('fu.selectlist')) {\n\t\t\t$control.selectlist($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function () {\n\t\t$('[data-initialize=selectlist]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif (!$this.data('fu.selectlist')) {\n\t\t\t\t$this.selectlist($this.data());\n\t\t\t}\n\t\t});\n\t});\n\n\t*/\n\n\treturn $.fn.selectlist;\n});\n\ndefine('skylark-fuelux/spinbox',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\"\n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\tvar old = $.fn.spinbox;\n\n\t// SPINBOX CONSTRUCTOR AND PROTOTYPE\n\n\tvar Spinbox = fuelux.Spinbox = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Spinbox\",\n\n\t\tinit : function(element,options) {\n\t\t\tthis.$element = $(element);\n\t\t\tthis.$element.find('.btn').on('click', function (e) {\n\t\t\t\t//keep spinbox from submitting if they forgot to say type=\"button\" on their spinner buttons\n\t\t\t\te.preventDefault();\n\t\t\t});\n\t\t\tthis.options = langx.mixin({}, $.fn.spinbox.defaults, options);\n\t\t\tthis.options.step = this.$element.data('step') || this.options.step;\n\n\t\t\tif (this.options.value < this.options.min) {\n\t\t\t\tthis.options.value = this.options.min;\n\t\t\t} else if (this.options.max < this.options.value) {\n\t\t\t\tthis.options.value = this.options.max;\n\t\t\t}\n\n\t\t\tthis.$input = this.$element.find('.spinbox-input');\n\t\t\tthis.$input.on('focusout.fu.spinbox', this.$input, langx.proxy(this.change, this));\n\t\t\tthis.$element.on('keydown.fu.spinbox', this.$input, langx.proxy(this.keydown, this));\n\t\t\tthis.$element.on('keyup.fu.spinbox', this.$input, langx.proxy(this.keyup, this));\n\n\t\t\tif (this.options.hold) {\n\t\t\t\tthis.$element.on('mousedown.fu.spinbox', '.spinbox-up', langx.proxy(function () {\n\t\t\t\t\tthis.startSpin(true);\n\t\t\t\t}, this));\n\t\t\t\tthis.$element.on('mouseup.fu.spinbox', '.spinbox-up, .spinbox-down', langx.proxy(this.stopSpin, this));\n\t\t\t\tthis.$element.on('mouseout.fu.spinbox', '.spinbox-up, .spinbox-down', langx.proxy(this.stopSpin, this));\n\t\t\t\tthis.$element.on('mousedown.fu.spinbox', '.spinbox-down', langx.proxy(function () {\n\t\t\t\t\tthis.startSpin(false);\n\t\t\t\t}, this));\n\t\t\t} else {\n\t\t\t\tthis.$element.on('click.fu.spinbox', '.spinbox-up', langx.proxy(function () {\n\t\t\t\t\tthis.step(true);\n\t\t\t\t}, this));\n\t\t\t\tthis.$element.on('click.fu.spinbox', '.spinbox-down', langx.proxy(function () {\n\t\t\t\t\tthis.step(false);\n\t\t\t\t}, this));\n\t\t\t}\n\n\t\t\tthis.switches = {\n\t\t\t\tcount: 1,\n\t\t\t\tenabled: true\n\t\t\t};\n\n\t\t\tif (this.options.speed === 'medium') {\n\t\t\t\tthis.switches.speed = 300;\n\t\t\t} else if (this.options.speed === 'fast') {\n\t\t\t\tthis.switches.speed = 100;\n\t\t\t} else {\n\t\t\t\tthis.switches.speed = 500;\n\t\t\t}\n\n\t\t\tthis.options.defaultUnit = _isUnitLegal(this.options.defaultUnit, this.options.units) ? this.options.defaultUnit : '';\n\t\t\tthis.unit = this.options.defaultUnit;\n\n\t\t\tthis.lastValue = this.options.value;\n\n\t\t\tthis.render();\n\n\t\t\tif (this.options.disabled) {\n\t\t\t\tthis.disable();\n\t\t\t}\n\t\t},\n\n\t\tdestroy: function destroy() {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\t\t\t// set input value attrbute\n\t\t\tthis.$element.find('input').each(function () {\n\t\t\t\t$(this).attr('value', $(this).val());\n\t\t\t});\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\trender: function render() {\n\t\t\tthis._setValue(this.getDisplayValue());\n\t\t},\n\n\t\tchange: function change() {\n\t\t\tthis._setValue(this.getDisplayValue());\n\n\t\t\tthis.triggerChangedEvent();\n\t\t},\n\n\t\tstopSpin: function stopSpin() {\n\t\t\tif (this.switches.timeout !== undefined) {\n\t\t\t\tclearTimeout(this.switches.timeout);\n\t\t\t\tthis.switches.count = 1;\n\t\t\t\tthis.triggerChangedEvent();\n\t\t\t}\n\t\t},\n\n\t\ttriggerChangedEvent: function triggerChangedEvent() {\n\t\t\tvar currentValue = this.getValue();\n\t\t\tif (currentValue === this.lastValue) return;\n\t\t\tthis.lastValue = currentValue;\n\n\t\t\t// Primary changed event\n\t\t\tthis.$element.trigger('changed.fu.spinbox', currentValue);\n\t\t},\n\n\t\tstartSpin: function startSpin(type) {\n\t\t\tif (!this.options.disabled) {\n\t\t\t\tvar divisor = this.switches.count;\n\n\t\t\t\tif (divisor === 1) {\n\t\t\t\t\tthis.step(type);\n\t\t\t\t\tdivisor = 1;\n\t\t\t\t} else if (divisor < 3) {\n\t\t\t\t\tdivisor = 1.5;\n\t\t\t\t} else if (divisor < 8) {\n\t\t\t\t\tdivisor = 2.5;\n\t\t\t\t} else {\n\t\t\t\t\tdivisor = 4;\n\t\t\t\t}\n\n\t\t\t\tthis.switches.timeout = setTimeout(langx.proxy(function () {\n\t\t\t\t\tthis.iterate(type);\n\t\t\t\t}, this), this.switches.speed / divisor);\n\t\t\t\tthis.switches.count++;\n\t\t\t}\n\t\t},\n\n\t\titerate: function iterate(type) {\n\t\t\tthis.step(type);\n\t\t\tthis.startSpin(type);\n\t\t},\n\n\t\tstep: function step(isIncrease) {\n\t\t\t//refresh value from display before trying to increment in case they have just been typing before clicking the nubbins\n\t\t\tthis._setValue(this.getDisplayValue());\n\t\t\tvar newVal;\n\n\t\t\tif (isIncrease) {\n\t\t\t\tnewVal = this.options.value + this.options.step;\n\t\t\t} else {\n\t\t\t\tnewVal = this.options.value - this.options.step;\n\t\t\t}\n\n\t\t\tnewVal = newVal.toFixed(5);\n\n\t\t\tthis._setValue(newVal + this.unit);\n\t\t},\n\n\t\tgetDisplayValue: function getDisplayValue() {\n\t\t\tvar inputValue = this.parseInput(this.$input.val());\n\t\t\tvar value = (!!inputValue) ? inputValue : this.options.value;\n\t\t\treturn value;\n\t\t},\n\n\t\tsetDisplayValue: function setDisplayValue(value) {\n\t\t\tthis.$input.val(value);\n\t\t},\n\n\t\tgetValue: function getValue() {\n\t\t\tvar val = this.options.value;\n\t\t\tif (this.options.decimalMark !== '.'){\n\t\t\t\tval = (val + '').split('.').join(this.options.decimalMark);\n\t\t\t}\n\t\t\treturn val + this.unit;\n\t\t},\n\n\t\tsetValue: function setValue(val) {\n\t\t\treturn this._setValue(val, true);\n\t\t},\n\n\t\t_setValue: function _setValue(val, shouldSetLastValue) {\n\t\t\t//remove any i18n on the number\n\t\t\tif (this.options.decimalMark !== '.') {\n\t\t\t\tval = this.parseInput(val);\n\t\t\t}\n\n\t\t\t//are we dealing with united numbers?\n\t\t\tif(typeof val !== \"number\"){\n\t\t\t\tvar potentialUnit = val.replace(/[0-9.-]/g, '');\n\t\t\t\t//make sure unit is valid, or else drop it in favor of current unit, or default unit (potentially nothing)\n\t\t\t\tthis.unit = _isUnitLegal(potentialUnit, this.options.units) ? potentialUnit : this.options.defaultUnit;\n\t\t\t}\n\n\t\t\tvar intVal = this.getIntValue(val);\n\n\t\t\t//make sure we are dealing with a number\n\t\t\tif (isNaN(intVal) && !isFinite(intVal)) {\n\t\t\t\treturn this._setValue(this.options.value, shouldSetLastValue);\n\t\t\t}\n\n\t\t\t//conform\n\t\t\tintVal = _applyLimits.call(this, intVal);\n\n\t\t\t//cache the pure int value\n\t\t\tthis.options.value = intVal;\n\n\t\t\t//prepare number for display\n\t\t\tval = intVal + this.unit;\n\n\t\t\tif (this.options.decimalMark !== '.'){\n\t\t\t\tval = (val + '').split('.').join(this.options.decimalMark);\n\t\t\t}\n\n\t\t\t//display number\n\t\t\tthis.setDisplayValue(val);\n\n\t\t\tif (shouldSetLastValue) {\n\t\t\t\tthis.lastValue = val;\n\t\t\t}\n\n\t\t\treturn this;\n\t\t},\n\n\t\tvalue: function value(val) {\n\t\t\tif (val || val === 0) {\n\t\t\t\treturn this.setValue(val);\n\t\t\t} else {\n\t\t\t\treturn this.getValue();\n\t\t\t}\n\t\t},\n\n\t\tparseInput: function parseInput(value) {\n\t\t\tvalue = (value + '').split(this.options.decimalMark).join('.');\n\n\t\t\treturn value;\n\t\t},\n\n\t\tgetIntValue: function getIntValue(value) {\n\t\t\t//if they didn't pass in a number, try and get the number\n\t\t\tvalue = (typeof value === \"undefined\") ? this.getValue() : value;\n\t\t\t// if there still isn't a number, abort\n\t\t\tif(typeof value === \"undefined\"){return;}\n\n\t\t\tif (typeof value === 'string'){\n\t\t\t\tvalue = this.parseInput(value);\n\t\t\t}\n\n\t\t\tvalue = parseFloat(value, 10);\n\n\t\t\treturn value;\n\t\t},\n\n\t\tdisable: function disable() {\n\t\t\tthis.options.disabled = true;\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$input.attr('disabled', '');\n\t\t\tthis.$element.find('button').addClass('disabled');\n\t\t},\n\n\t\tenable: function enable() {\n\t\t\tthis.options.disabled = false;\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$input.removeAttr('disabled');\n\t\t\tthis.$element.find('button').removeClass('disabled');\n\t\t},\n\n\t\tkeydown: function keydown(event) {\n\t\t\tvar keyCode = event.keyCode;\n\t\t\tif (keyCode === 38) {\n\t\t\t\tthis.step(true);\n\t\t\t} else if (keyCode === 40) {\n\t\t\t\tthis.step(false);\n\t\t\t} else if (keyCode === 13) {\n\t\t\t\tthis.change();\n\t\t\t}\n\t\t},\n\n\t\tkeyup: function keyup(event) {\n\t\t\tvar keyCode = event.keyCode;\n\n\t\t\tif (keyCode === 38 || keyCode === 40) {\n\t\t\t\tthis.triggerChangedEvent();\n\t\t\t}\n\t\t}\n\n\t});\t\n\n\t// Truly private methods\n\tvar _limitToStep = function _limitToStep(number, step) {\n\t\treturn Math.round(number / step) * step;\n\t};\n\n\tvar _isUnitLegal = function _isUnitLegal(unit, validUnits) {\n\t\tvar legalUnit = false;\n\t\tvar suspectUnit = unit.toLowerCase();\n\n\t\tlangx.each(validUnits, function (i, validUnit) {\n\t\t\tvalidUnit = validUnit.toLowerCase();\n\t\t\tif (suspectUnit === validUnit) {\n\t\t\t\tlegalUnit = true;\n\t\t\t\treturn false;//break out of the loop\n\t\t\t}\n\t\t});\n\n\t\treturn legalUnit;\n\t};\n\n\tvar _applyLimits = function _applyLimits(value) {\n\t\t// if unreadable\n\t\tif (isNaN(parseFloat(value))) {\n\t\t\treturn value;\n\t\t}\n\n\t\t// if not within range return the limit\n\t\tif (value > this.options.max) {\n\t\t\tif (this.options.cycle) {\n\t\t\t\tvalue = this.options.min;\n\t\t\t} else {\n\t\t\t\tvalue = this.options.max;\n\t\t\t}\n\t\t} else if (value < this.options.min) {\n\t\t\tif (this.options.cycle) {\n\t\t\t\tvalue = this.options.max;\n\t\t\t} else {\n\t\t\t\tvalue = this.options.min;\n\t\t\t}\n\t\t}\n\n\t\tif (this.options.limitToStep && this.options.step) {\n\t\t\tvalue = _limitToStep(value, this.options.step);\n\n\t\t\t//force round direction so that it stays within bounds\n\t\t\tif(value > this.options.max){\n\t\t\t\tvalue = value - this.options.step;\n\t\t\t} else if(value < this.options.min) {\n\t\t\t\tvalue = value + this.options.step;\n\t\t\t}\n\t\t}\n\n\t\treturn value;\n\t};\n\n\t// SPINBOX PLUGIN DEFINITION\n\n\t$.fn.spinbox = function spinbox(option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.spinbox');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.spinbox', (data = new Spinbox(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t// value needs to be 0 for this.render();\n\t$.fn.spinbox.defaults = {\n\t\tvalue: 0,\n\t\tmin: 0,\n\t\tmax: 999,\n\t\tstep: 1,\n\t\thold: true,\n\t\tspeed: 'medium',\n\t\tdisabled: false,\n\t\tcycle: false,\n\t\tunits: [],\n\t\tdecimalMark: '.',\n\t\tdefaultUnit: '',\n\t\tlimitToStep: false\n\t};\n\n\t$.fn.spinbox.Constructor = Spinbox;\n\n\t$.fn.spinbox.noConflict = function noConflict() {\n\t\t$.fn.spinbox = old;\n\t\treturn this;\n\t};\n\n\n\t// DATA-API\n\n\t/*\n\t$(document).on('mousedown.fu.spinbox.data-api', '[data-initialize=spinbox]', function (e) {\n\t\tvar $control = $(e.target).closest('.spinbox');\n\t\tif (!$control.data('fu.spinbox')) {\n\t\t\t$control.spinbox($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function () {\n\t\t$('[data-initialize=spinbox]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif (!$this.data('fu.spinbox')) {\n\t\t\t\t$this.spinbox($this.data());\n\t\t\t}\n\t\t});\n\t});\n\t*/\n\n\treturn $.fn.spinbox;\n});\n\ndefine('skylark-fuelux/scheduler',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\",\n  \"./combobox\",\n  \"./datepicker\",\n  \"./radio\",\n  \"./selectlist\",\n  \"./spinbox\"\n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\t// -- END UMD WRAPPER PREFACE --\n\n\t// -- BEGIN MODULE CODE HERE --\n\n\tvar old = $.fn.scheduler;\n\n\t// SCHEDULER CONSTRUCTOR AND PROTOTYPE\n\n\tvar Scheduler = fuelux.Scheduler = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Scheduler\",\n\n\t\tinit : function(element,options) {\n\t\t\tvar self = this;\n\n\t\t\tthis.$element = $(element);\n\t\t\tthis.options = langx.mixin({}, $.fn.scheduler.defaults, options);\n\n\t\t\t// cache elements\n\t\t\tthis.$startDate = this.$element.find('.start-datetime .start-date');\n\t\t\tthis.$startTime = this.$element.find('.start-datetime .start-time');\n\n\t\t\tthis.$timeZone = this.$element.find('.timezone-container .timezone');\n\n\t\t\tthis.$repeatIntervalPanel = this.$element.find('.repeat-every-panel');\n\t\t\tthis.$repeatIntervalSelect = this.$element.find('.repeat-options');\n\n\t\t\tthis.$repeatIntervalSpinbox = this.$element.find('.repeat-every');\n\t\t\tthis.$repeatIntervalTxt = this.$element.find('.repeat-every-text');\n\n\t\t\tthis.$end = this.$element.find('.repeat-end');\n\t\t\tthis.$endSelect = this.$end.find('.end-options');\n\t\t\tthis.$endAfter = this.$end.find('.end-after');\n\t\t\tthis.$endDate = this.$end.find('.end-on-date');\n\n\t\t\t// panels\n\t\t\tthis.$recurrencePanels = this.$element.find('.repeat-panel');\n\n\n\t\t\tthis.$repeatIntervalSelect.selectlist();\n\n\t\t\t//initialize sub-controls\n\t\t\tthis.$element.find('.selectlist').selectlist();\n\t\t\tthis.$startDate.datepicker(this.options.startDateOptions);\n\n\t\t\tvar startDateResponse = (typeof this.options.startDateChanged === \"function\") ? this.options.startDateChanged : this._guessEndDate;\n\t\t\tthis.$startDate.on('change changed.fu.datepicker dateClicked.fu.datepicker', langx.proxy(startDateResponse, this));\n\n\t\t\tthis.$startTime.combobox();\n\t\t\t// init start time\n\t\t\tif (this.$startTime.find('input').val() === '') {\n\t\t\t\tthis.$startTime.combobox('selectByIndex', 0);\n\t\t\t}\n\n\t\t\t// every 0 days/hours doesn't make sense, change if not set\n\t\t\tif (this.$repeatIntervalSpinbox.find('input').val() === '0') {\n\t\t\t\tthis.$repeatIntervalSpinbox.spinbox({\n\t\t\t\t\t'value': 1,\n\t\t\t\t\t'min': 1,\n\t\t\t\t\t'limitToStep': true\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.$repeatIntervalSpinbox.spinbox({\n\t\t\t\t\t'min': 1,\n\t\t\t\t\t'limitToStep': true\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.$endAfter.spinbox({\n\t\t\t\t'value': 1,\n\t\t\t\t'min': 1,\n\t\t\t\t'limitToStep': true\n\t\t\t});\n\t\t\tthis.$endDate.datepicker(this.options.endDateOptions);\n\t\t\tthis.$element.find('.radio-custom').radio();\n\n\t\t\t// bind events: 'change' is a Bootstrap JS fired event\n\t\t\tthis.$repeatIntervalSelect.on('changed.fu.selectlist', langx.proxy(this.repeatIntervalSelectChanged, this));\n\t\t\tthis.$endSelect.on('changed.fu.selectlist', langx.proxy(this.endSelectChanged, this));\n\t\t\tthis.$element.find('.repeat-days-of-the-week .btn-group .btn').on('change.fu.scheduler', function (e, data) {\n\t\t\t\tself.changed(e, data, true);\n\t\t\t});\n\t\t\tthis.$element.find('.combobox').on('changed.fu.combobox', langx.proxy(this.changed, this));\n\t\t\tthis.$element.find('.datepicker').on('changed.fu.datepicker', langx.proxy(this.changed, this));\n\t\t\tthis.$element.find('.datepicker').on('dateClicked.fu.datepicker', langx.proxy(this.changed, this));\n\t\t\tthis.$element.find('.selectlist').on('changed.fu.selectlist', langx.proxy(this.changed, this));\n\t\t\tthis.$element.find('.spinbox').on('changed.fu.spinbox', langx.proxy(this.changed, this));\n\t\t\tthis.$element.find('.repeat-monthly .radio-custom, .repeat-yearly .radio-custom').on('change.fu.scheduler', langx.proxy(this.changed, this));\n\t\t},\n\n\t\tdestroy: function destroy() {\n\t\t\tvar markup;\n\t\t\t// set input value attribute\n\t\t\tthis.$element.find('input').each(function () {\n\t\t\t\t$(this).attr('value', $(this).val());\n\t\t\t});\n\n\t\t\t// empty elements to return to original markup and store\n\t\t\tthis.$element.find('.datepicker .calendar').empty();\n\n\t\t\tmarkup = this.$element[0].outerHTML;\n\n\t\t\t// destroy components\n\t\t\tthis.$element.find('.combobox').combobox('destroy');\n\t\t\tthis.$element.find('.datepicker').datepicker('destroy');\n\t\t\tthis.$element.find('.selectlist').selectlist('destroy');\n\t\t\tthis.$element.find('.spinbox').spinbox('destroy');\n\t\t\tthis.$element.find('.radio-custom').radio('destroy');\n\t\t\tthis.$element.remove();\n\n\t\t\t// any external bindings\n\t\t\t// [none]\n\n\t\t\treturn markup;\n\t\t},\n\n\t\tchanged: function changed(e, data, propagate) {\n\t\t\tif (!propagate) {\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\n\t\t\tthis.$element.trigger('changed.fu.scheduler', {\n\t\t\t\tdata: (data !== undefined) ? data : $(e.currentTarget).data(),\n\t\t\t\toriginalEvent: e,\n\t\t\t\tvalue: this.getValue()\n\t\t\t});\n\t\t},\n\n\t\tdisable: function disable() {\n\t\t\tthis.toggleState('disable');\n\t\t},\n\n\t\tenable: function enable() {\n\t\t\tthis.toggleState('enable');\n\t\t},\n\n\t\tsetUtcTime: function setUtcTime(day, time, offset) {\n\t\t\tvar dateSplit = day.split('-');\n\t\t\tvar timeSplit = time.split(':');\n\t\t\tfunction z(n) {\n\t\t\t\treturn (n < 10 ? '0' : '') + n;\n\t\t\t}\n\n\t\t\tvar utcDate = new Date(Date.UTC(dateSplit[0], (dateSplit[1] - 1), dateSplit[2], timeSplit[0], timeSplit[1], (timeSplit[2] ? timeSplit[2] : 0)));\n\n\t\t\tif (offset === 'Z') {\n\t\t\t\tutcDate.setUTCHours(utcDate.getUTCHours() + 0);\n\t\t\t} else {\n\t\t\t\tvar expression = [];\n\t\t\t\texpression[0] = '(.)'; // Any Single Character 1\n\t\t\t\texpression[1] = '.*?'; // Non-greedy match on filler\n\t\t\t\texpression[2] = '\\\\d'; // Uninteresting and ignored: d\n\t\t\t\texpression[3] = '.*?'; // Non-greedy match on filler\n\t\t\t\texpression[4] = '(\\\\d)'; // Any Single Digit 1\n\n\t\t\t\tvar p = new RegExp(expression.join(''), [\"i\"]);\n\t\t\t\tvar offsetMatch = p.exec(offset);\n\t\t\t\tif (offsetMatch !== null) {\n\t\t\t\t\tvar offsetDirection = offsetMatch[1];\n\t\t\t\t\tvar offsetInteger = offsetMatch[2];\n\t\t\t\t\tvar modifier = (offsetDirection === '+') ? 1 : -1;\n\n\t\t\t\t\tutcDate.setUTCHours(utcDate.getUTCHours() + (modifier * parseInt(offsetInteger, 10)));\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar localDifference = utcDate.getTimezoneOffset();\n\t\t\tutcDate.setMinutes(localDifference);\n\t\t\treturn utcDate;\n\t\t},\n\n\t\t// called when the end range changes\n\t\t// (Never, After, On date)\n\t\tendSelectChanged: function endSelectChanged(e, data) {\n\t\t\tvar selectedItem, val;\n\n\t\t\tif (!data) {\n\t\t\t\tselectedItem = this.$endSelect.selectlist('selectedItem');\n\t\t\t\tval = selectedItem.value;\n\t\t\t} else {\n\t\t\t\tval = data.value;\n\t\t\t}\n\n\t\t\t// hide all panels\n\t\t\tthis.$endAfter.parent().addClass('hidden');\n\t\t\tthis.$endAfter.parent().attr('aria-hidden', 'true');\n\n\t\t\tthis.$endDate.parent().addClass('hidden');\n\t\t\tthis.$endDate.parent().attr('aria-hidden', 'true');\n\n\t\t\tif (val === 'after') {\n\t\t\t\tthis.$endAfter.parent().removeClass('hide hidden'); // jQuery deprecated hide in 3.0. Use hidden instead. Leaving hide here to support previous markup\n\t\t\t\tthis.$endAfter.parent().attr('aria-hidden', 'false');\n\t\t\t} else if (val === 'date') {\n\t\t\t\tthis.$endDate.parent().removeClass('hide hidden');\t// jQuery deprecated hide in 3.0. Use hidden instead. Leaving hide here to support previous markup\n\t\t\t\tthis.$endDate.parent().attr('aria-hidden', 'false');\n\t\t\t}\n\t\t},\n\n\t\t_guessEndDate: function _guessEndDate() {\n\t\t\tvar interval = this.$repeatIntervalSelect.selectlist('selectedItem').value;\n\t\t\tvar end = new Date(this.$endDate.datepicker('getDate'));\n\t\t\tvar start = new Date(this.$startDate.datepicker('getDate'));\n\t\t\tvar increment = this.$repeatIntervalSpinbox.find('input').val();\n\n\t\t\tif(interval !== \"none\" && end <= start){\n\t\t\t\t// if increment spinbox is hidden, user has no idea what it is set to and it is probably not set to\n\t\t\t\t// something they intended. Safest option is to set date forward by an increment of 1.\n\t\t\t\t// this will keep monthly & yearly from auto-incrementing by more than a single interval\n\t\t\t\tif(!this.$repeatIntervalSpinbox.is(':visible')){\n\t\t\t\t\tincrement = 1;\n\t\t\t\t}\n\n\t\t\t\t// treat weekdays as weekly. This treats all \"weekdays\" as a single set, of which a single increment\n\t\t\t\t// is one week.\n\t\t\t\tif(interval === \"weekdays\"){\n\t\t\t\t\tincrement = 1;\n\t\t\t\t\tinterval = \"weekly\";\n\t\t\t\t}\n\n\t\t\t\tend = _incrementDate(start, end, interval, increment);\n\n\t\t\t\tthis.$endDate.datepicker('setDate', end);\n\t\t\t}\n\t\t},\n\n\t\tgetValue: function getValue() {\n\t\t\t// FREQ = frequency (secondly, minutely, hourly, daily, weekdays, weekly, monthly, yearly)\n\t\t\t// BYDAY = when picking days (MO,TU,WE,etc)\n\t\t\t// BYMONTH = when picking months (Jan,Feb,March) - note the values should be 1,2,3...\n\t\t\t// BYMONTHDAY = when picking days of the month (1,2,3...)\n\t\t\t// BYSETPOS = when picking First,Second,Third,Fourth,Last (1,2,3,4,-1)\n\n\t\t\tvar interval = this.$repeatIntervalSpinbox.spinbox('value');\n\t\t\tvar pattern = '';\n\t\t\tvar repeat = this.$repeatIntervalSelect.selectlist('selectedItem').value;\n\t\t\tvar startTime;\n\n\t\t\tif (this.$startTime.combobox('selectedItem').value) {\n\t\t\t\tstartTime = this.$startTime.combobox('selectedItem').value;\n\t\t\t\tstartTime = startTime.toLowerCase();\n\n\t\t\t} else {\n\t\t\t\tstartTime = this.$startTime.combobox('selectedItem').text.toLowerCase();\n\t\t\t}\n\n\t\t\tvar timeZone = this.$timeZone.selectlist('selectedItem');\n\t\t\tvar day, days, hasAm, hasPm, month, pos, startDateTime, type;\n\n\t\t\tstartDateTime = '' + _getFormattedDate(this.$startDate.datepicker('getDate'), '-');\n\n\t\t\tstartDateTime += 'T';\n\t\t\thasAm = (startTime.search('am') >= 0);\n\t\t\thasPm = (startTime.search('pm') >= 0);\n\t\t\tstartTime = langx.trim(startTime.replace(/am/g, '').replace(/pm/g, '')).split(':');\n\t\t\tstartTime[0] = parseInt(startTime[0], 10);\n\t\t\tstartTime[1] = parseInt(startTime[1], 10);\n\t\t\tif (hasAm && startTime[0] > 11) {\n\t\t\t\tstartTime[0] = 0;\n\t\t\t} else if (hasPm && startTime[0] < 12) {\n\t\t\t\tstartTime[0] += 12;\n\t\t\t}\n\n\t\t\tstartDateTime += (startTime[0] < 10) ? '0' + startTime[0] : startTime[0];\n\t\t\tstartDateTime += ':';\n\t\t\tstartDateTime += (startTime[1] < 10) ? '0' + startTime[1] : startTime[1];\n\n\t\t\tstartDateTime += (timeZone.offset === '+00:00') ? 'Z' : timeZone.offset;\n\n\t\t\tif (repeat === 'none') {\n\t\t\t\tpattern = 'FREQ=DAILY;INTERVAL=1;COUNT=1;';\n\t\t\t} else if (repeat === 'secondly') {\n\t\t\t\tpattern = 'FREQ=SECONDLY;';\n\t\t\t\tpattern += 'INTERVAL=' + interval + ';';\n\t\t\t} else if (repeat === 'minutely') {\n\t\t\t\tpattern = 'FREQ=MINUTELY;';\n\t\t\t\tpattern += 'INTERVAL=' + interval + ';';\n\t\t\t} else if (repeat === 'hourly') {\n\t\t\t\tpattern = 'FREQ=HOURLY;';\n\t\t\t\tpattern += 'INTERVAL=' + interval + ';';\n\t\t\t} else if (repeat === 'daily') {\n\t\t\t\tpattern += 'FREQ=DAILY;';\n\t\t\t\tpattern += 'INTERVAL=' + interval + ';';\n\t\t\t} else if (repeat === 'weekdays') {\n\t\t\t\tpattern += 'FREQ=WEEKLY;';\n\t\t\t\tpattern += 'BYDAY=MO,TU,WE,TH,FR;';\n\t\t\t\tpattern += 'INTERVAL=1;';\n\t\t\t} else if (repeat === 'weekly') {\n\t\t\t\tdays = [];\n\t\t\t\tthis.$element.find('.repeat-days-of-the-week .btn-group input:checked').each(function () {\n\t\t\t\t\tdays.push($(this).data().value);\n\t\t\t\t});\n\n\t\t\t\tpattern += 'FREQ=WEEKLY;';\n\t\t\t\tpattern += 'BYDAY=' + days.join(',') + ';';\n\t\t\t\tpattern += 'INTERVAL=' + interval + ';';\n\t\t\t} else if (repeat === 'monthly') {\n\t\t\t\tpattern += 'FREQ=MONTHLY;';\n\t\t\t\tpattern += 'INTERVAL=' + interval + ';';\n\t\t\t\ttype = this.$element.find('input[name=repeat-monthly]:checked').val();\n\n\t\t\t\tif (type === 'bymonthday') {\n\t\t\t\t\tday = parseInt(this.$element.find('.repeat-monthly-date .selectlist').selectlist('selectedItem').text, 10);\n\t\t\t\t\tpattern += 'BYMONTHDAY=' + day + ';';\n\t\t\t\t} else if (type === 'bysetpos') {\n\t\t\t\t\tdays = this.$element.find('.repeat-monthly-day .month-days').selectlist('selectedItem').value;\n\t\t\t\t\tpos = this.$element.find('.repeat-monthly-day .month-day-pos').selectlist('selectedItem').value;\n\t\t\t\t\tpattern += 'BYDAY=' + days + ';';\n\t\t\t\t\tpattern += 'BYSETPOS=' + pos + ';';\n\t\t\t\t}\n\n\t\t\t} else if (repeat === 'yearly') {\n\t\t\t\tpattern += 'FREQ=YEARLY;';\n\t\t\t\ttype = this.$element.find('input[name=repeat-yearly]:checked').val();\n\n\t\t\t\tif (type === 'bymonthday') {\n\t\t\t\t\t// there are multiple .year-month classed elements in scheduler markup\n\t\t\t\t\tmonth = this.$element.find('.repeat-yearly-date .year-month').selectlist('selectedItem').value;\n\t\t\t\t\tday = this.$element.find('.repeat-yearly-date .year-month-day').selectlist('selectedItem').text;\n\t\t\t\t\tpattern += 'BYMONTH=' + month + ';';\n\t\t\t\t\tpattern += 'BYMONTHDAY=' + day + ';';\n\t\t\t\t} else if (type === 'bysetpos') {\n\t\t\t\t\tdays = this.$element.find('.repeat-yearly-day .year-month-days').selectlist('selectedItem').value;\n\t\t\t\t\tpos = this.$element.find('.repeat-yearly-day .year-month-day-pos').selectlist('selectedItem').value;\n\t\t\t\t\t// there are multiple .year-month classed elements in scheduler markup\n\t\t\t\t\tmonth = this.$element.find('.repeat-yearly-day .year-month').selectlist('selectedItem').value;\n\n\t\t\t\t\tpattern += 'BYDAY=' + days + ';';\n\t\t\t\t\tpattern += 'BYSETPOS=' + pos + ';';\n\t\t\t\t\tpattern += 'BYMONTH=' + month + ';';\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar end = this.$endSelect.selectlist('selectedItem').value;\n\t\t\tvar duration = '';\n\n\t\t\t// if both UNTIL and COUNT are not specified, the recurrence will repeat forever\n\t\t\t// http://tools.ietf.org/html/rfc2445#section-4.3.10\n\t\t\tif (repeat !== 'none') {\n\t\t\t\tif (end === 'after') {\n\t\t\t\t\tduration = 'COUNT=' + this.$endAfter.spinbox('value') + ';';\n\t\t\t\t} else if (end === 'date') {\n\t\t\t\t\tduration = 'UNTIL=' + _getFormattedDate(this.$endDate.datepicker('getDate'), '') + ';';\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tpattern += duration;\n\t\t\t// remove trailing semicolon\n\t\t\tpattern = pattern.substring(pattern.length - 1) === ';' ? pattern.substring(0, pattern.length - 1) : pattern;\n\n\t\t\tvar data = {\n\t\t\t\tstartDateTime: startDateTime,\n\t\t\t\ttimeZone: timeZone,\n\t\t\t\trecurrencePattern: pattern\n\t\t\t};\n\n\t\t\treturn data;\n\t\t},\n\n\t\t// called when the repeat interval changes\n\t\t// (None, Hourly, Daily, Weekdays, Weekly, Monthly, Yearly\n\t\trepeatIntervalSelectChanged: function repeatIntervalSelectChanged(e, data) {\n\t\t\tvar selectedItem, val, txt;\n\n\t\t\tif (!data) {\n\t\t\t\tselectedItem = this.$repeatIntervalSelect.selectlist('selectedItem');\n\t\t\t\tval = selectedItem.value || \"\";\n\t\t\t\ttxt = selectedItem.text || \"\";\n\t\t\t} else {\n\t\t\t\tval = data.value;\n\t\t\t\ttxt = data.text;\n\t\t\t}\n\n\t\t\t// set the text\n\t\t\tthis.$repeatIntervalTxt.text(txt);\n\n\t\t\tswitch (val.toLowerCase()) {\n\t\t\t\tcase 'hourly':\n\t\t\t\tcase 'daily':\n\t\t\t\tcase 'weekly':\n\t\t\t\tcase 'monthly':\n\t\t\t\t\tthis.$repeatIntervalPanel.removeClass('hide hidden'); // jQuery deprecated hide in 3.0. Use hidden instead. Leaving hide here to support previous markup\n\t\t\t\t\tthis.$repeatIntervalPanel.attr('aria-hidden', 'false');\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.$repeatIntervalPanel.addClass('hidden'); // jQuery deprecated hide in 3.0. Use hidden instead. Leaving hide here to support previous markup\n\t\t\t\t\tthis.$repeatIntervalPanel.attr('aria-hidden', 'true');\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// hide all panels\n\t\t\tthis.$recurrencePanels.addClass('hidden');\n\t\t\tthis.$recurrencePanels.attr('aria-hidden', 'true');\n\n\t\t\t// show panel for current selection\n\t\t\tthis.$element.find('.repeat-' + val).removeClass('hide hidden'); // jQuery deprecated hide in 3.0. Use hidden instead. Leaving hide here to support previous markup\n\t\t\tthis.$element.find('.repeat-' + val).attr('aria-hidden', 'false');\n\n\t\t\t// the end selection should only be shown when\n\t\t\t// the repeat interval is not \"None (run once)\"\n\t\t\tif (val === 'none') {\n\t\t\t\tthis.$end.addClass('hidden');\n\t\t\t\tthis.$end.attr('aria-hidden', 'true');\n\t\t\t} else {\n\t\t\t\tthis.$end.removeClass('hide hidden'); // jQuery deprecated hide in 3.0. Use hidden instead. Leaving hide here to support previous markup\n\t\t\t\tthis.$end.attr('aria-hidden', 'false');\n\t\t\t}\n\n\t\t\tthis._guessEndDate();\n\t\t},\n\n\t\t_parseAndSetRecurrencePattern: function(recurrencePattern, startTime) {\n\t\t\tvar recur = {};\n\t\t\tvar i = 0;\n\t\t\tvar item = '';\n\t\t\tvar commaPatternSplit;\n\n\t\t\tvar $repeatMonthlyDate, $repeatYearlyDate, $repeatYearlyDay;\n\n\t\t\tvar semiColonPatternSplit = recurrencePattern.toUpperCase().split(';');\n\t\t\tfor (i = 0; i < semiColonPatternSplit.length; i++) {\n\t\t\t\tif (semiColonPatternSplit[i] !== '') {\n\t\t\t\t\titem = semiColonPatternSplit[i].split('=');\n\t\t\t\t\trecur[item[0]] = item[1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (recur.FREQ === 'DAILY') {\n\t\t\t\tif (recur.BYDAY === 'MO,TU,WE,TH,FR') {\n\t\t\t\t\titem = 'weekdays';\n\t\t\t\t} else {\n\t\t\t\t\tif (recur.INTERVAL === '1' && recur.COUNT === '1') {\n\t\t\t\t\t\titem = 'none';\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem = 'daily';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (recur.FREQ === 'SECONDLY') {\n\t\t\t\titem = 'secondly';\n\t\t\t} else if (recur.FREQ === 'MINUTELY') {\n\t\t\t\titem = 'minutely';\n\t\t\t} else if (recur.FREQ === 'HOURLY') {\n\t\t\t\titem = 'hourly';\n\t\t\t} else if (recur.FREQ === 'WEEKLY') {\n\t\t\t\titem = 'weekly';\n\n\t\t\t\tif (recur.BYDAY) {\n\t\t\t\t\tif (recur.BYDAY === 'MO,TU,WE,TH,FR') {\n\t\t\t\t\t\titem = 'weekdays';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar el = this.$element.find('.repeat-days-of-the-week .btn-group');\n\t\t\t\t\t\tel.find('label').removeClass('active');\n\t\t\t\t\t\tcommaPatternSplit = recur.BYDAY.split(',');\n\t\t\t\t\t\tfor (i = 0; i < commaPatternSplit.length; i++) {\n\t\t\t\t\t\t\tel.find('input[data-value=\"' + commaPatternSplit[i] + '\"]').prop('checked',true).parent().addClass('active');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (recur.FREQ === 'MONTHLY') {\n\t\t\t\tthis.$element.find('.repeat-monthly input').removeAttr('checked').removeClass('checked');\n\t\t\t\tthis.$element.find('.repeat-monthly label.radio-custom').removeClass('checked');\n\t\t\t\tif (recur.BYMONTHDAY) {\n\t\t\t\t\t$repeatMonthlyDate = this.$element.find('.repeat-monthly-date');\n\t\t\t\t\t$repeatMonthlyDate.find('input').addClass('checked').prop('checked', true);\n\t\t\t\t\t$repeatMonthlyDate.find('label.radio-custom').addClass('checked');\n\t\t\t\t\t$repeatMonthlyDate.find('.selectlist').selectlist('selectByValue', recur.BYMONTHDAY);\n\t\t\t\t} else if (recur.BYDAY) {\n\t\t\t\t\tvar $repeatMonthlyDay = this.$element.find('.repeat-monthly-day');\n\t\t\t\t\t$repeatMonthlyDay.find('input').addClass('checked').prop('checked', true);\n\t\t\t\t\t$repeatMonthlyDay.find('label.radio-custom').addClass('checked');\n\t\t\t\t\tif (recur.BYSETPOS) {\n\t\t\t\t\t\t$repeatMonthlyDay.find('.month-day-pos').selectlist('selectByValue', recur.BYSETPOS);\n\t\t\t\t\t}\n\n\t\t\t\t\t$repeatMonthlyDay.find('.month-days').selectlist('selectByValue', recur.BYDAY);\n\t\t\t\t}\n\n\t\t\t\titem = 'monthly';\n\t\t\t} else if (recur.FREQ === 'YEARLY') {\n\t\t\t\tthis.$element.find('.repeat-yearly input').removeAttr('checked').removeClass('checked');\n\t\t\t\tthis.$element.find('.repeat-yearly label.radio-custom').removeClass('checked');\n\t\t\t\tif (recur.BYMONTHDAY) {\n\t\t\t\t\t$repeatYearlyDate = this.$element.find('.repeat-yearly-date');\n\t\t\t\t\t$repeatYearlyDate.find('input').addClass('checked').prop('checked', true);\n\t\t\t\t\t$repeatYearlyDate.find('label.radio-custom').addClass('checked');\n\t\t\t\t\tif (recur.BYMONTH) {\n\t\t\t\t\t\t$repeatYearlyDate.find('.year-month').selectlist('selectByValue', recur.BYMONTH);\n\t\t\t\t\t}\n\n\t\t\t\t\t$repeatYearlyDate.find('.year-month-day').selectlist('selectByValue', recur.BYMONTHDAY);\n\t\t\t\t} else if (recur.BYSETPOS) {\n\t\t\t\t\t$repeatYearlyDay = this.$element.find('.repeat-yearly-day');\n\t\t\t\t\t$repeatYearlyDay.find('input').addClass('checked').prop('checked', true);\n\t\t\t\t\t$repeatYearlyDay.find('label.radio-custom').addClass('checked');\n\t\t\t\t\t$repeatYearlyDay.find('.year-month-day-pos').selectlist('selectByValue', recur.BYSETPOS);\n\n\t\t\t\t\tif (recur.BYDAY) {\n\t\t\t\t\t\t$repeatYearlyDay.find('.year-month-days').selectlist('selectByValue', recur.BYDAY);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (recur.BYMONTH) {\n\t\t\t\t\t\t$repeatYearlyDay.find('.year-month').selectlist('selectByValue', recur.BYMONTH);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\titem = 'yearly';\n\t\t\t} else {\n\t\t\t\titem = 'none';\n\t\t\t}\n\n\t\t\tif (recur.COUNT) {\n\t\t\t\tthis.$endAfter.spinbox('value', parseInt(recur.COUNT, 10));\n\t\t\t\tthis.$endSelect.selectlist('selectByValue', 'after');\n\t\t\t} else if (recur.UNTIL) {\n\t\t\t\tvar untilSplit, untilDate;\n\n\t\t\t\tif (recur.UNTIL.length === 8) {\n\t\t\t\t\tuntilSplit = recur.UNTIL.split('');\n\t\t\t\t\tuntilSplit.splice(4, 0, '-');\n\t\t\t\t\tuntilSplit.splice(7, 0, '-');\n\t\t\t\t\tuntilDate = untilSplit.join('');\n\t\t\t\t}\n\n\t\t\t\tvar timeZone = this.$timeZone.selectlist('selectedItem');\n\t\t\t\tvar timezoneOffset = (timeZone.offset === '+00:00') ? 'Z' : timeZone.offset;\n\n\t\t\t\tvar utcEndHours = this.setUtcTime(untilDate, startTime.time24HourFormat, timezoneOffset);\n\t\t\t\tthis.$endDate.datepicker('setDate', utcEndHours);\n\n\t\t\t\tthis.$endSelect.selectlist('selectByValue', 'date');\n\t\t\t} else {\n\t\t\t\tthis.$endSelect.selectlist('selectByValue', 'never');\n\t\t\t}\n\n\t\t\tthis.endSelectChanged();\n\n\t\t\tif (recur.INTERVAL) {\n\t\t\t\tthis.$repeatIntervalSpinbox.spinbox('value', parseInt(recur.INTERVAL, 10));\n\t\t\t}\n\n\t\t\tthis.$repeatIntervalSelect.selectlist('selectByValue', item);\n\t\t\tthis.repeatIntervalSelectChanged();\n\t\t},\n\n\t\t_parseStartDateTime: function(startTimeISO8601) {\n\t\t\tvar startTime = {};\n\t\t\tvar startDate, startDateTimeISO8601FormatSplit, hours, minutes, period;\n\n\t\t\tstartTime.time24HourFormat = startTimeISO8601.split('+')[0].split('-')[0];\n\n\t\t\tif (startTimeISO8601.search(/\\+/) > -1) {\n\t\t\t\tstartTime.timeZoneOffset = '+' + langx.trim(startTimeISO8601.split('+')[1]);\n\t\t\t} else if (startTimeISO8601.search(/\\-/) > -1) {\n\t\t\t\tstartTime.timeZoneOffset = '-' + langx.trim(startTimeISO8601.split('-')[1]);\n\t\t\t} else {\n\t\t\t\tstartTime.timeZoneOffset = '+00:00';\n\t\t\t}\n\n\t\t\tstartTime.time24HourFormatSplit = startTime.time24HourFormat.split(':');\n\t\t\thours = parseInt(startTime.time24HourFormatSplit[0], 10);\n\t\t\tminutes = (startTime.time24HourFormatSplit[1]) ? parseInt(startTime.time24HourFormatSplit[1].split('+')[0].split('-')[0].split('Z')[0], 10) : 0;\n\t\t\tperiod = (hours < 12) ? 'AM' : 'PM';\n\n\t\t\tif (hours === 0) {\n\t\t\t\thours = 12;\n\t\t\t} else if (hours > 12) {\n\t\t\t\thours -= 12;\n\t\t\t}\n\n\t\t\tminutes = (minutes < 10) ? '0' + minutes : minutes;\n\t\t\tstartTime.time12HourFormat = hours + ':' + minutes;\n\t\t\tstartTime.time12HourFormatWithPeriod = hours + ':' + minutes + ' ' + period;\n\n\t\t\treturn startTime;\n\t\t},\n\n\t\t_parseTimeZone: function(options, startTime) {\n\t\t\tstartTime.timeZoneQuerySelector = '';\n\t\t\tif (options.timeZone) {\n\t\t\t\tif (typeof (options.timeZone) === 'string') {\n\t\t\t\t\tstartTime.timeZoneQuerySelector += 'li[data-name=\"' + options.timeZone + '\"]';\n\t\t\t\t} else {\n\t\t\t\t\tlangx.each(options.timeZone, function(key, value) {\n\t\t\t\t\t\tstartTime.timeZoneQuerySelector += 'li[data-' + key + '=\"' + value + '\"]';\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tstartTime.timeZoneOffset = options.timeZone.offset;\n\t\t\t} else if (options.startDateTime) {\n\t\t\t\t// Time zone has not been specified via options object, therefore use the timeZoneOffset from _parseAndSetStartDateTime\n\t\t\t\tstartTime.timeZoneOffset = (startTime.timeZoneOffset === '+00:00') ? 'Z' : startTime.timeZoneOffset;\n\t\t\t\tstartTime.timeZoneQuerySelector += 'li[data-offset=\"' + startTime.timeZoneOffset + '\"]';\n\t\t\t} else {\n\t\t\t\tstartTime.timeZoneOffset = 'Z';\n\t\t\t}\n\n\t\t\treturn startTime.timeZoneOffset;\n\t\t},\n\n\t\t_setTimeUI: function(time12HourFormatWithPeriod) {\n\t\t\tthis.$startTime.find('input').val(time12HourFormatWithPeriod);\n\t\t\tthis.$startTime.combobox('selectByText', time12HourFormatWithPeriod);\n\t\t},\n\n\t\t_setTimeZoneUI: function(querySelector) {\n\t\t\tthis.$timeZone.selectlist('selectBySelector', querySelector);\n\t\t},\n\n\t\tsetValue: function setValue(options) {\n\t\t\tvar startTime = {};\n\t\t\tvar startDateTime, startDate, startTimeISO8601, timeOffset, utcStartHours;\n\n\t\t\t// TIME\n\t\t\tif (options.startDateTime) {\n\t\t\t\tstartDateTime = options.startDateTime.split('T');\n\t\t\t\tstartDate = startDateTime[0];\n\t\t\t\tstartTimeISO8601 = startDateTime[1];\n\n\t\t\t\tif(startTimeISO8601) {\n\t\t\t\t\tstartTime = this._parseStartDateTime(startTimeISO8601);\n\t\t\t\t\tthis._setTimeUI(startTime.time12HourFormatWithPeriod);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tstartTime.time12HourFormat = '00:00';\n\t\t\t\t\tstartTime.time24HourFormat = '00:00';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstartTime.time12HourFormat = '00:00';\n\t\t\t\tstartTime.time24HourFormat = '00:00';\n\t\t\t\tvar currentDate = this.$startDate.datepicker('getDate');\n\t\t\t\tstartDate = currentDate.getFullYear() + '-' + currentDate.getMonth() + '-' + currentDate.getDate();\n\t\t\t}\n\n\t\t\t// TIMEZONE\n\t\t\tthis._parseTimeZone(options, startTime);\n\t\t\tif (startTime.timeZoneQuerySelector) {\n\t\t\t\tthis._setTimeZoneUI(startTime.timeZoneQuerySelector);\n\t\t\t}\n\n\t\t\t// RECURRENCE PATTERN\n\t\t\tif(options.recurrencePattern) {\n\t\t\t\tthis._parseAndSetRecurrencePattern(options.recurrencePattern, startTime);\n\t\t\t}\n\n\t\t\tutcStartHours = this.setUtcTime(startDate, startTime.time24HourFormat, startTime.timeZoneOffset);\n\t\t\tthis.$startDate.datepicker('setDate', utcStartHours);\n\t\t},\n\n\t\ttoggleState: function toggleState(action) {\n\t\t\tthis.$element.find('.combobox').combobox(action);\n\t\t\tthis.$element.find('.datepicker').datepicker(action);\n\t\t\tthis.$element.find('.selectlist').selectlist(action);\n\t\t\tthis.$element.find('.spinbox').spinbox(action);\n\t\t\tthis.$element.find('.radio-custom').radio(action);\n\n\t\t\tif (action === 'disable') {\n\t\t\t\taction = 'addClass';\n\t\t\t} else {\n\t\t\t\taction = 'removeClass';\n\t\t\t}\n\n\t\t\tthis.$element.find('.repeat-days-of-the-week .btn-group')[action]('disabled');\n\t\t},\n\n\t\tvalue: function value(options) {\n\t\t\tif (options) {\n\t\t\t\treturn this.setValue(options);\n\t\t\t} else {\n\t\t\t\treturn this.getValue();\n\t\t\t}\n\t\t}\n\n\t});\n\n\tvar _getFormattedDate = function _getFormattedDate(dateObj, dash) {\n\t\tvar fdate = '';\n\t\tvar item;\n\n\t\tfdate += dateObj.getFullYear();\n\t\tfdate += dash;\n\t\titem = dateObj.getMonth() + 1;//because 0 indexing makes sense when dealing with months /sarcasm\n\t\tfdate += (item < 10) ? '0' + item : item;\n\t\tfdate += dash;\n\t\titem = dateObj.getDate();\n\t\tfdate += (item < 10) ? '0' + item : item;\n\n\t\treturn fdate;\n\t};\n\n\tvar ONE_SECOND = 1000;\n\tvar ONE_MINUTE = ONE_SECOND * 60;\n\tvar ONE_HOUR = ONE_MINUTE * 60;\n\tvar ONE_DAY = ONE_HOUR * 24;\n\tvar ONE_WEEK = ONE_DAY * 7;\n\tvar ONE_MONTH = ONE_WEEK * 5;// No good way to increment by one month using vanilla JS. Since this is an end date, we only need to ensure that this date occurs after at least one or more repeat increments, but there is no reason for it to be exact.\n\tvar ONE_YEAR = ONE_WEEK * 52;\n\tvar INTERVALS = {\n\t\tsecondly: ONE_SECOND,\n\t\tminutely: ONE_MINUTE,\n\t\thourly: ONE_HOUR,\n\t\tdaily: ONE_DAY,\n\t\tweekly: ONE_WEEK,\n\t\tmonthly: ONE_MONTH,\n\t\tyearly: ONE_YEAR\n\t};\n\n\tvar _incrementDate = function _incrementDate(start, end, interval, increment) {\n\t\treturn new Date(start.getTime() + (INTERVALS[interval] * increment));\n\t};\n\n\n\t// SCHEDULER PLUGIN DEFINITION\n\n\t$.fn.scheduler = function scheduler(option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.scheduler');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.scheduler', (data = new Scheduler(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.scheduler.defaults = {};\n\n\t$.fn.scheduler.Constructor = Scheduler;\n\n\t$.fn.scheduler.noConflict = function noConflict() {\n\t\t$.fn.scheduler = old;\n\t\treturn this;\n\t};\n\n\n\t// DATA-API\n\t/*\n\n\t$(document).on('mousedown.fu.scheduler.data-api', '[data-initialize=scheduler]', function (e) {\n\t\tvar $control = $(e.target).closest('.scheduler');\n\t\tif (!$control.data('fu.scheduler')) {\n\t\t\t$control.scheduler($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function () {\n\t\t$('[data-initialize=scheduler]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.data('scheduler')) return;\n\t\t\t$this.scheduler($this.data());\n\t\t});\n\t});\n\t*/\n\n\treturn $.fn.scheduler;\n});\n\ndefine('skylark-fuelux/search',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\",\n  \"skylark-bootstrap3/dropdown\"  \n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\tvar old = $.fn.search;\n\n\t// SEARCH CONSTRUCTOR AND PROTOTYPE\n\n\tvar Search = fuelux.Search = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Search\",\n\n\t\tinit : function(element,options) {\n\t\t\tthis.$element = $(element);\n\t\t\tthis.$repeater = $(element).closest('.repeater');\n\t\t\tthis.options = langx.mixin({}, $.fn.search.defaults, options);\n\n\t\t\tif (this.$element.attr('data-searchOnKeyPress') === 'true'){\n\t\t\t\tthis.options.searchOnKeyPress = true;\n\t\t\t}\n\n\t\t\tthis.$button = this.$element.find('button');\n\t\t\tthis.$input = this.$element.find('input');\n\t\t\tthis.$icon = this.$element.find('.glyphicon, .fuelux-icon');\n\n\t\t\tthis.$button.on('click.fu.search', langx.proxy(this.buttonclicked, this));\n\t\t\tthis.$input.on('keyup.fu.search', langx.proxy(this.keypress, this));\n\n\t\t\tif (this.$repeater.length > 0) {\n\t\t\t\tthis.$repeater.on('rendered.fu.repeater', langx.proxy(this.clearPending, this));\n\t\t\t}\n\n\t\t\tthis.activeSearch = '';\n\t\t},\n\t\tdestroy: function () {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\t\t\t// set input value attrbute\n\t\t\tthis.$element.find('input').each(function () {\n\t\t\t\t$(this).attr('value', $(this).val());\n\t\t\t});\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tsearch: function (searchText) {\n\t\t\tif (this.$icon.hasClass('glyphicon')) {\n\t\t\t\tthis.$icon.removeClass('glyphicon-search').addClass('glyphicon-remove');\n\t\t\t}\n\t\t\tif (this.$icon.hasClass('fuelux-icon')) {\n\t\t\t\tthis.$icon.removeClass('fuelux-icon-search').addClass('fuelux-icon-remove');\n\t\t\t}\n\n\t\t\tthis.activeSearch = searchText;\n\t\t\tthis.$element.addClass('searched pending');\n\t\t\tthis.$element.trigger('searched.fu.search', searchText);\n\t\t},\n\n\t\tclear: function () {\n\t\t\tif (this.$icon.hasClass('glyphicon')) {\n\t\t\t\tthis.$icon.removeClass('glyphicon-remove').addClass('glyphicon-search');\n\t\t\t}\n\t\t\tif (this.$icon.hasClass('fuelux-icon')) {\n\t\t\t\tthis.$icon.removeClass('fuelux-icon-remove').addClass('fuelux-icon-search');\n\t\t\t}\n\n\t\t\tif (this.$element.hasClass('pending')) {\n\t\t\t\tthis.$element.trigger('canceled.fu.search');\n\t\t\t}\n\n\t\t\tthis.activeSearch = '';\n\t\t\tthis.$input.val('');\n\t\t\tthis.$element.trigger('cleared.fu.search');\n\t\t\tthis.$element.removeClass('searched pending');\n\t\t},\n\n\t\tclearPending: function () {\n\t\t\tthis.$element.removeClass('pending');\n\t\t},\n\n\t\taction: function () {\n\t\t\tvar val = this.$input.val();\n\n\t\t\tif (val && val.length > 0) {\n\t\t\t\tthis.search(val);\n\t\t\t} else {\n\t\t\t\tthis.clear();\n\t\t\t}\n\t\t},\n\n\t\tbuttonclicked: function (e) {\n\t\t\te.preventDefault();\n\t\t\tif ($(e.currentTarget).is('.disabled, :disabled')) return;\n\n\t\t\tif (this.$element.hasClass('pending') || this.$element.hasClass('searched')) {\n\t\t\t\tthis.clear();\n\t\t\t} else {\n\t\t\t\tthis.action();\n\t\t\t}\n\t\t},\n\n\t\tkeypress: function (e) {\n\t\t\tvar ENTER_KEY_CODE = 13;\n\t\t\tvar TAB_KEY_CODE = 9;\n\t\t\tvar ESC_KEY_CODE = 27;\n\n\t\t\tif (e.which === ENTER_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.action();\n\t\t\t} else if (e.which === TAB_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t} else if (e.which === ESC_KEY_CODE) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.clear();\n\t\t\t} else if (this.options.searchOnKeyPress) {\n\t\t\t\t// search on other keypress\n\t\t\t\tthis.action();\n\t\t\t}\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$input.attr('disabled', 'disabled');\n\n\t\t\tif (!this.options.allowCancel) {\n\t\t\t\tthis.$button.addClass('disabled');\n\t\t\t}\n\t\t},\n\n\t\tenable: function () {\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$input.removeAttr('disabled');\n\t\t\tthis.$button.removeClass('disabled');\n\t\t}\n\t});\n\n\t// SEARCH PLUGIN DEFINITION\n\n\t$.fn.search = function (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.search');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.search', (data = new Search(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.search.defaults = {\n\t\tclearOnEmpty: false,\n\t\tsearchOnKeyPress: false,\n\t\tallowCancel: false\n\t};\n\n\t$.fn.search.Constructor = Search;\n\n\t$.fn.search.noConflict = function () {\n\t\t$.fn.search = old;\n\t\treturn this;\n\t};\n\n\n\t// DATA-API\n\t/*\n\t$(document).on('mousedown.fu.search.data-api', '[data-initialize=search]', function (e) {\n\t\tvar $control = $(e.target).closest('.search');\n\t\tif (!$control.data('fu.search')) {\n\t\t\t$control.search($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function () {\n\t\t$('[data-initialize=search]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.data('fu.search')) return;\n\t\t\t$this.search($this.data());\n\t\t});\n\t});\n\t*/\n\n\treturn \t$.fn.search;\n});\n\ndefine('skylark-fuelux/tree',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx/browser\",\r\n  \"skylark-domx/eventer\",\r\n  \"skylark-domx/noder\",\r\n  \"skylark-domx/geom\",\r\n  \"skylark-domx/query\",\r\n  \"./fuelux\"\r\n],function(langx,browser,eventer,noder,geom,$,fuelux){\r\n\r\n\r\n\t/*\r\n\t * Fuel UX Checkbox\r\n\t * https://github.com/ExactTarget/fuelux\r\n\t *\r\n\t * Copyright (c) 2014 ExactTarget\r\n\t * Licensed under the BSD New license.\r\n\t */\r\n\r\n\tvar old = $.fn.tree;\r\n\r\n\t// TREE CONSTRUCTOR AND PROTOTYPE\r\n\r\n\tvar Tree = fuelux.Tree = fuelux.WidgetBase.inherit({\r\n\t\tklassName: \"Tree\",\r\n\r\n\t\tinit : function(element,options) {\r\n\t\t\tthis.$element = $(element);\r\n\t\t\tthis.options = langx.mixin({}, $.fn.tree.defaults, options);\r\n\r\n\t\t\tthis.$element.attr('tabindex', '0');\r\n\r\n\t\t\tif (this.options.itemSelect) {\r\n\t\t\t\tthis.$element.on('click.fu.tree', '.tree-item', langx.proxy(function callSelect (ev) {\r\n\t\t\t\t\tthis.selectItem(ev.currentTarget);\r\n\t\t\t\t}, this));\r\n\t\t\t}\r\n\r\n\t\t\tthis.$element.on('click.fu.tree', '.tree-branch-name', langx.proxy(function callToggle (ev) {\r\n\t\t\t\tthis.toggleFolder(ev.currentTarget);\r\n\t\t\t}, this));\r\n\r\n\t\t\tthis.$element.on('click.fu.tree', '.tree-overflow', langx.proxy(function callPopulate (ev) {\r\n\t\t\t\tthis.populate($(ev.currentTarget));\r\n\t\t\t}, this));\r\n\r\n\t\t\t// folderSelect default is true\r\n\t\t\tif (this.options.folderSelect) {\r\n\t\t\t\tthis.$element.addClass('tree-folder-select');\r\n\t\t\t\tthis.$element.off('click.fu.tree', '.tree-branch-name');\r\n\t\t\t\tthis.$element.on('click.fu.tree', '.icon-caret', langx.proxy(function callToggle (ev) {\r\n\t\t\t\t\tthis.toggleFolder($(ev.currentTarget).parent());\r\n\t\t\t\t}, this));\r\n\t\t\t\tthis.$element.on('click.fu.tree', '.tree-branch-name', langx.proxy(function callSelect (ev) {\r\n\t\t\t\t\tthis.selectFolder($(ev.currentTarget));\r\n\t\t\t\t}, this));\r\n\t\t\t}\r\n\r\n\t\t\tthis.$element.on('focus', function setFocusOnTab () {\r\n\t\t\t\tvar $tree = $(this);\r\n\t\t\t\tfocusIn($tree, $tree);\r\n\t\t\t});\r\n\r\n\t\t\tthis.$element.on('keydown', function processKeypress (e) {\r\n\t\t\t\treturn navigateTree($(this), e);\r\n\t\t\t});\r\n\r\n\t\t\tthis.render();\r\n\t\t},\r\n\t\tdeselectAll: function deselectAll(n) {\r\n\t\t\t// clear all child tree nodes and style as deselected\r\n\t\t\tvar nodes = n || this.$element;\r\n\t\t\tvar $selectedElements = $(nodes).find('.tree-selected');\r\n\t\t\t$selectedElements.each(function callStyleNodeDeselected (index, element) {\r\n\t\t\t\tvar $element = $(element);\r\n\t\t\t\tariaDeselect($element);\r\n\t\t\t\tstyleNodeDeselected( $element, $element.find( '.glyphicon' ) );\r\n\t\t\t});\r\n\t\t\treturn $selectedElements;\r\n\t\t},\r\n\r\n\t\tdestroy: function destroy() {\r\n\t\t\t// any external bindings [none]\r\n\t\t\t// empty elements to return to original markup\r\n\t\t\tthis.$element.find('li:not([data-template])').remove();\r\n\r\n\t\t\tthis.$element.remove();\r\n\t\t\t// returns string of markup\r\n\t\t\treturn this.$element[0].outerHTML;\r\n\t\t},\r\n\r\n\t\trender: function render() {\r\n\t\t\tthis.populate(this.$element);\r\n\t\t},\r\n\r\n\t\tpopulate: function populate($el, ibp) {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\t// populate was initiated based on clicking overflow link\r\n\t\t\tvar isOverflow = $el.hasClass('tree-overflow');\r\n\r\n\t\t\tvar $parent = ($el.hasClass('tree')) ? $el : $el.parent();\r\n\t\t\tvar atRoot = $parent.hasClass('tree');\r\n\r\n\t\t\tif (isOverflow && !atRoot) {\r\n\t\t\t\t$parent = $parent.parent();\r\n\t\t\t}\r\n\r\n\t\t\tvar treeData = $parent.data();\r\n\t\t\t// expose overflow data to datasource so it can be responded to appropriately.\r\n\t\t\tif (isOverflow) {\r\n\t\t\t\ttreeData.overflow = $el.data();\r\n\t\t\t}\r\n\r\n\t\t\tvar isBackgroundProcess = ibp || false;\t// no user affordance needed (ex.- \"loading\")\r\n\r\n\t\t\tif (isOverflow) {\r\n\t\t\t\tif (atRoot) {\r\n\t\t\t\t\t// the loader at the root level needs to continually replace the overflow trigger\r\n\t\t\t\t\t// otherwise, when loader is shown below, it will be the loader for the last folder\r\n\t\t\t\t\t// in the tree, instead of the loader at the root level.\r\n\t\t\t\t\t$el.replaceWith($parent.find('> .tree-loader').remove());\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$el.remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar $loader = $parent.find('.tree-loader:last');\r\n\r\n\t\t\tif (isBackgroundProcess === false) {\r\n\t\t\t\t$loader.removeClass('hide hidden'); // jQuery deprecated hide in 3.0. Use hidden instead. Leaving hide here to support previous markup\r\n\t\t\t}\r\n\r\n\t\t\tthis.options.dataSource(treeData ? treeData : {}, function populateNodes (items) {\r\n\t\t\t\tlangx.each(items.data, function buildNode (i, treeNode) {\r\n\t\t\t\t\tvar nodeType = treeNode.type;\r\n\r\n\t\t\t\t\t// 'item' and 'overflow' remain consistent, but 'folder' maps to 'branch'\r\n\t\t\t\t\tif (treeNode.type === 'folder') {\r\n\t\t\t\t\t\tnodeType = 'branch';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar $entity = self.$element\r\n\t\t\t\t\t\t.find('[data-template=tree' + nodeType + ']:eq(0)')\r\n\t\t\t\t\t\t.clone()\r\n\t\t\t\t\t\t.removeClass('hide hidden')// jQuery deprecated hide in 3.0. Use hidden instead. Leaving hide here to support previous markup\r\n\t\t\t\t\t\t.removeData('template')\r\n\t\t\t\t\t\t.removeAttr('data-template');\r\n\t\t\t\t\t$entity.find('.tree-' + nodeType + '-name > .tree-label').html(treeNode.text || treeNode.name);\r\n\t\t\t\t\t$entity.data(treeNode);\r\n\r\n\r\n\t\t\t\t\t// Decorate $entity with data or other attributes making the\r\n\t\t\t\t\t// element easily accessible with libraries like jQuery.\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// Values are contained within the object returned\r\n\t\t\t\t\t// for folders and items as attr:\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// {\r\n\t\t\t\t\t//     text: \"An Item\",\r\n\t\t\t\t\t//     type: 'item',\r\n\t\t\t\t\t//     attr = {\r\n\t\t\t\t\t//         'classes': 'required-item red-text',\r\n\t\t\t\t\t//         'data-parent': parentId,\r\n\t\t\t\t\t//         'guid': guid,\r\n\t\t\t\t\t//         'id': guid\r\n\t\t\t\t\t//     }\r\n\t\t\t\t\t// };\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// the \"name\" attribute is also supported but is deprecated for \"text\".\r\n\r\n\t\t\t\t\t// add attributes to tree-branch or tree-item\r\n\t\t\t\t\tvar attrs = treeNode.attr || treeNode.dataAttributes || [];\r\n\t\t\t\t\tlangx.each(attrs, function setAttribute (attr, setTo) {\r\n\t\t\t\t\t\tswitch (attr) {\r\n\t\t\t\t\t\tcase 'cssClass':\r\n\t\t\t\t\t\tcase 'class':\r\n\t\t\t\t\t\tcase 'className':\r\n\t\t\t\t\t\t\t$entity.addClass(setTo);\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t// allow custom icons\r\n\t\t\t\t\t\tcase 'data-icon':\r\n\t\t\t\t\t\t\t$entity.find('.icon-item').removeClass().addClass('icon-item ' + setTo);\r\n\t\t\t\t\t\t\t$entity.attr(attr, setTo);\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t// ARIA support\r\n\t\t\t\t\t\tcase 'id':\r\n\t\t\t\t\t\t\t$entity.attr(attr, setTo);\r\n\t\t\t\t\t\t\t$entity.attr('aria-labelledby', setTo + '-label');\r\n\t\t\t\t\t\t\t$entity.find('.tree-branch-name > .tree-label').attr('id', setTo + '-label');\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t// style, data-*\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t$entity.attr(attr, setTo);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// add child node\r\n\t\t\t\t\tif (atRoot) {\r\n\t\t\t\t\t\t// For accessibility reasons, the root element is the only tab-able element (see https://github.com/ExactTarget/fuelux/issues/1964)\r\n\t\t\t\t\t\t$parent.append($entity);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$parent.find('.tree-branch-children:eq(0)').append($entity);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$parent.find('.tree-loader').addClass('hidden');\r\n\t\t\t\t// return newly populated folder\r\n\t\t\t\tself.$element.trigger('loaded.fu.tree', $parent);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tselectTreeNode: function selectItem(clickedElement, nodeType) {\r\n\t\t\tvar clicked = {};\t// object for clicked element\r\n\t\t\tclicked.$element = $(clickedElement);\r\n\r\n\t\t\tvar selected = {}; // object for selected elements\r\n\t\t\tselected.$elements = this.$element.find('.tree-selected');\r\n\t\t\tselected.dataForEvent = [];\r\n\r\n\t\t\t// determine clicked element and it's icon\r\n\t\t\tif (nodeType === 'folder') {\r\n\t\t\t\t// make the clicked.$element the container branch\r\n\t\t\t\tclicked.$element = clicked.$element.closest('.tree-branch');\r\n\t\t\t\tclicked.$icon = clicked.$element.find('.icon-folder');\r\n\t\t\t} else {\r\n\t\t\t\tclicked.$icon = clicked.$element.find('.icon-item');\r\n\t\t\t}\r\n\t\t\tclicked.elementData = clicked.$element.data();\r\n\r\n\t\t\tariaSelect(clicked.$element);\r\n\r\n\t\t\t// the below functions pass objects by copy/reference and use modified object in this function\r\n\t\t\tif ( this.options.multiSelect ) {\r\n\t\t\t\tselected = multiSelectSyncNodes(this, clicked, selected);\r\n\t\t\t} else {\r\n\t\t\t\tselected = singleSelectSyncNodes(this, clicked, selected);\r\n\t\t\t}\r\n\r\n\t\t\tsetFocus(this.$element, clicked.$element);\r\n\r\n\t\t\t// all done with the DOM, now fire events\r\n\t\t\tthis.$element.trigger(selected.eventType + '.fu.tree', {\r\n\t\t\t\ttarget: clicked.elementData,\r\n\t\t\t\tselected: selected.dataForEvent\r\n\t\t\t});\r\n\r\n\t\t\tclicked.$element.trigger('updated.fu.tree', {\r\n\t\t\t\tselected: selected.dataForEvent,\r\n\t\t\t\titem: clicked.$element,\r\n\t\t\t\teventType: selected.eventType\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tdiscloseFolder: function discloseFolder(folder) {\r\n\t\t\tvar $folder = $(folder);\r\n\r\n\t\t\tvar $branch = $folder.closest('.tree-branch');\r\n\t\t\tvar $treeFolderContent = $branch.find('.tree-branch-children');\r\n\t\t\tvar $treeFolderContentFirstChild = $treeFolderContent.eq(0);\r\n\r\n\t\t\t// take care of the styles\r\n\t\t\t$branch.addClass('tree-open');\r\n\t\t\t$branch.attr('aria-expanded', 'true');\r\n\t\t\t$treeFolderContentFirstChild.removeClass('hide hidden'); // jQuery deprecated hide in 3.0. Use hidden instead. Leaving hide here to support previous markup\r\n\t\t\t$branch.find('> .tree-branch-header .icon-folder').eq(0)\r\n\t\t\t\t.removeClass('glyphicon-folder-close')\r\n\t\t\t\t.addClass('glyphicon-folder-open');\r\n\r\n\t\t\tvar $tree = this.$element;\r\n\t\t\tvar disclosedCompleted = function disclosedCompleted () {\r\n\t\t\t\t$tree.trigger('disclosedFolder.fu.tree', $branch.data());\r\n\t\t\t};\r\n\r\n\t\t\t// add the children to the folder\r\n\t\t\tif (!$treeFolderContent.children().length) {\r\n\t\t\t\t$tree.one('loaded.fu.tree', disclosedCompleted);\r\n\t\t\t\tthis.populate($treeFolderContent);\r\n\t\t\t} else {\r\n\t\t\t\tdisclosedCompleted();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcloseFolder: function closeFolder(el) {\r\n\t\t\tvar $el = $(el);\r\n\t\t\tvar $branch = $el.closest('.tree-branch');\r\n\t\t\tvar $treeFolderContent = $branch.find('.tree-branch-children');\r\n\t\t\tvar $treeFolderContentFirstChild = $treeFolderContent.eq(0);\r\n\r\n\t\t\t// take care of the styles\r\n\t\t\t$branch.removeClass('tree-open');\r\n\t\t\t$branch.attr('aria-expanded', 'false');\r\n\t\t\t$treeFolderContentFirstChild.addClass('hidden');\r\n\t\t\t$branch.find('> .tree-branch-header .icon-folder').eq(0)\r\n\t\t\t\t.removeClass('glyphicon-folder-open')\r\n\t\t\t\t.addClass('glyphicon-folder-close');\r\n\r\n\t\t\t// remove chidren if no cache\r\n\t\t\tif (!this.options.cacheItems) {\r\n\t\t\t\t$treeFolderContentFirstChild.empty();\r\n\t\t\t}\r\n\r\n\t\t\tthis.$element.trigger('closed.fu.tree', $branch.data());\r\n\t\t},\r\n\r\n\t\ttoggleFolder: function toggleFolder(el) {\r\n\t\t\tvar $el = $(el);\r\n\r\n\t\t\tif ($el.find('.glyphicon-folder-close').length) {\r\n\t\t\t\tthis.discloseFolder(el);\r\n\t\t\t} else if ($el.find('.glyphicon-folder-open').length) {\r\n\t\t\t\tthis.closeFolder(el);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tselectFolder: function selectFolder(el) {\r\n\t\t\tif (this.options.folderSelect) {\r\n\t\t\t\tthis.selectTreeNode(el, 'folder');\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tselectItem: function selectItem(el) {\r\n\t\t\tif (this.options.itemSelect) {\r\n\t\t\t\tthis.selectTreeNode(el, 'item');\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tselectedItems: function selectedItems() {\r\n\t\t\tvar $sel = this.$element.find('.tree-selected');\r\n\t\t\tvar selected = [];\r\n\r\n\t\t\tlangx.each($sel, function buildSelectedArray (i, value) {\r\n\t\t\t\tselected.push($(value).data());\r\n\t\t\t});\r\n\t\t\treturn selected;\r\n\t\t},\r\n\r\n\t\t// collapses open folders\r\n\t\tcollapse: function collapse() {\r\n\t\t\tvar self = this;\r\n\t\t\tvar reportedClosed = [];\r\n\r\n\t\t\tvar closedReported = function closedReported(event, closed) {\r\n\t\t\t\treportedClosed.push(closed);\r\n\r\n\t\t\t\t// jQuery deprecated hide in 3.0. Use hidden instead. Leaving hide here to support previous markup\r\n\t\t\t\tif (self.$element.find(\".tree-branch.tree-open:not('.hidden, .hide')\").length === 0) {\r\n\t\t\t\t\tself.$element.trigger('closedAll.fu.tree', {\r\n\t\t\t\t\t\ttree: self.$element,\r\n\t\t\t\t\t\treportedClosed: reportedClosed\r\n\t\t\t\t\t});\r\n\t\t\t\t\tself.$element.off('loaded.fu.tree', self.$element, closedReported);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// trigger callback when all folders have reported closed\r\n\t\t\tself.$element.on('closed.fu.tree', closedReported);\r\n\r\n\t\t\tself.$element.find(\".tree-branch.tree-open:not('.hidden, .hide')\").each(function closeFolder () {\r\n\t\t\t\tself.closeFolder(this);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// disclose visible will only disclose visible tree folders\r\n\t\tdiscloseVisible: function discloseVisible() {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tvar $openableFolders = self.$element.find(\".tree-branch:not('.tree-open, .hidden, .hide')\");\r\n\t\t\tvar reportedOpened = [];\r\n\r\n\t\t\tvar openReported = function openReported(event, opened) {\r\n\t\t\t\treportedOpened.push(opened);\r\n\r\n\t\t\t\tif (reportedOpened.length === $openableFolders.length) {\r\n\t\t\t\t\tself.$element.trigger('disclosedVisible.fu.tree', {\r\n\t\t\t\t\t\ttree: self.$element,\r\n\t\t\t\t\t\treportedOpened: reportedOpened\r\n\t\t\t\t\t});\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t* Unbind the `openReported` event. `discloseAll` may be running and we want to reset this\r\n\t\t\t\t\t* method for the next iteration.\r\n\t\t\t\t\t*/\r\n\t\t\t\t\tself.$element.off('loaded.fu.tree', self.$element, openReported);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// trigger callback when all folders have reported opened\r\n\t\t\tself.$element.on('loaded.fu.tree', openReported);\r\n\r\n\t\t\t// open all visible folders\r\n\t\t\tself.$element.find(\".tree-branch:not('.tree-open, .hidden, .hide')\").each(function triggerOpen() {\r\n\t\t\t\tself.discloseFolder($(this).find('.tree-branch-header'));\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t* Disclose all will keep listening for `loaded.fu.tree` and if `$(tree-el).data('ignore-disclosures-limit')`\r\n\t\t* is `true` (defaults to `true`) it will attempt to disclose any new closed folders than were\r\n\t\t* loaded in during the last disclosure.\r\n\t\t*/\r\n\t\tdiscloseAll: function discloseAll() {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\t// first time\r\n\t\t\tif (typeof self.$element.data('disclosures') === 'undefined') {\r\n\t\t\t\tself.$element.data('disclosures', 0);\r\n\t\t\t}\r\n\r\n\t\t\tvar isExceededLimit = (self.options.disclosuresUpperLimit >= 1 && self.$element.data('disclosures') >= self.options.disclosuresUpperLimit);\r\n\t\t\tvar isAllDisclosed = self.$element.find(\".tree-branch:not('.tree-open, .hidden, .hide')\").length === 0;\r\n\r\n\r\n\t\t\tif (!isAllDisclosed) {\r\n\t\t\t\tif (isExceededLimit) {\r\n\t\t\t\t\tself.$element.trigger('exceededDisclosuresLimit.fu.tree', {\r\n\t\t\t\t\t\ttree: self.$element,\r\n\t\t\t\t\t\tdisclosures: self.$element.data('disclosures')\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t* If you've exceeded the limit, the loop will be killed unless you\r\n\t\t\t\t\t* explicitly ignore the limit and start the loop again:\r\n\t\t\t\t\t*\r\n\t\t\t\t\t*    $tree.one('exceededDisclosuresLimit.fu.tree', function () {\r\n\t\t\t\t\t*        $tree.data('ignore-disclosures-limit', true);\r\n\t\t\t\t\t*        $tree.tree('discloseAll');\r\n\t\t\t\t\t*    });\r\n\t\t\t\t\t*/\r\n\t\t\t\t\tif (!self.$element.data('ignore-disclosures-limit')) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tself.$element.data('disclosures', self.$element.data('disclosures') + 1);\r\n\r\n\t\t\t\t/*\r\n\t\t\t\t* A new branch that is closed might be loaded in, make sure those get handled too.\r\n\t\t\t\t* This attachment needs to occur before calling `discloseVisible` to make sure that\r\n\t\t\t\t* if the execution of `discloseVisible` happens _super fast_ (as it does in our QUnit tests\r\n\t\t\t\t* this will still be called. However, make sure this only gets called _once_, because\r\n\t\t\t\t* otherwise, every single time we go through this loop, _another_ event will be bound\r\n\t\t\t\t* and then when the trigger happens, this will fire N times, where N equals the number\r\n\t\t\t\t* of recursive `discloseAll` executions (instead of just one)\r\n\t\t\t\t*/\r\n\t\t\t\tself.$element.one('disclosedVisible.fu.tree', function callDiscloseAll () {\r\n\t\t\t\t\tself.discloseAll();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t/*\r\n\t\t\t\t* If the page is very fast, calling this first will cause `disclosedVisible.fu.tree` to not\r\n\t\t\t\t* be bound in time to be called, so, we need to call this last so that the things bound\r\n\t\t\t\t* and triggered above can have time to take place before the next execution of the\r\n\t\t\t\t* `discloseAll` method.\r\n\t\t\t\t*/\r\n\t\t\t\tself.discloseVisible();\r\n\t\t\t} else {\r\n\t\t\t\tself.$element.trigger('disclosedAll.fu.tree', {\r\n\t\t\t\t\ttree: self.$element,\r\n\t\t\t\t\tdisclosures: self.$element.data('disclosures')\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// if `cacheItems` is false, and they call closeAll, the data is trashed and therefore\r\n\t\t\t\t// disclosures needs to accurately reflect that\r\n\t\t\t\tif (!self.options.cacheItems) {\r\n\t\t\t\t\tself.$element.one('closeAll.fu.tree', function updateDisclosuresData () {\r\n\t\t\t\t\t\tself.$element.data('disclosures', 0);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// This refreshes the children of a folder. Please destroy and re-initilize for \"root level\" refresh.\r\n\t\t// The data of the refreshed folder is not updated. This control's architecture only allows updating of children.\r\n\t\t// Folder renames should probably be handled directly on the node.\r\n\t\trefreshFolder: function refreshFolder($el) {\r\n\t\t\tvar $treeFolder = $el.closest('.tree-branch');\r\n\t\t\tvar $treeFolderChildren = $treeFolder.find('.tree-branch-children');\r\n\t\t\t$treeFolderChildren.eq(0).empty();\r\n\r\n\t\t\tif ($treeFolder.hasClass('tree-open')) {\r\n\t\t\t\tthis.populate($treeFolderChildren, false);\r\n\t\t\t} else {\r\n\t\t\t\tthis.populate($treeFolderChildren, true);\r\n\t\t\t}\r\n\r\n\t\t\tthis.$element.trigger('refreshedFolder.fu.tree', $treeFolder.data());\r\n\t\t}\r\n\t});\r\n\r\n\t// ALIASES\r\n\r\n\t// alias for collapse for consistency. \"Collapse\" is an ambiguous term (collapse what? All? One specific branch?)\r\n\tTree.prototype.closeAll = Tree.prototype.collapse;\r\n\t// alias for backwards compatibility because there's no reason not to.\r\n\tTree.prototype.openFolder = Tree.prototype.discloseFolder;\r\n\t// For library consistency\r\n\tTree.prototype.getValue = Tree.prototype.selectedItems;\r\n\r\n\t// PRIVATE FUNCTIONS\r\n\r\n\tvar fixFocusability = function fixFocusability ($tree, $branch) {\r\n\t\t/*\r\n\t\tWhen tree initializes on page, the `<ul>` element should have tabindex=0 and all sub-elements should have\r\n\t\ttabindex=-1. When focus leaves the tree, whatever the last focused on element was will keep the tabindex=0. The\r\n\t\ttree itself will have a tabindex=-1. The reason for this is that if you are inside of the tree and press\r\n\t\tshift+tab, it will try and focus on the tree you are already in, which will cause focus to shift immediately\r\n\t\tback to the element you are already focused on. That will make it seem like the event is getting \"Swallowed up\"\r\n\t\tby an aggressive event listener trap.\r\n\r\n\t\tFor this reason, only one element in the entire tree, including the tree itself, should ever have tabindex=0.\r\n\t\tIf somewhere down the line problems are being caused by this, the only further potential improvement I can\r\n\t\tenvision at this time is listening for the tree to lose focus and reseting the tabindexes of all children to -1\r\n\t\tand setting the tabindex of the tree itself back to 0. This seems overly complicated with no benefit that I can\r\n\t\timagine at this time, so instead I am leaving the last focused element with the tabindex of 0, even upon blur of\r\n\t\tthe tree.\r\n\r\n\t\tOne benefit to leaving the last focused element in a tree with a tabindex=0 is that if you accidentally tab out\r\n\t\tof the tree and then want to tab back in, you will be placed exactly where you left off instead of at the\r\n\t\tbeginning of the tree.\r\n\t\t*/\r\n\t\t$tree.attr('tabindex', -1);\r\n\t\t$tree.find('li').attr('tabindex', -1);\r\n\t\tif ($branch && $branch.length > 0) {\r\n\t\t\t$branch.attr('tabindex', 0); // if tabindex is not set to 0 (or greater), node is not able to receive focus\r\n\t\t}\r\n\t};\r\n\r\n\t// focuses into (onto one of the children of) the provided branch\r\n\tvar focusIn = function focusIn ($tree, $branch) {\r\n\t\tvar $focusCandidate = $branch.find('.tree-selected:first');\r\n\r\n\t\t// if no node is selected, set focus to first visible node\r\n\t\tif ($focusCandidate.length <= 0) {\r\n\t\t\t$focusCandidate = $branch.find('li:not(\".hidden\"):first');\r\n\t\t}\r\n\r\n\t\tsetFocus($tree, $focusCandidate);\r\n\t};\r\n\r\n\t// focuses on provided branch\r\n\tvar setFocus = function setFocus ($tree, $branch) {\r\n\t\tfixFocusability($tree, $branch);\r\n\r\n\t\t$tree.attr('aria-activedescendant', $branch.attr('id'));\r\n\r\n\t\t$branch.focus();\r\n\r\n\t\t$tree.trigger('setFocus.fu.tree', $branch);\r\n\t};\r\n\r\n\tvar navigateTree = function navigateTree ($tree, e) {\r\n\t\tif (e.isDefaultPrevented() || e.isPropagationStopped()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar targetNode = e.originalEvent.target;\r\n\t\tvar $targetNode = $(targetNode);\r\n\t\tvar isOpen = $targetNode.hasClass('tree-open');\r\n\t\tvar handled = false;\r\n\t\t// because es5 lacks promises and fuelux has no polyfil (and I'm not adding one just for this change)\r\n\t\t// I am faking up promises here through callbacks and listeners. Done will be fired immediately at the end of\r\n\t\t// the navigateTree method if there is no (fake) promise, but will be fired by an event listener that will\r\n\t\t// be triggered by another function if necessary. This way when done runs, and fires keyboardNavigated.fu.tree\r\n\t\t// anything listening for that event can be sure that everything tied to that event is actually completed.\r\n\t\tvar fireDoneImmediately = true;\r\n\t\tvar done = function done () {\r\n\t\t\t$tree.trigger('keyboardNavigated.fu.tree', e, $targetNode);\r\n\t\t};\r\n\r\n\t\tswitch (e.which) {\r\n\t\tcase 13: // enter\r\n\t\tcase 32: // space\r\n\t\t\t// activates a node, i.e., performs its default action.\r\n\t\t\t// For parent nodes, one possible default action is to open or close the node.\r\n\t\t\t// In single-select trees where selection does not follow focus, the default action is typically to select the focused node.\r\n\t\t\tvar foldersSelectable = $tree.hasClass('tree-folder-select');\r\n\t\t\tvar isFolder = $targetNode.hasClass('tree-branch');\r\n\t\t\tvar isItem = $targetNode.hasClass('tree-item');\r\n\t\t\t// var isOverflow = $targetNode.hasClass('tree-overflow');\r\n\r\n\t\t\tfireDoneImmediately = false;\r\n\t\t\tif (isFolder) {\r\n\t\t\t\tif (foldersSelectable) {\r\n\t\t\t\t\t$tree.one('selected.fu.tree deselected.fu.tree', done);\r\n\t\t\t\t\t$tree.tree('selectFolder', $targetNode.find('.tree-branch-header')[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$tree.one('loaded.fu.tree closed.fu.tree', done);\r\n\t\t\t\t\t$tree.tree('toggleFolder', $targetNode.find('.tree-branch-header')[0]);\r\n\t\t\t\t}\r\n\t\t\t} else if (isItem) {\r\n\t\t\t\t$tree.one('selected.fu.tree', done);\r\n\t\t\t\t$tree.tree('selectItem', $targetNode);\r\n\t\t\t} else {\r\n\t\t\t\t// should be isOverflow... Try and click on it either way.\r\n\t\t\t\t$prev = $($targetNode.prevAll().not('.hidden')[0]);\r\n\t\t\t\t$targetNode.click();\r\n\r\n\t\t\t\t$tree.one('loaded.fu.tree', function selectFirstNewlyLoadedNode () {\r\n\t\t\t\t\t$next = $($prev.nextAll().not('.hidden')[0]);\r\n\r\n\t\t\t\t\tsetFocus($tree, $next);\r\n\t\t\t\t\tdone();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\thandled = true;\r\n\t\t\tbreak;\r\n\t\tcase 35: // end\r\n\t\t\t// Set focus to the last node in the tree that is focusable without opening a node.\r\n\t\t\tsetFocus($tree, $tree.find('li:not(\".hidden\"):last'));\r\n\r\n\t\t\thandled = true;\r\n\t\t\tbreak;\r\n\t\tcase 36: // home\r\n\t\t\t// set focus to the first node in the tree without opening or closing a node.\r\n\t\t\tsetFocus($tree, $tree.find('li:not(\".hidden\"):first'));\r\n\r\n\t\t\thandled = true;\r\n\t\t\tbreak;\r\n\t\tcase 37: // left\r\n\t\t\tif (isOpen) {\r\n\t\t\t\tfireDoneImmediately = false;\r\n\t\t\t\t$tree.one('closed.fu.tree', done);\r\n\t\t\t\t$tree.tree('closeFolder', targetNode);\r\n\t\t\t} else {\r\n\t\t\t\tsetFocus($tree, $($targetNode.parents('li')[0]));\r\n\t\t\t}\r\n\r\n\t\t\thandled = true;\r\n\t\t\tbreak;\r\n\r\n\t\tcase 38: // up\r\n\t\t\t// move focus to previous sibling\r\n\t\t\tvar $prev = [];\r\n\t\t\t// move to previous li not hidden\r\n\t\t\t$prev = $($targetNode.prevAll().not('.hidden')[0]);\r\n\r\n\t\t\t// if the previous li is open, and has children, move selection to its last child so selection\r\n\t\t\t// appears to move to the next \"thing\" up\r\n\t\t\tif ($prev.hasClass('tree-open')) {\r\n\t\t\t\tvar $prevChildren = $prev.find('li:not(\".hidden\"):last');\r\n\t\t\t\tif ($prevChildren.length > 0) {\r\n\t\t\t\t\t$prev = $($prevChildren[0]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// if nothing has been selected, we are presumably at the top of an open li, select the immediate parent\r\n\t\t\tif ($prev.length < 1) {\r\n\t\t\t\t$prev = $($targetNode.parents('li')[0]);\r\n\t\t\t}\r\n\t\t\tsetFocus($tree, $prev);\r\n\r\n\t\t\thandled = true;\r\n\t\t\tbreak;\r\n\r\n\t\tcase 39: // right\r\n\t\t\tif (isOpen) {\r\n\t\t\t\tfocusIn($tree, $targetNode);\r\n\t\t\t} else {\r\n\t\t\t\tfireDoneImmediately = false;\r\n\t\t\t\t$tree.one('disclosed.fu.tree', done);\r\n\t\t\t\t$tree.tree('discloseFolder', targetNode);\r\n\t\t\t}\r\n\r\n\t\t\thandled = true;\r\n\t\t\tbreak;\r\n\r\n\t\tcase 40: // down\r\n\t\t\t// move focus to next selectable tree node\r\n\t\t\tvar $next = $($targetNode.find('li:not(\".hidden\"):first')[0]);\r\n\t\t\tif (!isOpen || $next.length <= 0) {\r\n\t\t\t\t$next = $($targetNode.nextAll().not('.hidden')[0]);\r\n\t\t\t}\r\n\r\n\t\t\tif ($next.length < 1) {\r\n\t\t\t\t$next = $($($targetNode.parents('li')[0]).nextAll().not('.hidden')[0]);\r\n\t\t\t}\r\n\t\t\tsetFocus($tree, $next);\r\n\r\n\t\t\thandled = true;\r\n\t\t\tbreak;\r\n\r\n\t\tdefault:\r\n\t\t\t// console.log(e.which);\r\n\t\t\treturn true; // exit this handler for other keys\r\n\t\t}\r\n\r\n\t\t// if we didn't handle the event, allow propagation to continue so something else might.\r\n\t\tif (handled) {\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t\tif (fireDoneImmediately) {\r\n\t\t\t\tdone();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t};\r\n\r\n\tvar ariaSelect = function ariaSelect ($element) {\r\n\t\t$element.attr('aria-selected', true);\r\n\t};\r\n\r\n\tvar ariaDeselect = function ariaDeselect ($element) {\r\n\t\t$element.attr('aria-selected', false);\r\n\t};\r\n\r\n\tfunction styleNodeSelected ($element, $icon) {\r\n\t\t$element.addClass('tree-selected');\r\n\t\tif ( $element.data('type') === 'item' && $icon.hasClass('fueluxicon-bullet') ) {\r\n\t\t\t$icon.removeClass('fueluxicon-bullet').addClass('glyphicon-ok'); // make checkmark\r\n\t\t}\r\n\t}\r\n\r\n\tfunction styleNodeDeselected ($element, $icon) {\r\n\t\t$element.removeClass('tree-selected');\r\n\t\tif ( $element.data('type') === 'item' && $icon.hasClass('glyphicon-ok') ) {\r\n\t\t\t$icon.removeClass('glyphicon-ok').addClass('fueluxicon-bullet'); // make bullet\r\n\t\t}\r\n\t}\r\n\r\n\tfunction multiSelectSyncNodes (self, clicked, selected) {\r\n\t\t// search for currently selected and add to selected data list if needed\r\n\t\tlangx.each(selected.$elements, function findCurrentlySelected (index, element) {\r\n\t\t\tvar $element = $(element);\r\n\r\n\t\t\tif ($element[0] !== clicked.$element[0]) {\r\n\t\t\t\tselected.dataForEvent.push( $($element).data() );\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (clicked.$element.hasClass('tree-selected')) {\r\n\t\t\tstyleNodeDeselected(clicked.$element, clicked.$icon);\r\n\t\t\t// set event data\r\n\t\t\tselected.eventType = 'deselected';\r\n\t\t} else {\r\n\t\t\tstyleNodeSelected(clicked.$element, clicked.$icon);\r\n\t\t\t// set event data\r\n\t\t\tselected.eventType = 'selected';\r\n\t\t\tselected.dataForEvent.push(clicked.elementData);\r\n\t\t}\r\n\r\n\t\treturn selected;\r\n\t}\r\n\r\n\tfunction singleSelectSyncNodes(self, clicked, selected) {\r\n\t\t// element is not currently selected\r\n\t\tif (selected.$elements[0] !== clicked.$element[0]) {\r\n\t\t\tself.deselectAll(self.$element);\r\n\t\t\tstyleNodeSelected(clicked.$element, clicked.$icon);\r\n\t\t\t// set event data\r\n\t\t\tselected.eventType = 'selected';\r\n\t\t\tselected.dataForEvent = [clicked.elementData];\r\n\t\t} else {\r\n\t\t\tstyleNodeDeselected(clicked.$element, clicked.$icon);\r\n\t\t\t// set event data\r\n\t\t\tselected.eventType = 'deselected';\r\n\t\t\tselected.dataForEvent = [];\r\n\t\t}\r\n\r\n\t\treturn selected;\r\n\t}\r\n\r\n\t// TREE PLUGIN DEFINITION\r\n\r\n\t$.fn.tree = function fntree (option) {\r\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\t\tvar methodReturn;\r\n\r\n\t\tvar $set = this.each(function eachThis () {\r\n\t\t\tvar $this = $(this);\r\n\t\t\tvar data = $this.data('fu.tree');\r\n\t\t\tvar options = typeof option === 'object' && option;\r\n\r\n\t\t\tif (!data) {\r\n\t\t\t\t$this.data('fu.tree', (data = new Tree(this, options)));\r\n\t\t\t\t$this.trigger('initialized.fu.tree');\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof option === 'string') {\r\n\t\t\t\tmethodReturn = data[option].apply(data, args);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\r\n\t};\r\n\r\n\t/*\r\n\t * Private method used only by the default dataSource for the tree, which is used to consume static\r\n\t * tree data.\r\n\t *\r\n\t * Find children of supplied parent in rootData. You can pass in an entire deeply nested tree\r\n\t * and this will look through it recursively until it finds the child data you are looking for.\r\n\t *\r\n\t * For extremely large trees, this could cause the browser to crash, as there is no protection\r\n\t * or limit on the amount of branches that will be searched through.\r\n\t */\r\n\tvar findChildData = function findChildData (targetParent, rootData) {\r\n\t\tvar isRootOfTree = $.isEmptyObject(targetParent);\r\n\t\tif (isRootOfTree) {\r\n\t\t\treturn rootData;\r\n\t\t}\r\n\r\n\t\tif (rootData === undefined) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < rootData.length; i++) {\r\n\t\t\tvar potentialMatch = rootData[i];\r\n\r\n\t\t\tif (potentialMatch.attr && targetParent.attr && potentialMatch.attr.id === targetParent.attr.id) {\r\n\t\t\t\treturn potentialMatch.children;\r\n\t\t\t} else if (potentialMatch.children) {\r\n\t\t\t\tvar foundChild = findChildData(targetParent, potentialMatch.children);\r\n\t\t\t\tif (foundChild) {\r\n\t\t\t\t\treturn foundChild;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t};\r\n\r\n\t$.fn.tree.defaults = {\r\n\t\t/*\r\n\t\t * A static data representation of your full tree data. If you do not override the tree's\r\n\t\t * default dataSource method, this will just make the tree work out of the box without\r\n\t\t * you having to bring your own dataSource.\r\n\t\t *\r\n\t\t * Array of Objects representing tree branches (folder) and leaves (item):\r\n\t\t\t[\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '',\r\n\t\t\t\t\ttype: 'folder',\r\n\t\t\t\t\tattr: {\r\n\t\t\t\t\t\tid: ''\r\n\t\t\t\t\t},\r\n\t\t\t\t\tchildren: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tname: '',\r\n\t\t\t\t\t\t\ttype: 'item',\r\n\t\t\t\t\t\t\tattr: {\r\n\t\t\t\t\t\t\t\tid: '',\r\n\t\t\t\t\t\t\t\t'data-icon': 'glyphicon glyphicon-file'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '',\r\n\t\t\t\t\ttype: 'item',\r\n\t\t\t\t\tattr: {\r\n\t\t\t\t\t\tid: '',\r\n\t\t\t\t\t\t'data-icon': 'glyphicon glyphicon-file'\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t */\r\n\t\tstaticData: [],\r\n\t\t/*\r\n\t\t * If you set the full tree data on options.staticData, you can use this default dataSource\r\n\t\t * to consume that data. This allows you to just pass in a JSON array representation\r\n\t\t * of your full tree data and the tree will just work out of the box.\r\n\t\t */\r\n\t\tdataSource: function staticDataSourceConsumer (openedParentData, callback) {\r\n\t\t\tif (this.staticData.length > 0) {\r\n\t\t\t\tvar childData = findChildData(openedParentData, this.staticData);\r\n\r\n\t\t\t\tcallback({\r\n\t\t\t\t\tdata: childData\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tmultiSelect: false,\r\n\t\tcacheItems: true,\r\n\t\tfolderSelect: true,\r\n\t\titemSelect: true,\r\n\t\t/*\r\n\t\t* How many times `discloseAll` should be called before a stopping and firing\r\n\t\t* an `exceededDisclosuresLimit` event. You can force it to continue by\r\n\t\t* listening for this event, setting `ignore-disclosures-limit` to `true` and\r\n\t\t* starting `discloseAll` back up again. This lets you make more decisions\r\n\t\t* about if/when/how/why/how many times `discloseAll` will be started back\r\n\t\t* up after it exceeds the limit.\r\n\t\t*\r\n\t\t*    $tree.one('exceededDisclosuresLimit.fu.tree', function () {\r\n\t\t*        $tree.data('ignore-disclosures-limit', true);\r\n\t\t*        $tree.tree('discloseAll');\r\n\t\t*    });\r\n\t\t*\r\n\t\t* `disclusuresUpperLimit` defaults to `0`, so by default this trigger\r\n\t\t* will never fire. The true hard the upper limit is the browser's\r\n\t\t* ability to load new items (i.e. it will keep loading until the browser\r\n\t\t* falls over and dies). On the Fuel UX `index.html` page, the point at\r\n\t\t* which the page became super slow (enough to seem almost unresponsive)\r\n\t\t* was `4`, meaning 256 folders had been opened, and 1024 were attempting to open.\r\n\t\t*/\r\n\t\tdisclosuresUpperLimit: 0\r\n\t};\r\n\r\n\t$.fn.tree.Constructor = Tree;\r\n\r\n\t$.fn.tree.noConflict = function noConflict () {\r\n\t\t$.fn.tree = old;\r\n\t\treturn this;\r\n\t};\r\n\r\n\treturn $.fn.tree;\r\n});\ndefine('skylark-fuelux/wizard',[\n  \"skylark-langx/langx\",\n  \"skylark-domx/browser\",\n  \"skylark-domx/eventer\",\n  \"skylark-domx/noder\",\n  \"skylark-domx/geom\",\n  \"skylark-domx/query\",\n  \"./fuelux\"\n],function(langx,browser,eventer,noder,geom,$,fuelux){\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\tvar old = $.fn.wizard;\n\n\t// WIZARD CONSTRUCTOR AND PROTOTYPE\n\n\tvar Wizard = fuelux.Wizard = fuelux.WidgetBase.inherit({\n\t\tklassName: \"Wizard\",\n\n\t\tinit : function(element,options) {\n\t\t\tthis.$element = $(element);\n\t\t\tthis.options = langx.mixin({}, $.fn.wizard.defaults, options);\n\t\t\tthis.options.disablePreviousStep = (this.$element.attr('data-restrict') === 'previous') ? true : this.options.disablePreviousStep;\n\t\t\tthis.currentStep = this.options.selectedItem.step;\n\t\t\tthis.numSteps = this.$element.find('.steps li').length;\n\t\t\tthis.$prevBtn = this.$element.find('button.btn-prev');\n\t\t\tthis.$nextBtn = this.$element.find('button.btn-next');\n\n\t\t\tvar kids = this.$nextBtn.children().detach();\n\t\t\tthis.nextText = langx.trim(this.$nextBtn.text());\n\t\t\tthis.$nextBtn.append(kids);\n\n\t\t\tvar steps = this.$element.children('.steps-container');\n\t\t\t// maintains backwards compatibility with < 3.8, will be removed in the future\n\t\t\tif (steps.length === 0) {\n\t\t\t\tsteps = this.$element;\n\t\t\t\tthis.$element.addClass('no-steps-container');\n\t\t\t\tif (window && window.console && window.console.warn) {\n\t\t\t\t\twindow.console.warn('please update your wizard markup to include \".steps-container\" as seen in http://getfuelux.com/javascript.html#wizard-usage-markup');\n\t\t\t\t}\n\t\t\t}\n\t\t\tsteps = steps.find('.steps');\n\n\t\t\t// handle events\n\t\t\tthis.$prevBtn.on('click.fu.wizard', langx.proxy(this.previous, this));\n\t\t\tthis.$nextBtn.on('click.fu.wizard', langx.proxy(this.next, this));\n\t\t\tsteps.on('click.fu.wizard', 'li.complete', langx.proxy(this.stepclicked, this));\n\n\t\t\tthis.selectedItem(this.options.selectedItem);\n\n\t\t\tif (this.options.disablePreviousStep) {\n\t\t\t\tthis.$prevBtn.attr('disabled', true);\n\t\t\t\tthis.$element.find('.steps').addClass('previous-disabled');\n\t\t\t}\n\t\t},\n\n\t\tdestroy: function () {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings [none]\n\t\t\t// empty elements to return to original markup [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\t//index is 1 based\n\t\t//second parameter can be array of objects [{ ... }, { ... }] or you can pass n additional objects as args\n\t\t//object structure is as follows (all params are optional): { badge: '', label: '', pane: '' }\n\t\taddSteps: function (index) {\n\t\t\tvar items = [].slice.call(arguments).slice(1);\n\t\t\tvar $steps = this.$element.find('.steps');\n\t\t\tvar $stepContent = this.$element.find('.step-content');\n\t\t\tvar i, l, $pane, $startPane, $startStep, $step;\n\n\t\t\tindex = (index === -1 || (index > (this.numSteps + 1))) ? this.numSteps + 1 : index;\n\t\t\tif (items[0] instanceof Array) {\n\t\t\t\titems = items[0];\n\t\t\t}\n\n\t\t\t$startStep = $steps.find('li:nth-child(' + index + ')');\n\t\t\t$startPane = $stepContent.find('.step-pane:nth-child(' + index + ')');\n\t\t\tif ($startStep.length < 1) {\n\t\t\t\t$startStep = null;\n\t\t\t}\n\n\t\t\tfor (i = 0, l = items.length; i < l; i++) {\n\t\t\t\t$step = $('<li data-step=\"' + index + '\"><span class=\"badge badge-info\"></span></li>');\n\t\t\t\t$step.append(items[i].label || '').append('<span class=\"chevron\"></span>');\n\t\t\t\t$step.find('.badge').append(items[i].badge || index);\n\n\t\t\t\t$pane = $('<div class=\"step-pane\" data-step=\"' + index + '\"></div>');\n\t\t\t\t$pane.append(items[i].pane || '');\n\n\t\t\t\tif (!$startStep) {\n\t\t\t\t\t$steps.append($step);\n\t\t\t\t\t$stepContent.append($pane);\n\t\t\t\t} else {\n\t\t\t\t\t$startStep.before($step);\n\t\t\t\t\t$startPane.before($pane);\n\t\t\t\t}\n\n\t\t\t\tindex++;\n\t\t\t}\n\n\t\t\tthis.syncSteps();\n\t\t\tthis.numSteps = $steps.find('li').length;\n\t\t\tthis.setState();\n\t\t},\n\n\t\t//index is 1 based, howMany is number to remove\n\t\tremoveSteps: function (index, howMany) {\n\t\t\tvar action = 'nextAll';\n\t\t\tvar i = 0;\n\t\t\tvar $steps = this.$element.find('.steps');\n\t\t\tvar $stepContent = this.$element.find('.step-content');\n\t\t\tvar $start;\n\n\t\t\thowMany = (howMany !== undefined) ? howMany : 1;\n\n\t\t\tif (index > $steps.find('li').length) {\n\t\t\t\t$start = $steps.find('li:last');\n\t\t\t} else {\n\t\t\t\t$start = $steps.find('li:nth-child(' + index + ')').prev();\n\t\t\t\tif ($start.length < 1) {\n\t\t\t\t\taction = 'children';\n\t\t\t\t\t$start = $steps;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t$start[action]().each(function () {\n\t\t\t\tvar item = $(this);\n\t\t\t\tvar step = item.attr('data-step');\n\t\t\t\tif (i < howMany) {\n\t\t\t\t\titem.remove();\n\t\t\t\t\t$stepContent.find('.step-pane[data-step=\"' + step + '\"]:first').remove();\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\ti++;\n\t\t\t});\n\n\t\t\tthis.syncSteps();\n\t\t\tthis.numSteps = $steps.find('li').length;\n\t\t\tthis.setState();\n\t\t},\n\n\t\tsetState: function () {\n\t\t\tvar canMovePrev = (this.currentStep > 1);//remember, steps index is 1 based...\n\t\t\tvar isFirstStep = (this.currentStep === 1);\n\t\t\tvar isLastStep = (this.currentStep === this.numSteps);\n\n\t\t\t// disable buttons based on current step\n\t\t\tif (!this.options.disablePreviousStep) {\n\t\t\t\tthis.$prevBtn.attr('disabled', (isFirstStep === true || canMovePrev === false));\n\t\t\t}\n\n\t\t\t// change button text of last step, if specified\n\t\t\tvar last = this.$nextBtn.attr('data-last');\n\t\t\tif (last) {\n\t\t\t\tthis.lastText = last;\n\t\t\t\t// replace text\n\t\t\t\tvar text = this.nextText;\n\t\t\t\tif (isLastStep === true) {\n\t\t\t\t\ttext = this.lastText;\n\t\t\t\t\t// add status class to wizard\n\t\t\t\t\tthis.$element.addClass('complete');\n\t\t\t\t} else {\n\t\t\t\t\tthis.$element.removeClass('complete');\n\t\t\t\t}\n\n\t\t\t\tvar kids = this.$nextBtn.children().detach();\n\t\t\t\tthis.$nextBtn.text(text).append(kids);\n\t\t\t}\n\n\t\t\t// reset classes for all steps\n\t\t\tvar $steps = this.$element.find('.steps li');\n\t\t\t$steps.removeClass('active').removeClass('complete');\n\t\t\t$steps.find('span.badge').removeClass('badge-info').removeClass('badge-success');\n\n\t\t\t// set class for all previous steps\n\t\t\tvar prevSelector = '.steps li:lt(' + (this.currentStep - 1) + ')';\n\t\t\tvar $prevSteps = this.$element.find(prevSelector);\n\t\t\t$prevSteps.addClass('complete');\n\t\t\t$prevSteps.find('span.badge').addClass('badge-success');\n\n\t\t\t// set class for current step\n\t\t\tvar currentSelector = '.steps li:eq(' + (this.currentStep - 1) + ')';\n\t\t\tvar $currentStep = this.$element.find(currentSelector);\n\t\t\t$currentStep.addClass('active');\n\t\t\t$currentStep.find('span.badge').addClass('badge-info');\n\n\t\t\t// set display of target element\n\t\t\tvar $stepContent = this.$element.find('.step-content');\n\t\t\tvar target = $currentStep.attr('data-step');\n\t\t\t$stepContent.find('.step-pane').removeClass('active');\n\t\t\t$stepContent.find('.step-pane[data-step=\"' + target + '\"]:first').addClass('active');\n\n\t\t\t// reset the wizard position to the left\n\t\t\tthis.$element.find('.steps').first().attr('style', 'margin-left: 0');\n\n\t\t\t// check if the steps are wider than the container div\n\t\t\tvar totalWidth = 0;\n\t\t\tthis.$element.find('.steps > li').each(function () {\n\t\t\t\ttotalWidth += $(this).outerWidth();\n\t\t\t});\n\t\t\tvar containerWidth = 0;\n\t\t\tif (this.$element.find('.actions').length) {\n\t\t\t\tcontainerWidth = this.$element.width() - this.$element.find('.actions').first().outerWidth();\n\t\t\t} else {\n\t\t\t\tcontainerWidth = this.$element.width();\n\t\t\t}\n\n\t\t\tif (totalWidth > containerWidth) {\n\t\t\t\t// set the position so that the last step is on the right\n\t\t\t\tvar newMargin = totalWidth - containerWidth;\n\t\t\t\tthis.$element.find('.steps').first().attr('style', 'margin-left: -' + newMargin + 'px');\n\n\t\t\t\t// set the position so that the active step is in a good\n\t\t\t\t// position if it has been moved out of view\n\t\t\t\tif (this.$element.find('li.active').first().position().left < 200) {\n\t\t\t\t\tnewMargin += this.$element.find('li.active').first().position().left - 200;\n\t\t\t\t\tif (newMargin < 1) {\n\t\t\t\t\t\tthis.$element.find('.steps').first().attr('style', 'margin-left: 0');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.$element.find('.steps').first().attr('style', 'margin-left: -' + newMargin + 'px');\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// only fire changed event after initializing\n\t\t\tif (typeof (this.initialized) !== 'undefined') {\n\t\t\t\tvar e = eventer.create('changed.fu.wizard');\n\t\t\t\tthis.$element.trigger(e, {\n\t\t\t\t\tstep: this.currentStep\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.initialized = true;\n\t\t},\n\n\t\tstepclicked: function (e) {\n\t\t\tvar li = $(e.currentTarget);\n\t\t\tvar index = this.$element.find('.steps li').index(li);\n\n\t\t\tif (index < this.currentStep && this.options.disablePreviousStep) {//enforce restrictions\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tvar evt = eventer.create('stepclicked.fu.wizard');\n\t\t\t\tthis.$element.trigger(evt, {\n\t\t\t\t\tstep: index + 1\n\t\t\t\t});\n\t\t\t\tif (evt.isDefaultPrevented()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.currentStep = (index + 1);\n\t\t\t\tthis.setState();\n\t\t\t}\n\t\t},\n\n\t\tsyncSteps: function () {\n\t\t\tvar i = 1;\n\t\t\tvar $steps = this.$element.find('.steps');\n\t\t\tvar $stepContent = this.$element.find('.step-content');\n\n\t\t\t$steps.children().each(function () {\n\t\t\t\tvar item = $(this);\n\t\t\t\tvar badge = item.find('.badge');\n\t\t\t\tvar step = item.attr('data-step');\n\n\t\t\t\tif (!isNaN(parseInt(badge.html(), 10))) {\n\t\t\t\t\tbadge.html(i);\n\t\t\t\t}\n\n\t\t\t\titem.attr('data-step', i);\n\t\t\t\t$stepContent.find('.step-pane[data-step=\"' + step + '\"]:last').attr('data-step', i);\n\t\t\t\ti++;\n\t\t\t});\n\t\t},\n\n\t\tprevious: function () {\n\t\t\tif (this.options.disablePreviousStep || this.currentStep === 1) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar e = eventer.create('actionclicked.fu.wizard');\n\t\t\tthis.$element.trigger(e, {\n\t\t\t\tstep: this.currentStep,\n\t\t\t\tdirection: 'previous'\n\t\t\t});\n\t\t\tif (e.isDefaultPrevented()) {\n\t\t\t\treturn;\n\t\t\t}// don't increment ...what? Why?\n\n\t\t\tthis.currentStep -= 1;\n\t\t\tthis.setState();\n\n\t\t\t// only set focus if focus is still on the $nextBtn (avoid stomping on a focus set programmatically in actionclicked callback)\n\t\t\tif (this.$prevBtn.is(':focus')) {\n\t\t\t\tvar firstFormField = this.$element.find('.active').find('input, select, textarea')[0];\n\n\t\t\t\tif (typeof firstFormField !== 'undefined') {\n\t\t\t\t\t// allow user to start typing immediately instead of having to click on the form field.\n\t\t\t\t\t$(firstFormField).focus();\n\t\t\t\t} else if (this.$element.find('.active input:first').length === 0 && this.$prevBtn.is(':disabled')) {\n\t\t\t\t\t//only set focus on a button as the last resort if no form fields exist and the just clicked button is now disabled\n\t\t\t\t\tthis.$nextBtn.focus();\n\t\t\t\t}\n\n\t\t\t}\n\t\t},\n\n\t\tnext: function () {\n\t\t\tvar e = eventer.create('actionclicked.fu.wizard');\n\t\t\tthis.$element.trigger(e, {\n\t\t\t\tstep: this.currentStep,\n\t\t\t\tdirection: 'next'\n\t\t\t});\n\t\t\tif (e.isDefaultPrevented()) {\n\t\t\t\treturn;\n\t\t\t}// respect preventDefault in case dev has attached validation to step and wants to stop propagation based on it.\n\n\t\t\tif (this.currentStep < this.numSteps) {\n\t\t\t\tthis.currentStep += 1;\n\t\t\t\tthis.setState();\n\t\t\t} else {//is last step\n\t\t\t\tthis.$element.trigger('finished.fu.wizard');\n\t\t\t}\n\n\t\t\t// only set focus if focus is still on the $nextBtn (avoid stomping on a focus set programmatically in actionclicked callback)\n\t\t\tif (this.$nextBtn.is(':focus')) {\n\t\t\t\tvar firstFormField = this.$element.find('.active').find('input, select, textarea')[0];\n\n\t\t\t\tif (typeof firstFormField !== 'undefined') {\n\t\t\t\t\t// allow user to start typing immediately instead of having to click on the form field.\n\t\t\t\t\t$(firstFormField).focus();\n\t\t\t\t} else if (this.$element.find('.active input:first').length === 0 && this.$nextBtn.is(':disabled')) {\n\t\t\t\t\t//only set focus on a button as the last resort if no form fields exist and the just clicked button is now disabled\n\t\t\t\t\tthis.$prevBtn.focus();\n\t\t\t\t}\n\n\t\t\t}\n\t\t},\n\n\t\tselectedItem: function (selectedItem) {\n\t\t\tvar retVal, step;\n\n\t\t\tif (selectedItem) {\n\t\t\t\tstep = selectedItem.step || -1;\n\t\t\t\t//allow selection of step by data-name\n\t\t\t\tstep = Number(this.$element.find('.steps li[data-name=\"' + step + '\"]').first().attr('data-step')) || Number(step);\n\n\t\t\t\tif (1 <= step && step <= this.numSteps) {\n\t\t\t\t\tthis.currentStep = step;\n\t\t\t\t\tthis.setState();\n\t\t\t\t} else {\n\t\t\t\t\tstep = this.$element.find('.steps li.active:first').attr('data-step');\n\t\t\t\t\tif (!isNaN(step)) {\n\t\t\t\t\t\tthis.currentStep = parseInt(step, 10);\n\t\t\t\t\t\tthis.setState();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tretVal = this;\n\t\t\t} else {\n\t\t\t\tretVal = {\n\t\t\t\t\tstep: this.currentStep\n\t\t\t\t};\n\t\t\t\tif (this.$element.find('.steps li.active:first[data-name]').length) {\n\t\t\t\t\tretVal.stepname = this.$element.find('.steps li.active:first').attr('data-name');\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn retVal;\n\t\t}\n\n\t});\n\n\n\t// WIZARD PLUGIN DEFINITION\n\n\t$.fn.wizard = function (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.wizard');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.wizard', (data = new Wizard(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.wizard.defaults = {\n\t\tdisablePreviousStep: false,\n\t\tselectedItem: {\n\t\t\tstep: -1\n\t\t}//-1 means it will attempt to look for \"active\" class in order to set the step\n\t};\n\n\t$.fn.wizard.Constructor = Wizard;\n\n\t$.fn.wizard.noConflict = function () {\n\t\t$.fn.wizard = old;\n\t\treturn this;\n\t};\n\n\n\t// DATA-API\n\n\t/*\n\t$(document).on('mouseover.fu.wizard.data-api', '[data-initialize=wizard]', function (e) {\n\t\tvar $control = $(e.target).closest('.wizard');\n\t\tif (!$control.data('fu.wizard')) {\n\t\t\t$control.wizard($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function () {\n\t\t$('[data-initialize=wizard]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif ($this.data('fu.wizard')) return;\n\t\t\t$this.wizard($this.data());\n\t\t});\n\t});\n\t*/\n\n\treturn $.fn.wizard ;\n\n});\n\ndefine('skylark-fuelux/repeater',[\r\n  \"skylark-langx/skylark\",\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx/browser\",\r\n  \"skylark-domx/eventer\",\r\n  \"skylark-domx/noder\",\r\n  \"skylark-domx/geom\",\r\n  \"skylark-domx/query\",\r\n  \"./fuelux\",\r\n  \"./loader\",\r\n  \"./selectlist\",\r\n  \"./combobox\"  \r\n],function(skylark,langx,browser,eventer,noder,geom,$,fuelux){\r\n\r\n\t/*\r\n\t * Repeater\r\n\t * https://github.com/ExactTarget/fuelux\r\n\t *\r\n\t * Copyright (c) 2014 ExactTarget\r\n\t * Licensed under the BSD New license.\r\n\t */\r\n\r\n\tvar old = $.fn.repeater;\r\n\r\n\t// REPEATER CONSTRUCTOR AND PROTOTYPE\r\n\r\n\tvar Repeater = fuelux.Repeater = fuelux.WidgetBase.inherit({\r\n\t\tklassName: \"Repeater\",\r\n\r\n\t\tinit : function(element,options) {\r\n\t\t\tvar self = this;\r\n\t\t\tvar $btn;\r\n\t\t\tvar currentView;\r\n\r\n\t\t\tthis.$element = $(element);\r\n\r\n\t\t\tthis.$canvas = this.$element.find('.repeater-canvas');\r\n\t\t\tthis.$count = this.$element.find('.repeater-count');\r\n\t\t\tthis.$end = this.$element.find('.repeater-end');\r\n\t\t\tthis.$filters = this.$element.find('.repeater-filters');\r\n\t\t\tthis.$loader = this.$element.find('.repeater-loader');\r\n\t\t\tthis.$pageSize = this.$element.find('.repeater-itemization .selectlist');\r\n\t\t\tthis.$nextBtn = this.$element.find('.repeater-next');\r\n\t\t\tthis.$pages = this.$element.find('.repeater-pages');\r\n\t\t\tthis.$prevBtn = this.$element.find('.repeater-prev');\r\n\t\t\tthis.$primaryPaging = this.$element.find('.repeater-primaryPaging');\r\n\t\t\tthis.$search = this.$element.find('.repeater-search').find('.search');\r\n\t\t\tthis.$secondaryPaging = this.$element.find('.repeater-secondaryPaging');\r\n\t\t\tthis.$start = this.$element.find('.repeater-start');\r\n\t\t\tthis.$viewport = this.$element.find('.repeater-viewport');\r\n\t\t\tthis.$views = this.$element.find('.repeater-views');\r\n\r\n\t\t\tthis.$element.on('mousedown.bs.dropdown.data-api', '[data-toggle=\"dropdown\"]',function(e) {\r\n\t\t\t\t$(this).dropdown();\r\n\t\t\t}); \r\n\r\n\t\t\tthis.currentPage = 0;\r\n\t\t\tthis.currentView = null;\r\n\t\t\tthis.isDisabled = false;\r\n\t\t\tthis.infiniteScrollingCallback = function noop () {};\r\n\t\t\tthis.infiniteScrollingCont = null;\r\n\t\t\tthis.infiniteScrollingEnabled = false;\r\n\t\t\tthis.infiniteScrollingEnd = null;\r\n\t\t\tthis.infiniteScrollingOptions = {};\r\n\t\t\tthis.lastPageInput = 0;\r\n\t\t\tthis.options = langx.mixin({}, $.fn.repeater.defaults, options);\r\n\t\t\tthis.pageIncrement = 0;// store direction navigated\r\n\t\t\tthis.resizeTimeout = {};\r\n\t\t\tthis.stamp = new Date().getTime() + (Math.floor(Math.random() * 100) + 1);\r\n\t\t\tthis.storedDataSourceOpts = null;\r\n\t\t\tthis.syncingViewButtonState = false;\r\n\t\t\tthis.viewOptions = {};\r\n\t\t\tthis.viewType = null;\r\n\r\n\t\t\tthis.$filters.selectlist();\r\n\t\t\tthis.$pageSize.selectlist();\r\n\t\t\tthis.$primaryPaging.find('.combobox').combobox();\r\n\t\t\tthis.$search.search({\r\n\t\t\t\tsearchOnKeyPress: this.options.searchOnKeyPress,\r\n\t\t\t\tallowCancel: this.options.allowCancel\r\n\t\t\t});\r\n\r\n\t\t\tthis.$filters.on('changed.fu.selectlist', function onFiltersChanged (e, value) {\r\n\t\t\t\tself.$element.trigger('filtered.fu.repeater', value);\r\n\t\t\t\tself.render({\r\n\t\t\t\t\tclearInfinite: true,\r\n\t\t\t\t\tpageIncrement: null\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tthis.$nextBtn.on('click.fu.repeater', langx.proxy(this.next, this));\r\n\t\t\tthis.$pageSize.on('changed.fu.selectlist', function onPageSizeChanged (e, value) {\r\n\t\t\t\tself.$element.trigger('pageSizeChanged.fu.repeater', value);\r\n\t\t\t\tself.render({\r\n\t\t\t\t\tpageIncrement: null\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tthis.$prevBtn.on('click.fu.repeater', langx.proxy(this.previous, this));\r\n\t\t\tthis.$primaryPaging.find('.combobox').on('changed.fu.combobox', function onPrimaryPagingChanged (evt, data) {\r\n\t\t\t\tself.pageInputChange(data.text, data);\r\n\t\t\t});\r\n\t\t\tthis.$search.on('searched.fu.search cleared.fu.search', function onSearched (e, value) {\r\n\t\t\t\tself.$element.trigger('searchChanged.fu.repeater', value);\r\n\t\t\t\tself.render({\r\n\t\t\t\t\tclearInfinite: true,\r\n\t\t\t\t\tpageIncrement: null\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tthis.$search.on('canceled.fu.search', function onSearchCanceled (e, value) {\r\n\t\t\t\tself.$element.trigger('canceled.fu.repeater', value);\r\n\t\t\t\tself.render({\r\n\t\t\t\t\tclearInfinite: true,\r\n\t\t\t\t\tpageIncrement: null\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\tthis.$secondaryPaging.on('blur.fu.repeater', function onSecondaryPagingBlur () {\r\n\t\t\t\tself.pageInputChange(self.$secondaryPaging.val());\r\n\t\t\t});\r\n\t\t\tthis.$secondaryPaging.on('keyup', function onSecondaryPagingKeyup (e) {\r\n\t\t\t\tif (e.keyCode === 13) {\r\n\t\t\t\t\tself.pageInputChange(self.$secondaryPaging.val());\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.$views.find('input').on('change.fu.repeater', langx.proxy(this.viewChanged, this));\r\n\r\n\t\t\t$(window).on('resize.fu.repeater.' + this.stamp, function onResizeRepeater () {\r\n\t\t\t\tclearTimeout(self.resizeTimeout);\r\n\t\t\t\tself.resizeTimeout = setTimeout(function resizeTimeout () {\r\n\t\t\t\t\tself.resize();\r\n\t\t\t\t\tself.$element.trigger('resized.fu.repeater');\r\n\t\t\t\t}, 75);\r\n\t\t\t});\r\n\r\n\t\t\tthis.$loader.loader();\r\n\t\t\tthis.$loader.loader('pause');\r\n\t\t\tif (this.options.defaultView !== -1) {\r\n\t\t\t\tcurrentView = this.options.defaultView;\r\n\t\t\t} else {\r\n\t\t\t\t$btn = this.$views.find('label.active input');\r\n\t\t\t\tcurrentView = ($btn.length > 0) ? $btn.val() : 'list';\r\n\t\t\t}\r\n\r\n\t\t\tthis.setViewOptions(currentView);\r\n\r\n\t\t\tthis.initViewTypes(function initViewTypes () {\r\n\t\t\t\tself.resize();\r\n\t\t\t\tself.$element.trigger('resized.fu.repeater');\r\n\t\t\t\tself.render({\r\n\t\t\t\t\tchangeView: currentView\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tclear: function clear (opts) {\r\n\t\t\tvar options = opts || {};\r\n\r\n\t\t\tif (!options.preserve) {\r\n\t\t\t\t// Just trash everything because preserve is false\r\n\t\t\t\tthis.$canvas.empty();\r\n\t\t\t} else if (!this.infiniteScrollingEnabled || options.clearInfinite) {\r\n\t\t\t\t// Preserve clear only if infiniteScrolling is disabled or if specifically told to do so\r\n\t\t\t\tscan(this.$canvas);\r\n\t\t\t} // Otherwise don't clear because infiniteScrolling is enabled\r\n\r\n\t\t\t// If viewChanged and current viewTypeObj has a cleared function, call it\r\n\t\t\tvar viewChanged = (options.viewChanged !== undefined) ? options.viewChanged : false;\r\n\t\t\tvar viewTypeObj = $.fn.repeater.viewTypes[this.viewType] || {};\r\n\t\t\tif (!viewChanged && viewTypeObj.cleared) {\r\n\t\t\t\tviewTypeObj.cleared.call(this, {\r\n\t\t\t\t\toptions: options\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tclearPreservedDataSourceOptions: function clearPreservedDataSourceOptions () {\r\n\t\t\tthis.storedDataSourceOpts = null;\r\n\t\t},\r\n\r\n\t\tdestroy: function destroy () {\r\n\t\t\tvar markup;\r\n\t\t\t// set input value attrbute in markup\r\n\t\t\tthis.$element.find('input').each(function eachInput () {\r\n\t\t\t\t$(this).attr('value', $(this).val());\r\n\t\t\t});\r\n\r\n\t\t\t// empty elements to return to original markup\r\n\t\t\tthis.$canvas.empty();\r\n\t\t\tmarkup = this.$element[0].outerHTML;\r\n\r\n\t\t\t// destroy components and remove leftover\r\n\t\t\tthis.$element.find('.combobox').combobox('destroy');\r\n\t\t\tthis.$element.find('.selectlist').selectlist('destroy');\r\n\t\t\tthis.$element.find('.search').search('destroy');\r\n\t\t\tif (this.infiniteScrollingEnabled) {\r\n\t\t\t\t$(this.infiniteScrollingCont).infinitescroll('destroy');\r\n\t\t\t}\r\n\r\n\t\t\tthis.$element.remove();\r\n\r\n\t\t\t// any external events\r\n\t\t\t$(window).off('resize.fu.repeater.' + this.stamp);\r\n\r\n\t\t\treturn markup;\r\n\t\t},\r\n\r\n\t\tdisable: function disable () {\r\n\t\t\tvar viewTypeObj = $.fn.repeater.viewTypes[this.viewType] || {};\r\n\r\n\t\t\tthis.$search.search('disable');\r\n\t\t\tthis.$filters.selectlist('disable');\r\n\t\t\tthis.$views.find('label, input').addClass('disabled').attr('disabled', 'disabled');\r\n\t\t\tthis.$pageSize.selectlist('disable');\r\n\t\t\tthis.$primaryPaging.find('.combobox').combobox('disable');\r\n\t\t\tthis.$secondaryPaging.attr('disabled', 'disabled');\r\n\t\t\tthis.$prevBtn.attr('disabled', 'disabled');\r\n\t\t\tthis.$nextBtn.attr('disabled', 'disabled');\r\n\r\n\t\t\tif (viewTypeObj.enabled) {\r\n\t\t\t\tviewTypeObj.enabled.call(this, {\r\n\t\t\t\t\tstatus: false\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tthis.isDisabled = true;\r\n\t\t\tthis.$element.addClass('disabled');\r\n\t\t\tthis.$element.trigger('disabled.fu.repeater');\r\n\t\t},\r\n\r\n\t\tenable: function enable () {\r\n\t\t\tvar viewTypeObj = $.fn.repeater.viewTypes[this.viewType] || {};\r\n\r\n\t\t\tthis.$search.search('enable');\r\n\t\t\tthis.$filters.selectlist('enable');\r\n\t\t\tthis.$views.find('label, input').removeClass('disabled').removeAttr('disabled');\r\n\t\t\tthis.$pageSize.selectlist('enable');\r\n\t\t\tthis.$primaryPaging.find('.combobox').combobox('enable');\r\n\t\t\tthis.$secondaryPaging.removeAttr('disabled');\r\n\r\n\t\t\tif (!this.$prevBtn.hasClass('page-end')) {\r\n\t\t\t\tthis.$prevBtn.removeAttr('disabled');\r\n\t\t\t}\r\n\t\t\tif (!this.$nextBtn.hasClass('page-end')) {\r\n\t\t\t\tthis.$nextBtn.removeAttr('disabled');\r\n\t\t\t}\r\n\r\n\t\t\t// is 0 or 1 pages, if using $primaryPaging (combobox)\r\n\t\t\t// if using selectlist allow user to use selectlist to select 0 or 1\r\n\t\t\tif (this.$prevBtn.hasClass('page-end') && this.$nextBtn.hasClass('page-end')) {\r\n\t\t\t\tthis.$primaryPaging.combobox('disable');\r\n\t\t\t}\r\n\r\n\t\t\t// if there are no items\r\n\t\t\tif (parseInt(this.$count.html(), 10) !== 0) {\r\n\t\t\t\tthis.$pageSize.selectlist('enable');\r\n\t\t\t} else {\r\n\t\t\t\tthis.$pageSize.selectlist('disable');\r\n\t\t\t}\r\n\r\n\t\t\tif (viewTypeObj.enabled) {\r\n\t\t\t\tviewTypeObj.enabled.call(this, {\r\n\t\t\t\t\tstatus: true\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tthis.isDisabled = false;\r\n\t\t\tthis.$element.removeClass('disabled');\r\n\t\t\tthis.$element.trigger('enabled.fu.repeater');\r\n\t\t},\r\n\r\n\t\tgetDataOptions: function getDataOptions (opts) {\r\n\t\t\tvar options = opts || {};\r\n\t\t\tif (options.pageIncrement !== undefined) {\r\n\t\t\t\tif (options.pageIncrement === null) {\r\n\t\t\t\t\tthis.currentPage = 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.currentPage += options.pageIncrement;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar dataSourceOptions = {};\r\n\t\t\tif (options.dataSourceOptions) {\r\n\t\t\t\tdataSourceOptions = options.dataSourceOptions;\r\n\r\n\t\t\t\tif (options.preserveDataSourceOptions) {\r\n\t\t\t\t\tif (this.storedDataSourceOpts) {\r\n\t\t\t\t\t\tthis.storedDataSourceOpts = langx.mixin(this.storedDataSourceOpts, dataSourceOptions);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.storedDataSourceOpts = dataSourceOptions;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.storedDataSourceOpts) {\r\n\t\t\t\tdataSourceOptions = langx.mixin(this.storedDataSourceOpts, dataSourceOptions);\r\n\t\t\t}\r\n\r\n\t\t\tvar returnOptions = {\r\n\t\t\t\tview: this.currentView,\r\n\t\t\t\tpageIndex: this.currentPage,\r\n\t\t\t\tfilter: {\r\n\t\t\t\t\ttext: 'All',\r\n\t\t\t\t\tvalue: 'all'\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tif (this.$filters.length > 0) {\r\n\t\t\t\treturnOptions.filter = this.$filters.selectlist('selectedItem');\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.infiniteScrollingEnabled) {\r\n\t\t\t\treturnOptions.pageSize = 25;\r\n\r\n\t\t\t\tif (this.$pageSize.length > 0) {\r\n\t\t\t\t\treturnOptions.pageSize = parseInt(this.$pageSize.selectlist('selectedItem').value, 10);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar searchValue = this.$search && this.$search.find('input') && this.$search.find('input').val();\r\n\t\t\tif (searchValue !== '') {\r\n\t\t\t\treturnOptions.search = searchValue;\r\n\t\t\t}\r\n\r\n\t\t\tvar viewType = $.fn.repeater.viewTypes[this.viewType] || {};\r\n\t\t\tvar addViewTypeData = viewType.dataOptions;\r\n\t\t\tif (addViewTypeData) {\r\n\t\t\t\treturnOptions = addViewTypeData.call(this, returnOptions);\r\n\t\t\t}\r\n\r\n\t\t\treturnOptions = langx.mixin(returnOptions, dataSourceOptions);\r\n\r\n\t\t\treturn returnOptions;\r\n\t\t},\r\n\r\n\t\tinfiniteScrolling: function infiniteScrolling (enable, opts) {\r\n\t\t\tvar footer = this.$element.find('.repeater-footer');\r\n\t\t\tvar viewport = this.$element.find('.repeater-viewport');\r\n\t\t\tvar options = opts || {};\r\n\r\n\t\t\tif (enable) {\r\n\t\t\t\tthis.infiniteScrollingEnabled = true;\r\n\t\t\t\tthis.infiniteScrollingEnd = options.end;\r\n\t\t\t\tdelete options.dataSource;\r\n\t\t\t\tdelete options.end;\r\n\t\t\t\tthis.infiniteScrollingOptions = options;\r\n\t\t\t\tviewport.css({\r\n\t\t\t\t\theight: viewport.height() + footer.outerHeight()\r\n\t\t\t\t});\r\n\t\t\t\tfooter.hide();\r\n\t\t\t} else {\r\n\t\t\t\tvar cont = this.infiniteScrollingCont;\r\n\t\t\t\tvar data = cont.data();\r\n\t\t\t\tdelete data.infinitescroll;\r\n\t\t\t\tcont.off('scroll');\r\n\t\t\t\tcont.removeClass('infinitescroll');\r\n\r\n\t\t\t\tthis.infiniteScrollingCont = null;\r\n\t\t\t\tthis.infiniteScrollingEnabled = false;\r\n\t\t\t\tthis.infiniteScrollingEnd = null;\r\n\t\t\t\tthis.infiniteScrollingOptions = {};\r\n\t\t\t\tviewport.css({\r\n\t\t\t\t\theight: viewport.height() - footer.outerHeight()\r\n\t\t\t\t});\r\n\t\t\t\tfooter.show();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tinfiniteScrollPaging: function infiniteScrollPaging (data) {\r\n\t\t\tvar end = (this.infiniteScrollingEnd !== true) ? this.infiniteScrollingEnd : undefined;\r\n\t\t\tvar page = data.page;\r\n\t\t\tvar pages = data.pages;\r\n\r\n\t\t\tthis.currentPage = (page !== undefined) ? page : NaN;\r\n\r\n\t\t\tif (data.end === true || (this.currentPage + 1) >= pages) {\r\n\t\t\t\tthis.infiniteScrollingCont.infinitescroll('end', end);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tinitInfiniteScrolling: function initInfiniteScrolling () {\r\n\t\t\tvar cont = this.$canvas.find('[data-infinite=\"true\"]:first');\r\n\r\n\t\t\tcont = (cont.length < 1) ? this.$canvas : cont;\r\n\t\t\tif (cont.data('fu.infinitescroll')) {\r\n\t\t\t\tcont.infinitescroll('enable');\r\n\t\t\t} else {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar opts = langx.mixin({}, this.infiniteScrollingOptions);\r\n\t\t\t\topts.dataSource = function dataSource (helpers, callback) {\r\n\t\t\t\t\tself.infiniteScrollingCallback = callback;\r\n\t\t\t\t\tself.render({\r\n\t\t\t\t\t\tpageIncrement: 1\r\n\t\t\t\t\t});\r\n\t\t\t\t};\r\n\t\t\t\tcont.infinitescroll(opts);\r\n\t\t\t\tthis.infiniteScrollingCont = cont;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tinitViewTypes: function initViewTypes (callback) {\r\n\t\t\tvar viewTypes = [];\r\n\r\n\t\t\tfor (var key in $.fn.repeater.viewTypes) {\r\n\t\t\t\tif ({}.hasOwnProperty.call($.fn.repeater.viewTypes, key)) {\r\n\t\t\t\t\tviewTypes.push($.fn.repeater.viewTypes[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (viewTypes.length > 0) {\r\n\t\t\t\tinitViewType.call(this, 0, viewTypes, callback);\r\n\t\t\t} else {\r\n\t\t\t\tcallback();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\titemization: function itemization (data) {\r\n\t\t\tthis.$count.html((data.count !== undefined) ? data.count : '?');\r\n\t\t\tthis.$end.html((data.end !== undefined) ? data.end : '?');\r\n\t\t\tthis.$start.html((data.start !== undefined) ? data.start : '?');\r\n\t\t},\r\n\r\n\t\tnext: function next () {\r\n\t\t\tthis.$nextBtn.attr('disabled', 'disabled');\r\n\t\t\tthis.$prevBtn.attr('disabled', 'disabled');\r\n\t\t\tthis.pageIncrement = 1;\r\n\t\t\tthis.$element.trigger('nextClicked.fu.repeater');\r\n\t\t\tthis.render({\r\n\t\t\t\tpageIncrement: this.pageIncrement\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tpageInputChange: function pageInputChange (val, dataFromCombobox) {\r\n\t\t\t// dataFromCombobox is a proxy for data from combobox's changed event,\r\n\t\t\t// if no combobox is present data will be undefined\r\n\t\t\tvar pageInc;\r\n\t\t\tif (val !== this.lastPageInput) {\r\n\t\t\t\tthis.lastPageInput = val;\r\n\t\t\t\tvar value = parseInt(val, 10) - 1;\r\n\t\t\t\tpageInc = value - this.currentPage;\r\n\t\t\t\tthis.$element.trigger('pageChanged.fu.repeater', [value, dataFromCombobox]);\r\n\t\t\t\tthis.render({\r\n\t\t\t\t\tpageIncrement: pageInc\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tpagination: function pagination (data) {\r\n\t\t\tthis.$primaryPaging.removeClass('active');\r\n\t\t\tthis.$secondaryPaging.removeClass('active');\r\n\r\n\t\t\tvar totalPages = data.pages;\r\n\t\t\tthis.currentPage = (data.page !== undefined) ? data.page : NaN;\r\n\t\t\t// set paging to 0 if total pages is 0, otherwise use one-based index\r\n\t\t\tvar currenPageOutput = totalPages === 0 ? 0 : this.currentPage + 1;\r\n\r\n\t\t\tif (totalPages <= this.viewOptions.dropPagingCap) {\r\n\t\t\t\tthis.$primaryPaging.addClass('active');\r\n\t\t\t\tvar dropMenu = this.$primaryPaging.find('.dropdown-menu');\r\n\t\t\t\tdropMenu.empty();\r\n\t\t\t\tfor (var i = 0; i < totalPages; i++) {\r\n\t\t\t\t\tvar l = i + 1;\r\n\t\t\t\t\tdropMenu.append('<li data-value=\"' + l + '\"><a href=\"#\">' + l + '</a></li>');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.$primaryPaging.find('input.form-control').val(currenPageOutput);\r\n\t\t\t} else {\r\n\t\t\t\tthis.$secondaryPaging.addClass('active');\r\n\t\t\t\tthis.$secondaryPaging.val(currenPageOutput);\r\n\t\t\t}\r\n\r\n\t\t\tthis.lastPageInput = this.currentPage + 1 + '';\r\n\r\n\t\t\tthis.$pages.html('' + totalPages);\r\n\r\n\t\t\t// this is not the last page\r\n\t\t\tif ((this.currentPage + 1) < totalPages) {\r\n\t\t\t\tthis.$nextBtn.removeAttr('disabled');\r\n\t\t\t\tthis.$nextBtn.removeClass('page-end');\r\n\t\t\t} else {\r\n\t\t\t\tthis.$nextBtn.attr('disabled', 'disabled');\r\n\t\t\t\tthis.$nextBtn.addClass('page-end');\r\n\t\t\t}\r\n\r\n\t\t\t// this is not the first page\r\n\t\t\tif ((this.currentPage - 1) >= 0) {\r\n\t\t\t\tthis.$prevBtn.removeAttr('disabled');\r\n\t\t\t\tthis.$prevBtn.removeClass('page-end');\r\n\t\t\t} else {\r\n\t\t\t\tthis.$prevBtn.attr('disabled', 'disabled');\r\n\t\t\t\tthis.$prevBtn.addClass('page-end');\r\n\t\t\t}\r\n\r\n\t\t\t// return focus to next/previous buttons after navigating\r\n\t\t\tif (this.pageIncrement !== 0) {\r\n\t\t\t\tif (this.pageIncrement > 0) {\r\n\t\t\t\t\tif (this.$nextBtn.is(':disabled')) {\r\n\t\t\t\t\t\t// if you can't focus, go the other way\r\n\t\t\t\t\t\tthis.$prevBtn.focus();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$nextBtn.focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (this.$prevBtn.is(':disabled')) {\r\n\t\t\t\t\t// if you can't focus, go the other way\r\n\t\t\t\t\tthis.$nextBtn.focus();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$prevBtn.focus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tprevious: function previous () {\r\n\t\t\tthis.$nextBtn.attr('disabled', 'disabled');\r\n\t\t\tthis.$prevBtn.attr('disabled', 'disabled');\r\n\t\t\tthis.pageIncrement = -1;\r\n\t\t\tthis.$element.trigger('previousClicked.fu.repeater');\r\n\t\t\tthis.render({\r\n\t\t\t\tpageIncrement: this.pageIncrement\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// This functions more as a \"pre-render\" than a true \"render\"\r\n\t\trender: function render (opts) {\r\n\t\t\tthis.disable();\r\n\r\n\t\t\tvar viewChanged = false;\r\n\t\t\tvar viewTypeObj = $.fn.repeater.viewTypes[this.viewType] || {};\r\n\t\t\tvar options = opts || {};\r\n\r\n\t\t\tif (options.changeView && (this.currentView !== options.changeView)) {\r\n\t\t\t\tvar prevView = this.currentView;\r\n\t\t\t\tthis.currentView = options.changeView;\r\n\t\t\t\tthis.viewType = this.currentView.split('.')[0];\r\n\t\t\t\tthis.setViewOptions(this.currentView);\r\n\t\t\t\tthis.$element.attr('data-currentview', this.currentView);\r\n\t\t\t\tthis.$element.attr('data-viewtype', this.viewType);\r\n\t\t\t\tviewChanged = true;\r\n\t\t\t\toptions.viewChanged = viewChanged;\r\n\r\n\t\t\t\tthis.$element.trigger('viewChanged.fu.repeater', this.currentView);\r\n\r\n\t\t\t\tif (this.infiniteScrollingEnabled) {\r\n\t\t\t\t\tthis.infiniteScrolling(false);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tviewTypeObj = $.fn.repeater.viewTypes[this.viewType] || {};\r\n\t\t\t\tif (viewTypeObj.selected) {\r\n\t\t\t\t\tviewTypeObj.selected.call(this, {\r\n\t\t\t\t\t\tprevView: prevView\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.syncViewButtonState();\r\n\r\n\t\t\toptions.preserve = (options.preserve !== undefined) ? options.preserve : !viewChanged;\r\n\t\t\tthis.clear(options);\r\n\r\n\t\t\tif (!this.infiniteScrollingEnabled || (this.infiniteScrollingEnabled && viewChanged)) {\r\n\t\t\t\tthis.$loader.show().loader('play');\r\n\t\t\t}\r\n\r\n\t\t\tvar dataOptions = this.getDataOptions(options);\r\n\r\n\t\t\tvar beforeRender = this.viewOptions.dataSource;\r\n\t\t\tvar repeaterPrototypeContext = this;\r\n\t\t\tbeforeRender(\r\n\t\t\t\tdataOptions,\r\n\t\t\t\t// this serves as a bridge function to pass all required data through to the actual function\r\n\t\t\t\t// that does the rendering for us.\r\n\t\t\t\tfunction callDoRender (dataSourceReturnedData) {\r\n\t\t\t\t\tdoRender.call(\r\n\t\t\t\t\t\trepeaterPrototypeContext,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdata: dataSourceReturnedData,\r\n\t\t\t\t\t\t\tdataOptions: dataOptions,\r\n\t\t\t\t\t\t\toptions: options,\r\n\t\t\t\t\t\t\tviewChanged: viewChanged,\r\n\t\t\t\t\t\t\tviewTypeObj: viewTypeObj\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\tresize: function resize () {\r\n\t\t\tvar staticHeight = (this.viewOptions.staticHeight === -1) ? this.$element.attr('data-staticheight') : this.viewOptions.staticHeight;\r\n\t\t\tvar viewTypeObj = {};\r\n\t\t\tvar height;\r\n\t\t\tvar viewportMargins;\r\n\t\t\tvar scrubbedElements = [];\r\n\t\t\tvar previousProperties = [];\r\n\t\t\t//var $hiddenElements = this.$element.parentsUntil(':visible').addBack(); // del addBack() not supported by skyalrk\r\n\t\t\tvar $hiddenElements = this.$element.parentsUntil(':visible');\r\n\t\t\tvar currentHiddenElement;\r\n\t\t\tvar currentElementIndex = 0;\r\n\r\n\t\t\t// Set parents to 'display:block' until repeater is visible again\r\n\t\t\twhile (currentElementIndex < $hiddenElements.length && this.$element.is(':hidden')) {\r\n\t\t\t\tcurrentHiddenElement = $hiddenElements[currentElementIndex];\r\n\t\t\t\t// Only set display property on elements that are explicitly hidden (i.e. do not inherit it from their parent)\r\n\t\t\t\tif ($(currentHiddenElement).is(':hidden')) {\r\n\t\t\t\t\tpreviousProperties.push(currentHiddenElement.style['display']);\r\n\t\t\t\t\tcurrentHiddenElement.style['display'] = 'block';\r\n\t\t\t\t\tscrubbedElements.push(currentHiddenElement);\r\n\t\t\t\t}\r\n\t\t\t\tcurrentElementIndex++;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.viewType) {\r\n\t\t\t\tviewTypeObj = $.fn.repeater.viewTypes[this.viewType] || {};\r\n\t\t\t}\r\n\r\n\t\t\tif (staticHeight !== undefined && staticHeight !== false && staticHeight !== 'false') {\r\n\t\t\t\tthis.$canvas.addClass('scrolling');\r\n\t\t\t\tviewportMargins = {\r\n\t\t\t\t\tbottom: this.$viewport.css('margin-bottom'),\r\n\t\t\t\t\ttop: this.$viewport.css('margin-top')\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar staticHeightValue = (staticHeight === 'true' || staticHeight === true) ? this.$element.height() : parseInt(staticHeight, 10);\r\n\t\t\t\tvar headerHeight = this.$element.find('.repeater-header').outerHeight();\r\n\t\t\t\tvar footerHeight = this.$element.find('.repeater-footer').outerHeight();\r\n\t\t\t\tvar bottomMargin = (viewportMargins.bottom === 'auto') ? 0 : parseInt(viewportMargins.bottom, 10);\r\n\t\t\t\tvar topMargin = (viewportMargins.top === 'auto') ? 0 : parseInt(viewportMargins.top, 10);\r\n\r\n\t\t\t\theight = staticHeightValue - headerHeight - footerHeight - bottomMargin - topMargin;\r\n\t\t\t\tthis.$viewport.outerHeight(height);\r\n\t\t\t} else {\r\n\t\t\t\tthis.$canvas.removeClass('scrolling');\r\n\t\t\t}\r\n\r\n\t\t\tif (viewTypeObj.resize) {\r\n\t\t\t\tviewTypeObj.resize.call(this, {\r\n\t\t\t\t\theight: this.$element.outerHeight(),\r\n\t\t\t\t\twidth: this.$element.outerWidth()\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tscrubbedElements.forEach(function (element, i) {\r\n\t\t\t\telement.style['display'] = previousProperties[i];\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t// e.g. \"Rows\" or \"Thumbnails\"\r\n\t\trenderItems: function renderItems (viewTypeObj, data, callback) {\r\n\t\t\tif (!viewTypeObj.render) {\r\n\t\t\t\tif (viewTypeObj.before) {\r\n\t\t\t\t\tvar addBefore = viewTypeObj.before.call(this, {\r\n\t\t\t\t\t\tcontainer: this.$canvas,\r\n\t\t\t\t\t\tdata: data\r\n\t\t\t\t\t});\r\n\t\t\t\t\taddItem(this.$canvas, addBefore);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar $dataContainer = this.$canvas.find('[data-container=\"true\"]:last');\r\n\t\t\t\tvar $container = ($dataContainer.length > 0) ? $dataContainer : this.$canvas;\r\n\r\n\t\t\t\t// It appears that the following code would theoretically allow you to pass a deeply\r\n\t\t\t\t// nested value to \"repeat on\" to be added to the repeater.\r\n\t\t\t\t// eg. `data.foo.bar.items`\r\n\t\t\t\tif (viewTypeObj.renderItem) {\r\n\t\t\t\t\tvar subset;\r\n\t\t\t\t\tvar objectAndPropsToRepeatOnString = viewTypeObj.repeat || 'data.items';\r\n\t\t\t\t\tvar objectAndPropsToRepeatOn = objectAndPropsToRepeatOnString.split('.');\r\n\t\t\t\t\tvar objectToRepeatOn = objectAndPropsToRepeatOn[0];\r\n\r\n\t\t\t\t\tif (objectToRepeatOn === 'data' || objectToRepeatOn === 'this') {\r\n\t\t\t\t\t\tsubset = (objectToRepeatOn === 'this') ? this : data;\r\n\r\n\t\t\t\t\t\t// Extracts subset from object chain (get `items` out of `foo.bar.items`). I think....\r\n\t\t\t\t\t\tvar propsToRepeatOn = objectAndPropsToRepeatOn.slice(1);\r\n\t\t\t\t\t\tfor (var prop = 0; prop < propsToRepeatOn.length; prop++) {\r\n\t\t\t\t\t\t\tif (subset[propsToRepeatOn[prop]] !== undefined) {\r\n\t\t\t\t\t\t\t\tsubset = subset[propsToRepeatOn[prop]];\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tsubset = [];\r\n\t\t\t\t\t\t\t\tlogWarn('WARNING: Repeater unable to find property to iterate renderItem on.');\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor (var subItemIndex = 0; subItemIndex < subset.length; subItemIndex++) {\r\n\t\t\t\t\t\t\tvar addSubItem = viewTypeObj.renderItem.call(this, {\r\n\t\t\t\t\t\t\t\tcontainer: $container,\r\n\t\t\t\t\t\t\t\tdata: data,\r\n\t\t\t\t\t\t\t\tindex: subItemIndex,\r\n\t\t\t\t\t\t\t\tsubset: subset\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\taddItem($container, addSubItem);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlogWarn('WARNING: Repeater plugin \"repeat\" value must start with either \"data\" or \"this\"');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (viewTypeObj.after) {\r\n\t\t\t\t\tvar addAfter = viewTypeObj.after.call(this, {\r\n\t\t\t\t\t\tcontainer: this.$canvas,\r\n\t\t\t\t\t\tdata: data\r\n\t\t\t\t\t});\r\n\t\t\t\t\taddItem(this.$canvas, addAfter);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcallback(data);\r\n\t\t\t} else {\r\n\t\t\t\tviewTypeObj.render.call(this, {\r\n\t\t\t\t\tcontainer: this.$canvas,\r\n\t\t\t\t\tdata: data\r\n\t\t\t\t}, callback);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tsetViewOptions: function setViewOptions (curView) {\r\n\t\t\tvar opts = {};\r\n\t\t\tvar viewName = curView.split('.')[1];\r\n\r\n\t\t\tif (this.options.views) {\r\n\t\t\t\topts = this.options.views[viewName] || this.options.views[curView] || {};\r\n\t\t\t} else {\r\n\t\t\t\topts = {};\r\n\t\t\t}\r\n\r\n\t\t\tthis.viewOptions = langx.mixin({}, this.options, opts);\r\n\t\t},\r\n\r\n\t\tviewChanged: function viewChanged (e) {\r\n\t\t\tvar $selected = $(e.target);\r\n\t\t\tvar val = $selected.val();\r\n\r\n\t\t\tif (!this.syncingViewButtonState) {\r\n\t\t\t\tif (this.isDisabled || $selected.parents('label:first').hasClass('disabled')) {\r\n\t\t\t\t\tthis.syncViewButtonState();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.render({\r\n\t\t\t\t\t\tchangeView: val,\r\n\t\t\t\t\t\tpageIncrement: null\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tsyncViewButtonState: function syncViewButtonState () {\r\n\t\t\tvar $itemToCheck = this.$views.find('input[value=\"' + this.currentView + '\"]');\r\n\r\n\t\t\tthis.syncingViewButtonState = true;\r\n\t\t\tthis.$views.find('input').prop('checked', false);\r\n\t\t\tthis.$views.find('label.active').removeClass('active');\r\n\r\n\t\t\tif ($itemToCheck.length > 0) {\r\n\t\t\t\t$itemToCheck.prop('checked', true);\r\n\t\t\t\t$itemToCheck.parents('label:first').addClass('active');\r\n\t\t\t}\r\n\t\t\tthis.syncingViewButtonState = false;\r\n\t\t}\r\n\t\t\r\n\t});\r\n\r\n\tvar logWarn = function logWarn (msg) {\r\n\t\tif (window.console && window.console.warn) {\r\n\t\t\twindow.console.warn(msg);\r\n\t\t}\r\n\t};\r\n\r\n\tvar scan = function scan (cont) {\r\n\t\tvar keep = [];\r\n\t\tcont.children().each(function eachContainerChild () {\r\n\t\t\tvar item = $(this);\r\n\t\t\tvar pres = item.attr('data-preserve');\r\n\t\t\tif (pres === 'deep') {\r\n\t\t\t\titem.detach();\r\n\t\t\t\tkeep.push(item);\r\n\t\t\t} else if (pres === 'shallow') {\r\n\t\t\t\tscan(item);\r\n\t\t\t\titem.detach();\r\n\t\t\t\tkeep.push(item);\r\n\t\t\t}\r\n\t\t});\r\n\t\tcont.empty();\r\n\t\tcont.append(keep);\r\n\t};\r\n\r\n\tvar addItem = function addItem ($parent, response) {\r\n\t\tvar action;\r\n\t\tif (response) {\r\n\t\t\taction = (response.action) ? response.action : 'append';\r\n\t\t\tif (action !== 'none' && response.item !== undefined) {\r\n\t\t\t\tvar $container = (response.container !== undefined) ? $(response.container) : $parent;\r\n\t\t\t\t$container[action](response.item);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tvar callNextInit = function callNextInit (currentViewType, viewTypes, callback) {\r\n\t\tvar nextViewType = currentViewType + 1;\r\n\t\tif (nextViewType < viewTypes.length) {\r\n\t\t\tinitViewType.call(this, nextViewType, viewTypes, callback);\r\n\t\t} else {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t};\r\n\r\n\tvar initViewType = function initViewType (currentViewtype, viewTypes, callback) {\r\n\t\tif (viewTypes[currentViewtype].initialize) {\r\n\t\t\tviewTypes[currentViewtype].initialize.call(this, {}, function afterInitialize () {\r\n\t\t\t\tcallNextInit.call(this, currentViewtype, viewTypes, callback);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tcallNextInit.call(this, currentViewtype, viewTypes, callback);\r\n\t\t}\r\n\t};\r\n\r\n\t// Does all of our cleanup post-render\r\n\tvar afterRender = function afterRender (state) {\r\n\t\tvar data = state.data || {};\r\n\r\n\t\tif (this.infiniteScrollingEnabled) {\r\n\t\t\tif (state.viewChanged || state.options.clearInfinite) {\r\n\t\t\t\tthis.initInfiniteScrolling();\r\n\t\t\t}\r\n\r\n\t\t\tthis.infiniteScrollPaging(data, state.options);\r\n\t\t}\r\n\r\n\t\tthis.$loader.hide().loader('pause');\r\n\t\tthis.enable();\r\n\r\n\t\tthis.$search.trigger('rendered.fu.repeater', {\r\n\t\t\tdata: data,\r\n\t\t\toptions: state.dataOptions,\r\n\t\t\trenderOptions: state.options\r\n\t\t});\r\n\t\tthis.$element.trigger('rendered.fu.repeater', {\r\n\t\t\tdata: data,\r\n\t\t\toptions: state.dataOptions,\r\n\t\t\trenderOptions: state.options\r\n\t\t});\r\n\r\n\t\t// for maintaining support of 'loaded' event\r\n\t\tthis.$element.trigger('loaded.fu.repeater', state.dataOptions);\r\n\t};\r\n\r\n\t// This does the actual rendering of the repeater\r\n\tvar doRender = function doRender (state) {\r\n\t\tvar data = state.data || {};\r\n\r\n\t\tif (this.infiniteScrollingEnabled) {\r\n\t\t\t// pass empty object because data handled in infiniteScrollPaging method\r\n\t\t\tthis.infiniteScrollingCallback({});\r\n\t\t} else {\r\n\t\t\tthis.itemization(data);\r\n\t\t\tthis.pagination(data);\r\n\t\t}\r\n\r\n\t\tvar self = this;\r\n\t\tthis.renderItems(\r\n\t\t\tstate.viewTypeObj,\r\n\t\t\tdata,\r\n\t\t\tfunction callAfterRender (d) {\r\n\t\t\t\tstate.data = d;\r\n\t\t\t\tafterRender.call(self, state);\r\n\t\t\t}\r\n\t\t);\r\n\t};\r\n\r\n\r\n\r\n\t// For backwards compatibility.\r\n\tRepeater.prototype.runRenderer = Repeater.prototype.renderItems;\r\n\r\n\t// REPEATER PLUGIN DEFINITION\r\n\r\n\t$.fn.repeater = function fnrepeater (option) {\r\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\t\tvar methodReturn;\r\n\r\n\t\tvar $set = this.each(function eachThis () {\r\n\t\t\tvar $this = $(this);\r\n\t\t\tvar data = $this.data('fu.repeater');\r\n\t\t\tvar options = typeof option === 'object' && option;\r\n\r\n\t\t\tif (!data) {\r\n\t\t\t\t$this.data('fu.repeater', (data = new Repeater(this, options)));\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof option === 'string') {\r\n\t\t\t\tmethodReturn = data[option].apply(data, args);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\r\n\t};\r\n\r\n\t$.fn.repeater.defaults = {\r\n\t\tdataSource: function dataSource (options, callback) {\r\n\t\t\tcallback({ count: 0, end: 0, items: [], page: 0, pages: 1, start: 0 });\r\n\t\t},\r\n\t\tdefaultView: -1, // should be a string value. -1 means it will grab the active view from the view controls\r\n\t\tdropPagingCap: 10,\r\n\t\tstaticHeight: -1, // normally true or false. -1 means it will look for data-staticheight on the element\r\n\t\tviews: null, // can be set to an object to configure multiple views of the same type,\r\n\t\tsearchOnKeyPress: false,\r\n\t\tallowCancel: true\r\n\t};\r\n\r\n\t$.fn.repeater.viewTypes = {};\r\n\r\n\t$.fn.repeater.Constructor = Repeater;\r\n\r\n\t$.fn.repeater.noConflict = function noConflict () {\r\n\t\t$.fn.repeater = old;\r\n\t\treturn this;\r\n\t};\r\n\r\n\r\n\treturn $.fn.repeater;\r\n\r\n});\r\n\ndefine('skylark-fuelux/repeater-list',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx/browser\",\r\n  \"skylark-domx/eventer\",\r\n  \"skylark-domx/noder\",\r\n  \"skylark-domx/geom\",\r\n  \"skylark-domx/query\",\r\n  \"./repeater\"\r\n],function(langx,browser,eventer,noder,geom,$){\r\n\r\n\t/*\r\n\t * Fuel UX Checkbox\r\n\t * https://github.com/ExactTarget/fuelux\r\n\t *\r\n\t * Copyright (c) 2014 ExactTarget\r\n\t * Licensed under the BSD New license.\r\n\t */\r\n\r\n\tif ($.fn.repeater) {\r\n\t\t// ADDITIONAL METHODS\r\n\t\t$.fn.repeater.Constructor.prototype.list_clearSelectedItems = function listClearSelectedItems () {\r\n\t\t\tthis.$canvas.find('.repeater-list-check').remove();\r\n\t\t\tthis.$canvas.find('.repeater-list table tbody tr.selected').removeClass('selected');\r\n\t\t};\r\n\r\n\t\t$.fn.repeater.Constructor.prototype.list_highlightColumn = function listHighlightColumn (index, force) {\r\n\t\t\tvar tbody = this.$canvas.find('.repeater-list-wrapper > table tbody');\r\n\t\t\tif (this.viewOptions.list_highlightSortedColumn || force) {\r\n\t\t\t\ttbody.find('td.sorted').removeClass('sorted');\r\n\t\t\t\ttbody.find('tr').each(function eachTR () {\r\n\t\t\t\t\tvar col = $(this).find('td:nth-child(' + (index + 1) + ')').filter(function filterChildren () { return !$(this).parent().hasClass('empty'); });\r\n\t\t\t\t\tcol.addClass('sorted');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t$.fn.repeater.Constructor.prototype.list_getSelectedItems = function listGetSelectedItems () {\r\n\t\t\tvar selected = [];\r\n\t\t\tthis.$canvas.find('.repeater-list .repeater-list-wrapper > table tbody tr.selected').each(function eachSelectedTR () {\r\n\t\t\t\tvar $item = $(this);\r\n\t\t\t\tselected.push({\r\n\t\t\t\t\tdata: $item.data('item_data'),\r\n\t\t\t\t\telement: $item\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\treturn selected;\r\n\t\t};\r\n\r\n\t\t$.fn.repeater.Constructor.prototype.getValue = $.fn.repeater.Constructor.prototype.list_getSelectedItems;\r\n\r\n\t\t$.fn.repeater.Constructor.prototype.list_positionHeadings = function listPositionHeadings () {\r\n\t\t\tvar $wrapper = this.$element.find('.repeater-list-wrapper');\r\n\t\t\tvar offsetLeft = $wrapper.offset().left;\r\n\t\t\tvar scrollLeft = $wrapper.scrollLeft();\r\n\t\t\tif (scrollLeft > 0) {\r\n\t\t\t\t$wrapper.find('.repeater-list-heading').each(function eachListHeading () {\r\n\t\t\t\t\tvar $heading = $(this);\r\n\t\t\t\t\tvar left = ($heading.parents('th:first').offset().left - offsetLeft) + 'px';\r\n\t\t\t\t\t$heading.addClass('shifted').css('left', left);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t$wrapper.find('.repeater-list-heading').each(function eachListHeading () {\r\n\t\t\t\t\t$(this).removeClass('shifted').css('left', '');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t$.fn.repeater.Constructor.prototype.list_setSelectedItems = function listSetSelectedItems (itms, force) {\r\n\t\t\tvar selectable = this.viewOptions.list_selectable;\r\n\t\t\tvar self = this;\r\n\t\t\tvar data;\r\n\t\t\tvar i;\r\n\t\t\tvar $item;\r\n\t\t\tvar length;\r\n\r\n\t\t\tvar items = itms;\r\n\t\t\tif (!$.isArray(items)) {\r\n\t\t\t\titems = [items];\r\n\t\t\t}\r\n\r\n\t\t\t// this function is necessary because lint yells when a function is in a loop\r\n\t\t\tvar checkIfItemMatchesValue = function checkIfItemMatchesValue (rowIndex) {\r\n\t\t\t\t$item = $(this);\r\n\r\n\t\t\t\tdata = $item.data('item_data') || {};\r\n\t\t\t\tif (data[items[i].property] === items[i].value) {\r\n\t\t\t\t\tselectItem($item, items[i].selected, rowIndex);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tvar selectItem = function selectItem ($itm, slct, index) {\r\n\t\t\t\tvar $frozenCols;\r\n\r\n\t\t\t\tvar select = (slct !== undefined) ? slct : true;\r\n\t\t\t\tif (select) {\r\n\t\t\t\t\tif (!force && selectable !== 'multi') {\r\n\t\t\t\t\t\tself.list_clearSelectedItems();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!$itm.hasClass('selected')) {\r\n\t\t\t\t\t\t$itm.addClass('selected');\r\n\r\n\t\t\t\t\t\tif (self.viewOptions.list_frozenColumns || self.viewOptions.list_selectable === 'multi') {\r\n\t\t\t\t\t\t\t$frozenCols = self.$element.find('.frozen-column-wrapper tr:nth-child(' + (index + 1) + ')');\r\n\r\n\t\t\t\t\t\t\t$frozenCols.addClass('selected');\r\n\t\t\t\t\t\t\t$frozenCols.find('.repeater-select-checkbox').addClass('checked');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (self.viewOptions.list_actions) {\r\n\t\t\t\t\t\t\tself.$element.find('.actions-column-wrapper tr:nth-child(' + (index + 1) + ')').addClass('selected');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$itm.find('td:first').prepend('<div class=\"repeater-list-check\"><span class=\"glyphicon glyphicon-ok\"></span></div>');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (self.viewOptions.list_frozenColumns) {\r\n\t\t\t\t\t\t$frozenCols = self.$element.find('.frozen-column-wrapper tr:nth-child(' + (index + 1) + ')');\r\n\r\n\t\t\t\t\t\t$frozenCols.addClass('selected');\r\n\t\t\t\t\t\t$frozenCols.find('.repeater-select-checkbox').removeClass('checked');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (self.viewOptions.list_actions) {\r\n\t\t\t\t\t\tself.$element.find('.actions-column-wrapper tr:nth-child(' + (index + 1) + ')').removeClass('selected');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$itm.find('.repeater-list-check').remove();\r\n\t\t\t\t\t$itm.removeClass('selected');\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tif (force === true || selectable === 'multi') {\r\n\t\t\t\tlength = items.length;\r\n\t\t\t} else if (selectable) {\r\n\t\t\t\tlength = (items.length > 0) ? 1 : 0;\r\n\t\t\t} else {\r\n\t\t\t\tlength = 0;\r\n\t\t\t}\r\n\r\n\t\t\tfor (i = 0; i < length; i++) {\r\n\t\t\t\tif (items[i].index !== undefined) {\r\n\t\t\t\t\t$item = this.$canvas.find('.repeater-list .repeater-list-wrapper > table tbody tr:nth-child(' + (items[i].index + 1) + ')');\r\n\t\t\t\t\tif ($item.length > 0) {\r\n\t\t\t\t\t\tselectItem($item, items[i].selected, items[i].index);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (items[i].property !== undefined && items[i].value !== undefined) {\r\n\t\t\t\t\tthis.$canvas.find('.repeater-list .repeater-list-wrapper > table tbody tr').each(checkIfItemMatchesValue);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t$.fn.repeater.Constructor.prototype.list_sizeHeadings = function listSizeHeadings () {\r\n\t\t\tvar $table = this.$element.find('.repeater-list table');\r\n\t\t\t$table.find('thead th').each(function eachTH () {\r\n\t\t\t\tvar $th = $(this);\r\n\t\t\t\tvar $heading = $th.find('.repeater-list-heading');\r\n\t\t\t\t$heading.css({ height: $th.outerHeight() });\r\n\t\t\t\t$heading.outerWidth($heading.data('forced-width') || $th.outerWidth());\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t$.fn.repeater.Constructor.prototype.list_setFrozenColumns = function listSetFrozenColumns () {\r\n\t\t\tvar frozenTable = this.$canvas.find('.table-frozen');\r\n\t\t\tvar $wrapper = this.$element.find('.repeater-canvas');\r\n\t\t\tvar $table = this.$element.find('.repeater-list .repeater-list-wrapper > table');\r\n\t\t\tvar repeaterWrapper = this.$element.find('.repeater-list');\r\n\t\t\tvar numFrozenColumns = this.viewOptions.list_frozenColumns;\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tif (this.viewOptions.list_selectable === 'multi') {\r\n\t\t\t\tnumFrozenColumns = numFrozenColumns + 1;\r\n\t\t\t\t$wrapper.addClass('multi-select-enabled');\r\n\t\t\t}\r\n\r\n\t\t\tif (frozenTable.length < 1) {\r\n\t\t\t\t// setup frozen column markup\r\n\t\t\t\t// main wrapper and remove unneeded columns\r\n\t\t\t\tvar $frozenColumnWrapper = $('<div class=\"frozen-column-wrapper\"></div>').insertBefore($table);\r\n\t\t\t\tvar $frozenColumn = $table.clone().addClass('table-frozen');\r\n\t\t\t\t$frozenColumn.find('th:not(:lt(' + numFrozenColumns + '))').remove();\r\n\t\t\t\t$frozenColumn.find('td:not(:nth-child(n+0):nth-child(-n+' + numFrozenColumns + '))').remove();\r\n\r\n\t\t\t\t// need to set absolute heading for vertical scrolling\r\n\t\t\t\tvar $frozenThead = $frozenColumn.clone().removeClass('table-frozen');\r\n\t\t\t\t$frozenThead.find('tbody').remove();\r\n\t\t\t\tvar $frozenTheadWrapper = $('<div class=\"frozen-thead-wrapper\"></div>').append($frozenThead);\r\n\r\n\t\t\t\t// this gets a little messy with all the cloning. We need to make sure the ID and FOR\r\n\t\t\t\t// attribs are unique for the 'top most' cloned checkbox\r\n\t\t\t\tvar $checkboxLabel = $frozenTheadWrapper.find('th label.checkbox-custom.checkbox-inline');\r\n\t\t\t\t$checkboxLabel.attr('id', $checkboxLabel.attr('id') + '_cloned');\r\n\r\n\t\t\t\t$frozenColumnWrapper.append($frozenColumn);\r\n\t\t\t\trepeaterWrapper.append($frozenTheadWrapper);\r\n\t\t\t\tthis.$canvas.addClass('frozen-enabled');\r\n\t\t\t}\r\n\r\n\t\t\tthis.list_sizeFrozenColumns();\r\n\r\n\t\t\t$('.frozen-thead-wrapper .repeater-list-heading').on('click', function onClickHeading () {\r\n\t\t\t\tvar index = $(this).parent('th').index();\r\n\t\t\t\tindex = index + 1;\r\n\t\t\t\tself.$element.find('.repeater-list-wrapper > table thead th:nth-child(' + index + ') .repeater-list-heading')[0].click();\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t$.fn.repeater.Constructor.prototype.list_positionColumns = function listPositionColumns () {\r\n\t\t\tvar $wrapper = this.$element.find('.repeater-canvas');\r\n\t\t\tvar scrollTop = $wrapper.scrollTop();\r\n\t\t\tvar scrollLeft = $wrapper.scrollLeft();\r\n\t\t\tvar frozenEnabled = this.viewOptions.list_frozenColumns || this.viewOptions.list_selectable === 'multi';\r\n\t\t\tvar actionsEnabled = this.viewOptions.list_actions;\r\n\r\n\t\t\tvar canvasWidth = this.$element.find('.repeater-canvas').outerWidth();\r\n\t\t\tvar tableWidth = this.$element.find('.repeater-list .repeater-list-wrapper > table').outerWidth();\r\n\r\n\t\t\tvar actionsWidth = this.$element.find('.table-actions') ? this.$element.find('.table-actions').outerWidth() : 0;\r\n\r\n\t\t\tvar shouldScroll = (tableWidth - (canvasWidth - actionsWidth)) >= scrollLeft;\r\n\r\n\r\n\t\t\tif (scrollTop > 0) {\r\n\t\t\t\t$wrapper.find('.repeater-list-heading').css('top', scrollTop);\r\n\t\t\t} else {\r\n\t\t\t\t$wrapper.find('.repeater-list-heading').css('top', '0');\r\n\t\t\t}\r\n\r\n\t\t\tif (scrollLeft > 0) {\r\n\t\t\t\tif (frozenEnabled) {\r\n\t\t\t\t\t$wrapper.find('.frozen-thead-wrapper').css('left', scrollLeft);\r\n\t\t\t\t\t$wrapper.find('.frozen-column-wrapper').css('left', scrollLeft);\r\n\t\t\t\t}\r\n\t\t\t\tif (actionsEnabled && shouldScroll) {\r\n\t\t\t\t\t$wrapper.find('.actions-thead-wrapper').css('right', -scrollLeft);\r\n\t\t\t\t\t$wrapper.find('.actions-column-wrapper').css('right', -scrollLeft);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (frozenEnabled) {\r\n\t\t\t\t\t$wrapper.find('.frozen-thead-wrapper').css('left', '0');\r\n\t\t\t\t\t$wrapper.find('.frozen-column-wrapper').css('left', '0');\r\n\t\t\t\t}\r\n\t\t\t\tif (actionsEnabled) {\r\n\t\t\t\t\t$wrapper.find('.actions-thead-wrapper').css('right', '0');\r\n\t\t\t\t\t$wrapper.find('.actions-column-wrapper').css('right', '0');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t$.fn.repeater.Constructor.prototype.list_createItemActions = function listCreateItemActions () {\r\n\t\t\tvar actionsHtml = '';\r\n\t\t\tvar self = this;\r\n\t\t\tvar i;\r\n\t\t\tvar length;\r\n\t\t\tvar $table = this.$element.find('.repeater-list .repeater-list-wrapper > table');\r\n\t\t\tvar $actionsTable = this.$canvas.find('.table-actions');\r\n\r\n\t\t\tfor (i = 0, length = this.viewOptions.list_actions.items.length; i < length; i++) {\r\n\t\t\t\tvar action = this.viewOptions.list_actions.items[i];\r\n\t\t\t\tvar html = action.html;\r\n\r\n\t\t\t\tactionsHtml += '<li><a href=\"#\" data-action=\"' + action.name + '\" class=\"action-item\"> ' + html + '</a></li>';\r\n\t\t\t}\r\n\r\n\t\t\tvar actionsDropdown = '<div class=\"btn-group\">' +\r\n\t\t\t\t'<button type=\"button\" class=\"btn btn-xs btn-default dropdown-toggle repeater-actions-button\" data-toggle=\"dropdown\" data-flip=\"auto\" aria-expanded=\"false\">' +\r\n\t\t\t\t'<span class=\"caret\"></span>' +\r\n\t\t\t\t'</button>' +\r\n\t\t\t\t'<ul class=\"dropdown-menu dropdown-menu-right\" role=\"menu\">' +\r\n\t\t\t\tactionsHtml +\r\n\t\t\t\t'</ul></div>';\r\n\r\n\t\t\tif ($actionsTable.length < 1) {\r\n\t\t\t\tvar $actionsColumnWrapper = $('<div class=\"actions-column-wrapper\" style=\"width: ' + this.list_actions_width + 'px\"></div>').insertBefore($table);\r\n\t\t\t\tvar $actionsColumn = $table.clone().addClass('table-actions');\r\n\t\t\t\t$actionsColumn.find('th:not(:last-child)').remove();\r\n\t\t\t\t$actionsColumn.find('tr td:not(:last-child)').remove();\r\n\r\n\t\t\t\t// Dont show actions dropdown in header if not multi select\r\n\t\t\t\tif (this.viewOptions.list_selectable === 'multi' || this.viewOptions.list_selectable === 'action') {\r\n\t\t\t\t\t$actionsColumn.find('thead tr').html('<th><div class=\"repeater-list-heading\">' + actionsDropdown + '</div></th>');\r\n\r\n\t\t\t\t\tif (this.viewOptions.list_selectable !== 'action') {\r\n\t\t\t\t\t\t// disable the header dropdown until an item is selected\r\n\t\t\t\t\t\t$actionsColumn.find('thead .btn').attr('disabled', 'disabled');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar label = this.viewOptions.list_actions.label || '<span class=\"actions-hidden\">a</span>';\r\n\t\t\t\t\t$actionsColumn.find('thead tr').addClass('empty-heading').html('<th>' + label + '<div class=\"repeater-list-heading\">' + label + '</div></th>');\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Create Actions dropdown for each cell in actions table\r\n\t\t\t\tvar $actionsCells = $actionsColumn.find('td');\r\n\r\n\t\t\t\t$actionsCells.each(function addActionsDropdown (rowNumber) {\r\n\t\t\t\t\t$(this).html(actionsDropdown);\r\n\t\t\t\t\t$(this).find('a').attr('data-row', rowNumber + 1);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$actionsColumnWrapper.append($actionsColumn);\r\n\r\n\t\t\t\tthis.$canvas.addClass('actions-enabled');\r\n\t\t\t}\r\n\r\n\t\t\tthis.list_sizeActionsTable();\r\n\r\n\t\t\t// row level actions click\r\n\t\t\tthis.$element.find('.table-actions tbody .action-item').on('click', function onBodyActionItemClick (e) {\r\n\t\t\t\tif (!self.isDisabled) {\r\n\t\t\t\t\tvar actionName = $(this).data('action');\r\n\t\t\t\t\tvar row = $(this).data('row');\r\n\t\t\t\t\tvar selected = {\r\n\t\t\t\t\t\tactionName: actionName,\r\n\t\t\t\t\t\trows: [row]\r\n\t\t\t\t\t};\r\n\t\t\t\t\tself.list_getActionItems(selected, e);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// bulk actions click\r\n\t\t\tthis.$element.find('.table-actions thead .action-item').on('click', function onHeadActionItemClick (e) {\r\n\t\t\t\tif (!self.isDisabled) {\r\n\t\t\t\t\tvar actionName = $(this).data('action');\r\n\t\t\t\t\tvar selected = {\r\n\t\t\t\t\t\tactionName: actionName,\r\n\t\t\t\t\t\trows: []\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar selector = '.repeater-list-wrapper > table .selected';\r\n\r\n\t\t\t\t\tif ( self.viewOptions.list_selectable === 'action' ) {\r\n\t\t\t\t\t\tselector = '.repeater-list-wrapper > table tr';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tself.$element.find(selector).each(function eachSelector (selectorIndex) {\r\n\t\t\t\t\t\tselected.rows.push(selectorIndex + 1);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tself.list_getActionItems(selected, e);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t$.fn.repeater.Constructor.prototype.list_getActionItems = function listGetActionItems (selected, e) {\r\n\t\t\tvar selectedObj = [];\r\n\t\t\tvar actionObj = $.grep(this.viewOptions.list_actions.items, function matchedActions (actions) {\r\n\t\t\t\treturn actions.name === selected.actionName;\r\n\t\t\t})[0];\r\n\t\t\tfor (var i = 0, selectedRowsL = selected.rows.length; i < selectedRowsL; i++) {\r\n\t\t\t\tvar clickedRow = this.$canvas.find('.repeater-list-wrapper > table tbody tr:nth-child(' + selected.rows[i] + ')');\r\n\t\t\t\tselectedObj.push({\r\n\t\t\t\t\titem: clickedRow,\r\n\t\t\t\t\trowData: clickedRow.data('item_data')\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (selectedObj.length === 1) {\r\n\t\t\t\tselectedObj = selectedObj[0];\r\n\t\t\t}\r\n\r\n\t\t\tif (actionObj.clickAction) {\r\n\t\t\t\tvar callback = function noop () {};// for backwards compatibility. No idea why this was originally here...\r\n\t\t\t\tactionObj.clickAction(selectedObj, callback, e);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t$.fn.repeater.Constructor.prototype.list_sizeActionsTable = function listSizeActionsTable () {\r\n\t\t\tvar $actionsTable = this.$element.find('.repeater-list table.table-actions');\r\n\t\t\tvar $actionsTableHeader = $actionsTable.find('thead tr th');\r\n\t\t\tvar $table = this.$element.find('.repeater-list-wrapper > table');\r\n\r\n\t\t\t$actionsTableHeader.outerHeight($table.find('thead tr th').outerHeight());\r\n\t\t\t$actionsTableHeader.find('.repeater-list-heading').outerHeight($actionsTableHeader.outerHeight());\r\n\t\t\t$actionsTable.find('tbody tr td:first-child').each(function eachFirstChild (i) {\r\n\t\t\t\t$(this).outerHeight($table.find('tbody tr:eq(' + i + ') td').outerHeight());\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t$.fn.repeater.Constructor.prototype.list_sizeFrozenColumns = function listSizeFrozenColumns () {\r\n\t\t\tvar $table = this.$element.find('.repeater-list .repeater-list-wrapper > table');\r\n\r\n\t\t\tthis.$element.find('.repeater-list table.table-frozen tr').each(function eachTR (i) {\r\n\t\t\t\t$(this).height($table.find('tr:eq(' + i + ')').height());\r\n\t\t\t});\r\n\r\n\t\t\tvar columnWidth = $table.find('td:eq(0)').outerWidth();\r\n\t\t\tthis.$element.find('.frozen-column-wrapper, .frozen-thead-wrapper').width(columnWidth);\r\n\t\t};\r\n\r\n\t\t$.fn.repeater.Constructor.prototype.list_frozenOptionsInitialize = function listFrozenOptionsInitialize () {\r\n\t\t\tvar $checkboxes = this.$element.find('.frozen-column-wrapper .checkbox-inline');\r\n\t\t\tvar $headerCheckbox = this.$element.find('.header-checkbox .checkbox-custom');\r\n\t\t\tvar $everyTable = this.$element.find('.repeater-list table');\r\n\t\t\tvar self = this;\r\n\r\n\t\t\t// Make sure if row is hovered that it is shown in frozen column as well\r\n\t\t\tthis.$element.find('tr.selectable').on('mouseover mouseleave', function onMouseEvents (e) {\r\n\t\t\t\tvar index = $(this).index();\r\n\t\t\t\tindex = index + 1;\r\n\t\t\t\tif (e.type === 'mouseover') {\r\n\t\t\t\t\t$everyTable.find('tbody tr:nth-child(' + index + ')').addClass('hovered');\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$everyTable.find('tbody tr:nth-child(' + index + ')').removeClass('hovered');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$headerCheckbox.checkbox();\r\n\t\t\t$checkboxes.checkbox();\r\n\r\n\t\t\t// Row checkboxes\r\n\t\t\tvar $rowCheckboxes = this.$element.find('.table-frozen tbody .checkbox-inline');\r\n\t\t\tvar $checkAll = this.$element.find('.frozen-thead-wrapper thead .checkbox-inline input');\r\n\t\t\t$rowCheckboxes.on('change', function onChangeRowCheckboxes (e) {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\tif (!self.list_revertingCheckbox) {\r\n\t\t\t\t\tif (self.isDisabled) {\r\n\t\t\t\t\t\trevertCheckbox($(e.currentTarget));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar row = $(this).attr('data-row');\r\n\t\t\t\t\t\trow = parseInt(row, 10) + 1;\r\n\t\t\t\t\t\tself.$element.find('.repeater-list-wrapper > table tbody tr:nth-child(' + row + ')').click();\r\n\r\n\t\t\t\t\t\tvar numSelected = self.$element.find('.table-frozen tbody .checkbox-inline.checked').length;\r\n\t\t\t\t\t\tif (numSelected === 0) {\r\n\t\t\t\t\t\t\t$checkAll.prop('checked', false);\r\n\t\t\t\t\t\t\t$checkAll.prop('indeterminate', false);\r\n\t\t\t\t\t\t} else if (numSelected === $rowCheckboxes.length) {\r\n\t\t\t\t\t\t\t$checkAll.prop('checked', true);\r\n\t\t\t\t\t\t\t$checkAll.prop('indeterminate', false);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$checkAll.prop('checked', false);\r\n\t\t\t\t\t\t\t$checkAll.prop('indeterminate', true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// \"Check All\" checkbox\r\n\t\t\t$checkAll.on('change', function onChangeCheckAll (e) {\r\n\t\t\t\tif (!self.list_revertingCheckbox) {\r\n\t\t\t\t\tif (self.isDisabled) {\r\n\t\t\t\t\t\trevertCheckbox($(e.currentTarget));\r\n\t\t\t\t\t} else if ($(this).is(':checked')) {\r\n\t\t\t\t\t\tself.$element.find('.repeater-list-wrapper > table tbody tr:not(.selected)').click();\r\n\t\t\t\t\t\tself.$element.trigger('selected.fu.repeaterList', $checkboxes);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tself.$element.find('.repeater-list-wrapper > table tbody tr.selected').click();\r\n\t\t\t\t\t\tself.$element.trigger('deselected.fu.repeaterList', $checkboxes);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tfunction revertCheckbox ($checkbox) {\r\n\t\t\t\tself.list_revertingCheckbox = true;\r\n\t\t\t\t$checkbox.checkbox('toggle');\r\n\t\t\t\tdelete self.list_revertingCheckbox;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// ADDITIONAL DEFAULT OPTIONS\r\n\t\t$.fn.repeater.defaults = langx.mixin({}, $.fn.repeater.defaults, {\r\n\t\t\tlist_columnRendered: null,\r\n\t\t\tlist_columnSizing: true,\r\n\t\t\tlist_columnSyncing: true,\r\n\t\t\tlist_highlightSortedColumn: true,\r\n\t\t\tlist_infiniteScroll: false,\r\n\t\t\tlist_noItemsHTML: 'no items found',\r\n\t\t\tlist_selectable: false,\r\n\t\t\tlist_sortClearing: false,\r\n\t\t\tlist_rowRendered: null,\r\n\t\t\tlist_frozenColumns: 0,\r\n\t\t\tlist_actions: false\r\n\t\t});\r\n\r\n\t\t// EXTENSION DEFINITION\r\n\t\t$.fn.repeater.viewTypes.list = {\r\n\t\t\tcleared: function cleared () {\r\n\t\t\t\tif (this.viewOptions.list_columnSyncing) {\r\n\t\t\t\t\tthis.list_sizeHeadings();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdataOptions: function dataOptions (options) {\r\n\t\t\t\tif (this.list_sortDirection) {\r\n\t\t\t\t\toptions.sortDirection = this.list_sortDirection;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.list_sortProperty) {\r\n\t\t\t\t\toptions.sortProperty = this.list_sortProperty;\r\n\t\t\t\t}\r\n\t\t\t\treturn options;\r\n\t\t\t},\r\n\t\t\tenabled: function enabled (helpers) {\r\n\t\t\t\tif (this.viewOptions.list_actions) {\r\n\t\t\t\t\tif (!helpers.status) {\r\n\t\t\t\t\t\tthis.$canvas.find('.repeater-actions-button').attr('disabled', 'disabled');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$canvas.find('.repeater-actions-button').removeAttr('disabled');\r\n\t\t\t\t\t\ttoggleActionsHeaderButton.call(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tinitialize: function initialize (helpers, callback) {\r\n\t\t\t\tthis.list_sortDirection = null;\r\n\t\t\t\tthis.list_sortProperty = null;\r\n\t\t\t\tthis.list_specialBrowserClass = specialBrowserClass();\r\n\t\t\t\tthis.list_actions_width = (this.viewOptions.list_actions.width !== undefined) ? this.viewOptions.list_actions.width : 37;\r\n\t\t\t\tthis.list_noItems = false;\r\n\t\t\t\tcallback();\r\n\t\t\t},\r\n\t\t\tresize: function resize () {\r\n\t\t\t\tsizeColumns.call(this, this.$element.find('.repeater-list-wrapper > table thead tr'));\r\n\t\t\t\tif (this.viewOptions.list_actions) {\r\n\t\t\t\t\tthis.list_sizeActionsTable();\r\n\t\t\t\t}\r\n\t\t\t\tif (this.viewOptions.list_frozenColumns || this.viewOptions.list_selectable === 'multi') {\r\n\t\t\t\t\tthis.list_sizeFrozenColumns();\r\n\t\t\t\t}\r\n\t\t\t\tif (this.viewOptions.list_columnSyncing) {\r\n\t\t\t\t\tthis.list_sizeHeadings();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tselected: function selected () {\r\n\t\t\t\tvar infScroll = this.viewOptions.list_infiniteScroll;\r\n\t\t\t\tvar opts;\r\n\r\n\t\t\t\tthis.list_firstRender = true;\r\n\t\t\t\tthis.$loader.addClass('noHeader');\r\n\r\n\t\t\t\tif (infScroll) {\r\n\t\t\t\t\topts = (typeof infScroll === 'object') ? infScroll : {};\r\n\t\t\t\t\tthis.infiniteScrolling(true, opts);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbefore: function before (helpers) {\r\n\t\t\t\tvar $listContainer = helpers.container.find('.repeater-list');\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar $table;\r\n\r\n\t\t\t\t// this is a patch, it was pulled out of `renderThead`\r\n\t\t\t\tif (helpers.data.count > 0) {\r\n\t\t\t\t\tthis.list_noItems = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.list_noItems = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($listContainer.length < 1) {\r\n\t\t\t\t\t$listContainer = $('<div class=\"repeater-list ' + this.list_specialBrowserClass + '\" data-preserve=\"shallow\"><div class=\"repeater-list-wrapper\" data-infinite=\"true\" data-preserve=\"shallow\"><table aria-readonly=\"true\" class=\"table\" data-preserve=\"shallow\" role=\"grid\"></table></div></div>');\r\n\t\t\t\t\t$listContainer.find('.repeater-list-wrapper').on('scroll.fu.repeaterList', function onScrollRepeaterList () {\r\n\t\t\t\t\t\tif (self.viewOptions.list_columnSyncing) {\r\n\t\t\t\t\t\t\tself.list_positionHeadings();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (self.viewOptions.list_frozenColumns || self.viewOptions.list_actions || self.viewOptions.list_selectable === 'multi') {\r\n\t\t\t\t\t\thelpers.container.on('scroll.fu.repeaterList', function onScrollRepeaterList () {\r\n\t\t\t\t\t\t\tself.list_positionColumns();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\thelpers.container.append($listContainer);\r\n\t\t\t\t}\r\n\t\t\t\thelpers.container.removeClass('actions-enabled actions-enabled multi-select-enabled');\r\n\r\n\t\t\t\t$table = $listContainer.find('table');\r\n\t\t\t\trenderThead.call(this, $table, helpers.data);\r\n\t\t\t\trenderTbody.call(this, $table, helpers.data);\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\trenderItem: function renderItem (helpers) {\r\n\t\t\t\trenderRow.call(this, helpers.container, helpers.subset, helpers.index);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tafter: function after () {\r\n\t\t\t\tvar $sorted;\r\n\r\n\t\t\t\tif ((this.viewOptions.list_frozenColumns || this.viewOptions.list_selectable === 'multi') && !this.list_noItems) {\r\n\t\t\t\t\tthis.list_setFrozenColumns();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.viewOptions.list_actions && !this.list_noItems) {\r\n\t\t\t\t\tthis.list_createItemActions();\r\n\t\t\t\t\tthis.list_sizeActionsTable();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ((this.viewOptions.list_frozenColumns || this.viewOptions.list_actions || this.viewOptions.list_selectable === 'multi') && !this.list_noItems) {\r\n\t\t\t\t\tthis.list_positionColumns();\r\n\t\t\t\t\tthis.list_frozenOptionsInitialize();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.viewOptions.list_columnSyncing) {\r\n\t\t\t\t\tthis.list_sizeHeadings();\r\n\t\t\t\t\tthis.list_positionHeadings();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$sorted = this.$canvas.find('.repeater-list-wrapper > table .repeater-list-heading.sorted');\r\n\t\t\t\tif ($sorted.length > 0) {\r\n\t\t\t\t\tthis.list_highlightColumn($sorted.data('fu_item_index'));\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\t// ADDITIONAL METHODS\r\n\tvar areDifferentColumns = function areDifferentColumns (oldCols, newCols) {\r\n\t\tif (!newCols) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (!oldCols || (newCols.length !== oldCols.length)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tfor (var i = 0, newColsL = newCols.length; i < newColsL; i++) {\r\n\t\t\tif (!oldCols[i]) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tfor (var j in newCols[i]) {\r\n\t\t\t\tif (newCols[i].hasOwnProperty(j) && oldCols[i][j] !== newCols[i][j]) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\r\n\tvar renderColumn = function renderColumn ($row, rows, rowIndex, columns, columnIndex) {\r\n\t\tvar className = columns[columnIndex].className;\r\n\t\tvar content = rows[rowIndex][columns[columnIndex].property];\r\n\t\tvar $col = $('<td></td>');\r\n\t\tvar width = columns[columnIndex]._auto_width;\r\n\r\n\t\tvar property = columns[columnIndex].property;\r\n\t\tif (this.viewOptions.list_actions !== false && property === '@_ACTIONS_@') {\r\n\t\t\tcontent = '<div class=\"repeater-list-actions-placeholder\" style=\"width: ' + this.list_actions_width  + 'px\"></div>';\r\n\t\t}\r\n\r\n\t\tcontent = (content !== undefined) ? content : '';\r\n\r\n\t\t$col.addClass(((className !== undefined) ? className : '')).append(content);\r\n\t\tif (width !== undefined) {\r\n\t\t\t$col.outerWidth(width);\r\n\t\t}\r\n\r\n\t\t$row.append($col);\r\n\r\n\t\tif (this.viewOptions.list_selectable === 'multi' && columns[columnIndex].property === '@_CHECKBOX_@') {\r\n\t\t\tvar checkBoxMarkup = '<label data-row=\"' + rowIndex + '\" class=\"checkbox-custom checkbox-inline body-checkbox repeater-select-checkbox\">' +\r\n\t\t\t\t'<input class=\"sr-only\" type=\"checkbox\"></label>';\r\n\r\n\t\t\t$col.html(checkBoxMarkup);\r\n\t\t}\r\n\r\n\t\treturn $col;\r\n\t};\r\n\r\n\tvar renderHeader = function renderHeader ($tr, columns, index) {\r\n\t\tvar chevDown = 'glyphicon-chevron-down';\r\n\t\tvar chevron = '.glyphicon.rlc:first';\r\n\t\tvar chevUp = 'glyphicon-chevron-up';\r\n\t\tvar $div = $('<div class=\"repeater-list-heading\"><span class=\"glyphicon rlc\"></span></div>');\r\n\t\tvar checkAllID = (this.$element.attr('id') + '_' || '') + 'checkall';\r\n\r\n\t\tvar checkBoxMarkup = '<div class=\"repeater-list-heading header-checkbox\">' +\r\n\t\t\t\t'<label id=\"' + checkAllID + '\" class=\"checkbox-custom checkbox-inline\">' +\r\n\t\t\t\t\t'<input class=\"sr-only\" type=\"checkbox\" value=\"\">' +\r\n\t\t\t\t\t'<span class=\"checkbox-label\">&nbsp;</span>' +\r\n\t\t\t\t'</label>' +\r\n\t\t\t'</div>';\r\n\r\n\t\tvar $header = $('<th></th>');\r\n\t\tvar self = this;\r\n\t\tvar $both;\r\n\t\tvar className;\r\n\t\tvar sortable;\r\n\t\tvar $span;\r\n\t\tvar $spans;\r\n\r\n\t\t$div.data('fu_item_index', index);\r\n\t\t$div.prepend(columns[index].label);\r\n\t\t$header.html($div.html()).find('[id]').removeAttr('id');\r\n\r\n\t\tif (columns[index].property !== '@_CHECKBOX_@') {\r\n\t\t\t$header.append($div);\r\n\t\t} else {\r\n\t\t\t$header.append(checkBoxMarkup);\r\n\t\t}\r\n\r\n\t\t$both = $header.add($div);\r\n\t\t$span = $div.find(chevron);\r\n\t\t$spans = $span.add($header.find(chevron));\r\n\r\n\t\tif (this.viewOptions.list_actions && columns[index].property === '@_ACTIONS_@') {\r\n\t\t\tvar width = this.list_actions_width;\r\n\t\t\t$header.css('width', width);\r\n\t\t\t$div.css('width', width);\r\n\t\t}\r\n\r\n\t\tclassName = columns[index].className;\r\n\t\tif (className !== undefined) {\r\n\t\t\t$both.addClass(className);\r\n\t\t}\r\n\r\n\t\tsortable = columns[index].sortable;\r\n\t\tif (sortable) {\r\n\t\t\t$both.addClass('sortable');\r\n\t\t\t$div.on('click.fu.repeaterList', function onClickRepeaterList () {\r\n\t\t\t\tif (!self.isDisabled) {\r\n\t\t\t\t\tself.list_sortProperty = (typeof sortable === 'string') ? sortable : columns[index].property;\r\n\t\t\t\t\tif ($div.hasClass('sorted')) {\r\n\t\t\t\t\t\tif ($span.hasClass(chevUp)) {\r\n\t\t\t\t\t\t\t$spans.removeClass(chevUp).addClass(chevDown);\r\n\t\t\t\t\t\t\tself.list_sortDirection = 'desc';\r\n\t\t\t\t\t\t} else if (!self.viewOptions.list_sortClearing) {\r\n\t\t\t\t\t\t\t$spans.removeClass(chevDown).addClass(chevUp);\r\n\t\t\t\t\t\t\tself.list_sortDirection = 'asc';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$both.removeClass('sorted');\r\n\t\t\t\t\t\t\t$spans.removeClass(chevDown);\r\n\t\t\t\t\t\t\tself.list_sortDirection = null;\r\n\t\t\t\t\t\t\tself.list_sortProperty = null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$tr.find('th, .repeater-list-heading').removeClass('sorted');\r\n\t\t\t\t\t\t$spans.removeClass(chevDown).addClass(chevUp);\r\n\t\t\t\t\t\tself.list_sortDirection = 'asc';\r\n\t\t\t\t\t\t$both.addClass('sorted');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tself.render({\r\n\t\t\t\t\t\tclearInfinite: true,\r\n\t\t\t\t\t\tpageIncrement: null\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (columns[index].sortDirection === 'asc' || columns[index].sortDirection === 'desc') {\r\n\t\t\t$tr.find('th, .repeater-list-heading').removeClass('sorted');\r\n\t\t\t$both.addClass('sortable sorted');\r\n\t\t\tif (columns[index].sortDirection === 'asc') {\r\n\t\t\t\t$spans.addClass(chevUp);\r\n\t\t\t\tthis.list_sortDirection = 'asc';\r\n\t\t\t} else {\r\n\t\t\t\t$spans.addClass(chevDown);\r\n\t\t\t\tthis.list_sortDirection = 'desc';\r\n\t\t\t}\r\n\r\n\t\t\tthis.list_sortProperty = (typeof sortable === 'string') ? sortable : columns[index].property;\r\n\t\t}\r\n\r\n\t\t$tr.append($header);\r\n\t};\r\n\r\n\tvar onClickRowRepeaterList = function onClickRowRepeaterList (repeater) {\r\n\t\tvar isMulti = repeater.viewOptions.list_selectable === 'multi';\r\n\t\tvar isActions = repeater.viewOptions.list_actions;\r\n\t\tvar $repeater = repeater.$element;\r\n\r\n\t\tif (!repeater.isDisabled) {\r\n\t\t\tvar $item = $(this);\r\n\t\t\tvar index = $(this).index() + 1;\r\n\t\t\tvar $frozenRow = $repeater.find('.frozen-column-wrapper tr:nth-child(' + index + ')');\r\n\t\t\tvar $actionsRow = $repeater.find('.actions-column-wrapper tr:nth-child(' + index + ')');\r\n\t\t\tvar $checkBox = $repeater.find('.frozen-column-wrapper tr:nth-child(' + index + ') .checkbox-inline');\r\n\r\n\t\t\tif ($item.is('.selected')) {\r\n\t\t\t\t$item.removeClass('selected');\r\n\t\t\t\tif (isMulti) {\r\n\t\t\t\t\t$checkBox.click();\r\n\t\t\t\t\t$frozenRow.removeClass('selected');\r\n\t\t\t\t\tif (isActions) {\r\n\t\t\t\t\t\t$actionsRow.removeClass('selected');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$item.find('.repeater-list-check').remove();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$repeater.trigger('deselected.fu.repeaterList', $item);\r\n\t\t\t} else {\r\n\t\t\t\tif (!isMulti) {\r\n\t\t\t\t\trepeater.$canvas.find('.repeater-list-check').remove();\r\n\t\t\t\t\trepeater.$canvas.find('.repeater-list tbody tr.selected').each(function deslectRow () {\r\n\t\t\t\t\t\t$(this).removeClass('selected');\r\n\t\t\t\t\t\t$repeater.trigger('deselected.fu.repeaterList', $(this));\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$item.find('td:first').prepend('<div class=\"repeater-list-check\"><span class=\"glyphicon glyphicon-ok\"></span></div>');\r\n\t\t\t\t\t$item.addClass('selected');\r\n\t\t\t\t\t$frozenRow.addClass('selected');\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$checkBox.click();\r\n\t\t\t\t\t$item.addClass('selected');\r\n\t\t\t\t\t$frozenRow.addClass('selected');\r\n\t\t\t\t\tif (isActions) {\r\n\t\t\t\t\t\t$actionsRow.addClass('selected');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t$repeater.trigger('selected.fu.repeaterList', $item);\r\n\t\t\t}\r\n\r\n\t\t\ttoggleActionsHeaderButton.call(repeater);\r\n\t\t}\r\n\t};\r\n\r\n\tvar renderRow = function renderRow ($tbody, rows, index) {\r\n\t\tvar $row = $('<tr></tr>');\r\n\r\n\t\tif (this.viewOptions.list_selectable) {\r\n\t\t\t$row.data('item_data', rows[index]);\r\n\r\n\t\t\tif (this.viewOptions.list_selectable !== 'action') {\r\n\t\t\t\t$row.addClass('selectable');\r\n\t\t\t\t$row.attr('tabindex', 0);\t// allow items to be tabbed to / focused on\r\n\r\n\t\t\t\tvar repeater = this;\r\n\t\t\t\t$row.on('click.fu.repeaterList', function callOnClickRowRepeaterList() {\r\n\t\t\t\t\tonClickRowRepeaterList.call(this, repeater);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// allow selection via enter key\r\n\t\t\t\t$row.keyup(function onRowKeyup (e) {\r\n\t\t\t\t\tif (e.keyCode === 13) {\r\n\t\t\t\t\t\t// triggering a standard click event to be caught by the row click handler above\r\n\t\t\t\t\t\t$row.trigger('click.fu.repeaterList');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.viewOptions.list_actions && !this.viewOptions.list_selectable) {\r\n\t\t\t$row.data('item_data', rows[index]);\r\n\t\t}\r\n\r\n\t\tvar columns = [];\r\n\t\tfor (var i = 0, length = this.list_columns.length; i < length; i++) {\r\n\t\t\tcolumns.push(renderColumn.call(this, $row, rows, index, this.list_columns, i));\r\n\t\t}\r\n\r\n\t\t$tbody.append($row);\r\n\r\n\t\tif (this.viewOptions.list_columnRendered) {\r\n\t\t\tfor (var columnIndex = 0, colLength = columns.length; columnIndex < colLength; columnIndex++) {\r\n\t\t\t\tif (!(this.list_columns[columnIndex].property === '@_CHECKBOX_@' || this.list_columns[columnIndex].property === '@_ACTIONS_@')) {\r\n\t\t\t\t\tthis.viewOptions.list_columnRendered({\r\n\t\t\t\t\t\tcontainer: $row,\r\n\t\t\t\t\t\tcolumnAttr: this.list_columns[columnIndex].property,\r\n\t\t\t\t\t\titem: columns[columnIndex],\r\n\t\t\t\t\t\trowData: rows[index]\r\n\t\t\t\t\t}, function noop () {});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.viewOptions.list_rowRendered) {\r\n\t\t\tthis.viewOptions.list_rowRendered({\r\n\t\t\t\tcontainer: $tbody,\r\n\t\t\t\titem: $row,\r\n\t\t\t\trowData: rows[index]\r\n\t\t\t}, function noop () {});\r\n\t\t}\r\n\t};\r\n\r\n\tvar renderTbody = function renderTbody ($table, data) {\r\n\t\tvar $tbody = $table.find('tbody');\r\n\t\tvar $empty;\r\n\r\n\t\tif ($tbody.length < 1) {\r\n\t\t\t$tbody = $('<tbody data-container=\"true\"></tbody>');\r\n\t\t\t$table.append($tbody);\r\n\t\t}\r\n\r\n\t\tif (typeof data.error === 'string' && data.error.length > 0) {\r\n\t\t\t$empty = $('<tr class=\"empty text-danger\"><td colspan=\"' + this.list_columns.length + '\"></td></tr>');\r\n\t\t\t$empty.find('td').append(data.error);\r\n\t\t\t$tbody.append($empty);\r\n\t\t} else if (data.items && data.items.length < 1) {\r\n\t\t\t$empty = $('<tr class=\"empty\"><td colspan=\"' + this.list_columns.length + '\"></td></tr>');\r\n\t\t\t$empty.find('td').append(this.viewOptions.list_noItemsHTML);\r\n\t\t\t$tbody.append($empty);\r\n\t\t}\r\n\t};\r\n\r\n\tvar renderThead = function renderThead ($table, data) {\r\n\t\tvar columns = data.columns || [];\r\n\t\tvar $thead = $table.find('thead');\r\n\t\tvar i;\r\n\t\tvar length;\r\n\t\tvar $tr;\r\n\r\n\t\tif (this.list_firstRender || areDifferentColumns(this.list_columns, columns) || $thead.length === 0) {\r\n\t\t\t$thead.remove();\r\n\r\n\t\t\t// list_noItems is set in `before` method\r\n\r\n\t\t\tif (this.viewOptions.list_selectable === 'multi' && !this.list_noItems) {\r\n\t\t\t\tvar checkboxColumn = {\r\n\t\t\t\t\tlabel: 'c',\r\n\t\t\t\t\tproperty: '@_CHECKBOX_@',\r\n\t\t\t\t\tsortable: false\r\n\t\t\t\t};\r\n\t\t\t\tcolumns.splice(0, 0, checkboxColumn);\r\n\t\t\t}\r\n\r\n\t\t\tthis.list_columns = columns;\r\n\t\t\tthis.list_firstRender = false;\r\n\t\t\tthis.$loader.removeClass('noHeader');\r\n\r\n\t\t\t// keep action column header even when empty, you'll need it later....\r\n\t\t\tif (this.viewOptions.list_actions) {\r\n\t\t\t\tvar actionsColumn = {\r\n\t\t\t\t\tlabel: this.viewOptions.list_actions.label || '<span class=\"actions-hidden\">a</span>',\r\n\t\t\t\t\tproperty: '@_ACTIONS_@',\r\n\t\t\t\t\tsortable: false,\r\n\t\t\t\t\twidth: this.list_actions_width\r\n\t\t\t\t};\r\n\t\t\t\tcolumns.push(actionsColumn);\r\n\t\t\t}\r\n\r\n\r\n\t\t\t$thead = $('<thead data-preserve=\"deep\"><tr></tr></thead>');\r\n\t\t\t$tr = $thead.find('tr');\r\n\t\t\tfor (i = 0, length = columns.length; i < length; i++) {\r\n\t\t\t\trenderHeader.call(this, $tr, columns, i);\r\n\t\t\t}\r\n\t\t\t$table.prepend($thead);\r\n\r\n\t\t\tif (this.viewOptions.list_selectable === 'multi' && !this.list_noItems) {\r\n\t\t\t\t// after checkbox column is created need to get width of checkbox column from\r\n\t\t\t\t// its css class\r\n\t\t\t\tvar checkboxWidth = this.$element.find('.repeater-list-wrapper .header-checkbox').outerWidth();\r\n\t\t\t\tvar selectColumn = $.grep(columns, function grepColumn (column) {\r\n\t\t\t\t\treturn column.property === '@_CHECKBOX_@';\r\n\t\t\t\t})[0];\r\n\t\t\t\tselectColumn.width = checkboxWidth;\r\n\t\t\t}\r\n\t\t\tsizeColumns.call(this, $tr);\r\n\t\t}\r\n\t};\r\n\r\n\tvar sizeColumns = function sizeColumns ($tr) {\r\n\t\tvar automaticallyGeneratedWidths = [];\r\n\t\tvar self = this;\r\n\t\tvar i;\r\n\t\tvar length;\r\n\t\tvar newWidth;\r\n\t\tvar widthTaken;\r\n\r\n\t\tif (this.viewOptions.list_columnSizing) {\r\n\t\t\ti = 0;\r\n\t\t\twidthTaken = 0;\r\n\t\t\t$tr.find('th').each(function eachTH () {\r\n\t\t\t\tvar $th = $(this);\r\n\t\t\t\tvar width;\r\n\t\t\t\tif (self.list_columns[i].width !== undefined) {\r\n\t\t\t\t\twidth = self.list_columns[i].width;\r\n\t\t\t\t\t$th.outerWidth(width);\r\n\t\t\t\t\twidthTaken += $th.outerWidth();\r\n\t\t\t\t\tself.list_columns[i]._auto_width = width;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar outerWidth = $th.find('.repeater-list-heading').outerWidth();\r\n\t\t\t\t\tautomaticallyGeneratedWidths.push({\r\n\t\t\t\t\t\tcol: $th,\r\n\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\tminWidth: outerWidth\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\ti++;\r\n\t\t\t});\r\n\r\n\t\t\tlength = automaticallyGeneratedWidths.length;\r\n\t\t\tif (length > 0) {\r\n\t\t\t\tvar canvasWidth = this.$canvas.find('.repeater-list-wrapper').outerWidth();\r\n\t\t\t\tnewWidth = Math.floor((canvasWidth - widthTaken) / length);\r\n\t\t\t\tfor (i = 0; i < length; i++) {\r\n\t\t\t\t\tif (automaticallyGeneratedWidths[i].minWidth > newWidth) {\r\n\t\t\t\t\t\tnewWidth = automaticallyGeneratedWidths[i].minWidth;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tautomaticallyGeneratedWidths[i].col.outerWidth(newWidth);\r\n\t\t\t\t\tthis.list_columns[automaticallyGeneratedWidths[i].index]._auto_width = newWidth;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tvar specialBrowserClass = function specialBrowserClass () {\r\n\t\tvar ua = window.navigator.userAgent;\r\n\t\tvar msie = ua.indexOf('MSIE ');\r\n\t\tvar firefox = ua.indexOf('Firefox');\r\n\r\n\t\tif (msie > 0 ) {\r\n\t\t\treturn 'ie-' + parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\r\n\t\t} else if (firefox > 0) {\r\n\t\t\treturn 'firefox';\r\n\t\t}\r\n\r\n\t\treturn '';\r\n\t};\r\n\r\n\tvar toggleActionsHeaderButton = function toggleActionsHeaderButton () {\r\n\t\tvar selectedSelector = '.repeater-list-wrapper > table .selected';\r\n\t\tvar $actionsColumn = this.$element.find('.table-actions');\r\n\t\tvar $selected;\r\n\r\n\t\tif (this.viewOptions.list_selectable === 'action') {\r\n\t\t\tselectedSelector = '.repeater-list-wrapper > table tr';\r\n\t\t}\r\n\r\n\t\t$selected = this.$canvas.find( selectedSelector );\r\n\r\n\t\tif ($selected.length > 0) {\r\n\t\t\t$actionsColumn.find('thead .btn').removeAttr('disabled');\r\n\t\t} else {\r\n\t\t\t$actionsColumn.find('thead .btn').attr('disabled', 'disabled');\r\n\t\t}\r\n\t};\r\n\r\n});\r\n\ndefine('skylark-fuelux/repeater-thumbnail',[\r\n    \"skylark-langx/langx\",\r\n    \"skylark-domx/browser\",\r\n    \"skylark-domx/eventer\",\r\n    \"skylark-domx/noder\",\r\n    \"skylark-domx/geom\",\r\n    \"skylark-domx/query\",\r\n    \"./repeater\"\r\n], function(langx, browser, eventer, noder, geom, $) {\r\n\r\n    /*\r\n     * Fuel UX Checkbox\r\n     * https://github.com/ExactTarget/fuelux\r\n     *\r\n     * Copyright (c) 2014 ExactTarget\r\n     * Licensed under the BSD New license.\r\n     */\r\n\r\n    if ($.fn.repeater) {\r\n        //ADDITIONAL METHODS\r\n        $.fn.repeater.Constructor.prototype.thumbnail_clearSelectedItems = function() {\r\n            this.$canvas.find('.repeater-thumbnail-cont .selectable.selected').removeClass('selected');\r\n        };\r\n\r\n        $.fn.repeater.Constructor.prototype.thumbnail_getSelectedItems = function() {\r\n            var selected = [];\r\n            this.$canvas.find('.repeater-thumbnail-cont .selectable.selected').each(function() {\r\n                selected.push($(this));\r\n            });\r\n            return selected;\r\n        };\r\n\r\n        $.fn.repeater.Constructor.prototype.thumbnail_setSelectedItems = function(items, force) {\r\n            var selectable = this.viewOptions.thumbnail_selectable;\r\n            var self = this;\r\n            var i, $item, l, n;\r\n\r\n            //this function is necessary because lint yells when a function is in a loop\r\n            function compareItemIndex() {\r\n                if (n === items[i].index) {\r\n                    $item = $(this);\r\n                    return false;\r\n                } else {\r\n                    n++;\r\n                }\r\n            }\r\n\r\n            //this function is necessary because lint yells when a function is in a loop\r\n            function compareItemSelector() {\r\n                $item = $(this);\r\n                if ($item.is(items[i].selector)) {\r\n                    selectItem($item, items[i].selected);\r\n                }\r\n            }\r\n\r\n            function selectItem($itm, select) {\r\n                select = (select !== undefined) ? select : true;\r\n                if (select) {\r\n                    if (!force && selectable !== 'multi') {\r\n                        self.thumbnail_clearSelectedItems();\r\n                    }\r\n\r\n                    $itm.addClass('selected');\r\n                } else {\r\n                    $itm.removeClass('selected');\r\n                }\r\n            }\r\n\r\n            if (!$.isArray(items)) {\r\n                items = [items];\r\n            }\r\n\r\n            if (force === true || selectable === 'multi') {\r\n                l = items.length;\r\n            } else if (selectable) {\r\n                l = (items.length > 0) ? 1 : 0;\r\n            } else {\r\n                l = 0;\r\n            }\r\n\r\n            for (i = 0; i < l; i++) {\r\n                if (items[i].index !== undefined) {\r\n                    $item = $();\r\n                    n = 0;\r\n                    this.$canvas.find('.repeater-thumbnail-cont .selectable').each(compareItemIndex);\r\n                    if ($item.length > 0) {\r\n                        selectItem($item, items[i].selected);\r\n                    }\r\n\r\n                } else if (items[i].selector) {\r\n                    this.$canvas.find('.repeater-thumbnail-cont .selectable').each(compareItemSelector);\r\n                }\r\n            }\r\n        };\r\n\r\n        //ADDITIONAL DEFAULT OPTIONS\r\n        $.fn.repeater.defaults = langx.mixin({}, $.fn.repeater.defaults, {\r\n            thumbnail_alignment: 'left',\r\n            thumbnail_infiniteScroll: false,\r\n            thumbnail_itemRendered: null,\r\n            thumbnail_noItemsHTML: 'no items found',\r\n            thumbnail_selectable: false,\r\n            thumbnail_template: '<div class=\"thumbnail repeater-thumbnail\"><img height=\"75\" src=\"{{src}}\" width=\"65\"><span>{{name}}</span></div>'\r\n        });\r\n\r\n        //EXTENSION DEFINITION\r\n        $.fn.repeater.viewTypes.thumbnail = {\r\n            selected: function() {\r\n                var infScroll = this.viewOptions.thumbnail_infiniteScroll;\r\n                var opts;\r\n                if (infScroll) {\r\n                    opts = (typeof infScroll === 'object') ? infScroll : {};\r\n                    this.infiniteScrolling(true, opts);\r\n                }\r\n            },\r\n            before: function(helpers) {\r\n                var alignment = this.viewOptions.thumbnail_alignment;\r\n                var $cont = this.$canvas.find('.repeater-thumbnail-cont');\r\n                var data = helpers.data;\r\n                var response = {};\r\n                var $empty, validAlignments;\r\n\r\n                if ($cont.length < 1) {\r\n                    $cont = $('<div class=\"clearfix repeater-thumbnail-cont\" data-container=\"true\" data-infinite=\"true\" data-preserve=\"shallow\"></div>');\r\n                    if (alignment && alignment !== 'none') {\r\n                        validAlignments = {\r\n                            'center': 1,\r\n                            'justify': 1,\r\n                            'left': 1,\r\n                            'right': 1\r\n                        };\r\n                        alignment = (validAlignments[alignment]) ? alignment : 'justify';\r\n                        $cont.addClass('align-' + alignment);\r\n                        this.thumbnail_injectSpacers = true;\r\n                    } else {\r\n                        this.thumbnail_injectSpacers = false;\r\n                    }\r\n                    response.item = $cont;\r\n                } else {\r\n                    response.action = 'none';\r\n                }\r\n\r\n                if (data.items && data.items.length < 1) {\r\n                    $empty = $('<div class=\"empty\"></div>');\r\n                    $empty.append(this.viewOptions.thumbnail_noItemsHTML);\r\n                    $cont.append($empty);\r\n                } else {\r\n                    $cont.find('.empty:first').remove();\r\n                }\r\n\r\n                return response;\r\n            },\r\n            renderItem: function(helpers) {\r\n                var selectable = this.viewOptions.thumbnail_selectable;\r\n                var selected = 'selected';\r\n                var self = this;\r\n                var $thumbnail = $(fillTemplate(helpers.subset[helpers.index], this.viewOptions.thumbnail_template));\r\n\r\n                $thumbnail.data('item_data', helpers.data.items[helpers.index]);\r\n\r\n                if (selectable) {\r\n                    $thumbnail.addClass('selectable');\r\n                    $thumbnail.on('click', function() {\r\n                        if (self.isDisabled) return;\r\n\r\n                        if (!$thumbnail.hasClass(selected)) {\r\n                            if (selectable !== 'multi') {\r\n                                self.$canvas.find('.repeater-thumbnail-cont .selectable.selected').each(function() {\r\n                                    var $itm = $(this);\r\n                                    $itm.removeClass(selected);\r\n                                    self.$element.trigger('deselected.fu.repeaterThumbnail', $itm);\r\n                                });\r\n                            }\r\n\r\n                            $thumbnail.addClass(selected);\r\n                            self.$element.trigger('selected.fu.repeaterThumbnail', $thumbnail);\r\n                        } else {\r\n                            $thumbnail.removeClass(selected);\r\n                            self.$element.trigger('deselected.fu.repeaterThumbnail', $thumbnail);\r\n                        }\r\n                    });\r\n                }\r\n\r\n                helpers.container.append($thumbnail);\r\n                if (this.thumbnail_injectSpacers) {\r\n                    $thumbnail.after('<span class=\"spacer\">&nbsp;</span>');\r\n                }\r\n\r\n                if (this.viewOptions.thumbnail_itemRendered) {\r\n                    this.viewOptions.thumbnail_itemRendered({\r\n                        container: helpers.container,\r\n                        item: $thumbnail,\r\n                        itemData: helpers.subset[helpers.index]\r\n                    }, function() {});\r\n                }\r\n\r\n                return false;\r\n            }\r\n        };\r\n    }\r\n\r\n    //ADDITIONAL METHODS\r\n    function fillTemplate(itemData, template) {\r\n        var invalid = false;\r\n\r\n        function replace() {\r\n            var end, start, val;\r\n\r\n            start = template.indexOf('{{');\r\n            end = template.indexOf('}}', start + 2);\r\n\r\n            if (start > -1 && end > -1) {\r\n                val = langx.trim(template.substring(start + 2, end));\r\n                val = (itemData[val] !== undefined) ? itemData[val] : '';\r\n                template = template.substring(0, start) + val + template.substring(end + 2);\r\n            } else {\r\n                invalid = true;\r\n            }\r\n        }\r\n\r\n        while (!invalid && template.search('{{') >= 0) {\r\n            replace(template);\r\n        }\r\n\r\n        return template;\r\n    }\r\n\r\n});\ndefine('skylark-fuelux/main',[\n    \"skylark-domx/query\",\n    \"skylark-bootstrap3\",\n    \"./checkbox\",\n    \"./combobox\",\n    \"./datepicker\",\n    \"./dropdown-autoflip\",\n    \"./infinite-scroll\",\n    \"./loader\",\n    \"./picker\",\n    \"./pillbox\",\n    \"./placard\",\n    \"./radio\",\n    \"./scheduler\",\n    \"./search\",\n    \"./selectlist\",\n    \"./spinbox\",\n    \"./tree\",\n    \"./wizard\",\n\n    \"./repeater\",\n    \"./repeater-list\",\n    \"./repeater-thumbnail\"\n\n], function($) {\n    return $;\n});\ndefine('skylark-fuelux', ['skylark-fuelux/main'], function (main) { return main; });\n\n"]}